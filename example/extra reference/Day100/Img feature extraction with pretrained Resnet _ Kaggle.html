<!DOCTYPE html>
<!-- saved from url=(0075)https://www.kaggle.com/insaff/img-feature-extraction-with-pretrained-resnet -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style id="react-tooltip">.__react_component_tooltip{border-radius:3px;display:inline-block;font-size:13px;left:-999em;opacity:0;padding:8px 21px;position:fixed;pointer-events:none;transition:opacity 0.3s ease-out;top:-999em;visibility:hidden;z-index:999}.__react_component_tooltip.allow_hover,.__react_component_tooltip.allow_click{pointer-events:auto}.__react_component_tooltip:before,.__react_component_tooltip:after{content:"";width:0;height:0;position:absolute}.__react_component_tooltip.show{opacity:0.9;margin-top:0px;margin-left:0px;visibility:visible}.__react_component_tooltip.type-dark{color:#fff;background-color:#222}.__react_component_tooltip.type-dark.place-top:after{border-top-color:#222;border-top-style:solid;border-top-width:6px}.__react_component_tooltip.type-dark.place-bottom:after{border-bottom-color:#222;border-bottom-style:solid;border-bottom-width:6px}.__react_component_tooltip.type-dark.place-left:after{border-left-color:#222;border-left-style:solid;border-left-width:6px}.__react_component_tooltip.type-dark.place-right:after{border-right-color:#222;border-right-style:solid;border-right-width:6px}.__react_component_tooltip.type-dark.border{border:1px solid #fff}.__react_component_tooltip.type-dark.border.place-top:before{border-top:8px solid #fff}.__react_component_tooltip.type-dark.border.place-bottom:before{border-bottom:8px solid #fff}.__react_component_tooltip.type-dark.border.place-left:before{border-left:8px solid #fff}.__react_component_tooltip.type-dark.border.place-right:before{border-right:8px solid #fff}.__react_component_tooltip.type-success{color:#fff;background-color:#8DC572}.__react_component_tooltip.type-success.place-top:after{border-top-color:#8DC572;border-top-style:solid;border-top-width:6px}.__react_component_tooltip.type-success.place-bottom:after{border-bottom-color:#8DC572;border-bottom-style:solid;border-bottom-width:6px}.__react_component_tooltip.type-success.place-left:after{border-left-color:#8DC572;border-left-style:solid;border-left-width:6px}.__react_component_tooltip.type-success.place-right:after{border-right-color:#8DC572;border-right-style:solid;border-right-width:6px}.__react_component_tooltip.type-success.border{border:1px solid #fff}.__react_component_tooltip.type-success.border.place-top:before{border-top:8px solid #fff}.__react_component_tooltip.type-success.border.place-bottom:before{border-bottom:8px solid #fff}.__react_component_tooltip.type-success.border.place-left:before{border-left:8px solid #fff}.__react_component_tooltip.type-success.border.place-right:before{border-right:8px solid #fff}.__react_component_tooltip.type-warning{color:#fff;background-color:#F0AD4E}.__react_component_tooltip.type-warning.place-top:after{border-top-color:#F0AD4E;border-top-style:solid;border-top-width:6px}.__react_component_tooltip.type-warning.place-bottom:after{border-bottom-color:#F0AD4E;border-bottom-style:solid;border-bottom-width:6px}.__react_component_tooltip.type-warning.place-left:after{border-left-color:#F0AD4E;border-left-style:solid;border-left-width:6px}.__react_component_tooltip.type-warning.place-right:after{border-right-color:#F0AD4E;border-right-style:solid;border-right-width:6px}.__react_component_tooltip.type-warning.border{border:1px solid #fff}.__react_component_tooltip.type-warning.border.place-top:before{border-top:8px solid #fff}.__react_component_tooltip.type-warning.border.place-bottom:before{border-bottom:8px solid #fff}.__react_component_tooltip.type-warning.border.place-left:before{border-left:8px solid #fff}.__react_component_tooltip.type-warning.border.place-right:before{border-right:8px solid #fff}.__react_component_tooltip.type-error{color:#fff;background-color:#BE6464}.__react_component_tooltip.type-error.place-top:after{border-top-color:#BE6464;border-top-style:solid;border-top-width:6px}.__react_component_tooltip.type-error.place-bottom:after{border-bottom-color:#BE6464;border-bottom-style:solid;border-bottom-width:6px}.__react_component_tooltip.type-error.place-left:after{border-left-color:#BE6464;border-left-style:solid;border-left-width:6px}.__react_component_tooltip.type-error.place-right:after{border-right-color:#BE6464;border-right-style:solid;border-right-width:6px}.__react_component_tooltip.type-error.border{border:1px solid #fff}.__react_component_tooltip.type-error.border.place-top:before{border-top:8px solid #fff}.__react_component_tooltip.type-error.border.place-bottom:before{border-bottom:8px solid #fff}.__react_component_tooltip.type-error.border.place-left:before{border-left:8px solid #fff}.__react_component_tooltip.type-error.border.place-right:before{border-right:8px solid #fff}.__react_component_tooltip.type-info{color:#fff;background-color:#337AB7}.__react_component_tooltip.type-info.place-top:after{border-top-color:#337AB7;border-top-style:solid;border-top-width:6px}.__react_component_tooltip.type-info.place-bottom:after{border-bottom-color:#337AB7;border-bottom-style:solid;border-bottom-width:6px}.__react_component_tooltip.type-info.place-left:after{border-left-color:#337AB7;border-left-style:solid;border-left-width:6px}.__react_component_tooltip.type-info.place-right:after{border-right-color:#337AB7;border-right-style:solid;border-right-width:6px}.__react_component_tooltip.type-info.border{border:1px solid #fff}.__react_component_tooltip.type-info.border.place-top:before{border-top:8px solid #fff}.__react_component_tooltip.type-info.border.place-bottom:before{border-bottom:8px solid #fff}.__react_component_tooltip.type-info.border.place-left:before{border-left:8px solid #fff}.__react_component_tooltip.type-info.border.place-right:before{border-right:8px solid #fff}.__react_component_tooltip.type-light{color:#222;background-color:#fff}.__react_component_tooltip.type-light.place-top:after{border-top-color:#fff;border-top-style:solid;border-top-width:6px}.__react_component_tooltip.type-light.place-bottom:after{border-bottom-color:#fff;border-bottom-style:solid;border-bottom-width:6px}.__react_component_tooltip.type-light.place-left:after{border-left-color:#fff;border-left-style:solid;border-left-width:6px}.__react_component_tooltip.type-light.place-right:after{border-right-color:#fff;border-right-style:solid;border-right-width:6px}.__react_component_tooltip.type-light.border{border:1px solid #222}.__react_component_tooltip.type-light.border.place-top:before{border-top:8px solid #222}.__react_component_tooltip.type-light.border.place-bottom:before{border-bottom:8px solid #222}.__react_component_tooltip.type-light.border.place-left:before{border-left:8px solid #222}.__react_component_tooltip.type-light.border.place-right:before{border-right:8px solid #222}.__react_component_tooltip.place-top{margin-top:-10px}.__react_component_tooltip.place-top:before{border-left:10px solid transparent;border-right:10px solid transparent;bottom:-8px;left:50%;margin-left:-10px}.__react_component_tooltip.place-top:after{border-left:8px solid transparent;border-right:8px solid transparent;bottom:-6px;left:50%;margin-left:-8px}.__react_component_tooltip.place-bottom{margin-top:10px}.__react_component_tooltip.place-bottom:before{border-left:10px solid transparent;border-right:10px solid transparent;top:-8px;left:50%;margin-left:-10px}.__react_component_tooltip.place-bottom:after{border-left:8px solid transparent;border-right:8px solid transparent;top:-6px;left:50%;margin-left:-8px}.__react_component_tooltip.place-left{margin-left:-10px}.__react_component_tooltip.place-left:before{border-top:6px solid transparent;border-bottom:6px solid transparent;right:-8px;top:50%;margin-top:-5px}.__react_component_tooltip.place-left:after{border-top:5px solid transparent;border-bottom:5px solid transparent;right:-6px;top:50%;margin-top:-4px}.__react_component_tooltip.place-right{margin-left:10px}.__react_component_tooltip.place-right:before{border-top:6px solid transparent;border-bottom:6px solid transparent;left:-8px;top:50%;margin-top:-5px}.__react_component_tooltip.place-right:after{border-top:5px solid transparent;border-bottom:5px solid transparent;left:-6px;top:50%;margin-top:-4px}.__react_component_tooltip .multi-line{display:block;padding:2px 0px;text-align:center}</style>
    <title>Img feature extraction with pretrained Resnet | Kaggle</title>
    
    <meta name="robots" content="index, follow">
    <meta name="description" content="Download Open Datasets on 1000s of Projects + Share Projects on One Platform. Explore Popular Topics Like Government, Sports, Medicine, Fintech, Food, More. Flexible Data Ingestion.">
    <meta name="turbolinks-cache-control" content="no-cache">
                <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, minimum-scale=1.0">    <meta name="theme-color" content="#008ABC">
    <script type="text/javascript" async="" src="./Img feature extraction with pretrained Resnet _ Kaggle_files/koj6gxx6"></script><script type="text/javascript" async="" src="./Img feature extraction with pretrained Resnet _ Kaggle_files/js"></script><script src="./Img feature extraction with pretrained Resnet _ Kaggle_files/cb=gapi.loaded_0" async=""></script><script type="text/javascript" async="" src="./Img feature extraction with pretrained Resnet _ Kaggle_files/analytics.js.下載"></script><script async="" src="./Img feature extraction with pretrained Resnet _ Kaggle_files/fbevents.js.下載"></script><script type="text/javascript">
        window["initialPageLoadStartTime"] = new Date().getTime();
    </script>
    <link rel="dns-prefetch" href="https://www.google-analytics.com/"><link rel="dns-prefetch" href="https://stats.g.doubleclick.net/"><link rel="dns-prefetch" href="https://js.intercomcdn.com/"><link rel="dns-prefetch" href="https://storage.googleapis.com/">
    <link href="https://www.kaggle.com/static/images/favicon.ico" rel="shortcut icon" type="image/x-icon">
    <link rel="manifest" href="https://www.kaggle.com/static/json/manifest.json">
    <link href="./Img feature extraction with pretrained Resnet _ Kaggle_files/css" rel="stylesheet" type="text/css">
    <link href="./Img feature extraction with pretrained Resnet _ Kaggle_files/icon" rel="stylesheet" type="text/css">
        <link rel="canonical" href="https://www.kaggle.com/insaff/img-feature-extraction-with-pretrained-resnet">                    <link rel="stylesheet" type="text/css" href="./Img feature extraction with pretrained Resnet _ Kaggle_files/vendor.css">
        <link rel="stylesheet" type="text/css" href="./Img feature extraction with pretrained Resnet _ Kaggle_files/app.css">
    
    
 
        <script>
        try{(function(a,s,y,n,c,h,i,d,e){d=s.createElement("style");
        d.appendChild(s.createTextNode(""));s.head.appendChild(d);d=d.sheet;
        y=y.map(x => d.insertRule(x + "{ opacity: 0 !important }"));
        h.start=1*new Date;h.end=i=function(){y.forEach(x => x<d.cssRules.length ? d.deleteRule(x) : {})};
        (a[n]=a[n]||[]).hide=h;setTimeout(function(){i();h.end=null},c);h.timeout=c;
        })(window,document,['.site-header-react__nav'],'dataLayer',2000,{'GTM-52LNT9S':true});}catch{}
    </script><style></style>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'UA-12629138-1', {
            'optimize_id': 'GTM-52LNT9S',
            'displayFeaturesTask': null,
            'send_page_view': false
        });
    </script>
    <script async="" src="./Img feature extraction with pretrained Resnet _ Kaggle_files/js(1)"></script>

    
<script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
            n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window,document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
    fbq("set", "autoConfig", "false", "136809193586742");
    fbq('init', '136809193586742'); 
    fbq('track', 'PageView');
</script>
<noscript>
    <img height="1" width="1" src="https://www.facebook.com/tr?id=136809193586742&ev=PageView&noscript=1"/>
</noscript>

<script>window.intercomSettings = {"app_id":"koj6gxx6","name":"KentHsieh","email":"kent1206@gmail.com","user_hash":"8172293af08a846725f3508819f89e92ff063a38d5f248e9d6b6c730bbf3a446","created_at":1493533395,"last_visit_date_at":1566307032,"status_id":2,"performance_tier":0,"user_name":"insightseeker","display_name":"KentHsieh","is_admin":false,"experiment_group":1,"newsletter_subscriber":true,"competition_mailing_list_subscriber":true,"block_emails":false,"competitions_tier":0,"competitions_tier_attained_at":1493537034,"kernels_tier":0,"kernels_tier_attained_at":1493537034,"discussion_tier":0,"discussion_tier_attained_at":1493537034,"datasets_count":0,"last_new_dataset_visit_at":1493534871,"host_page_visits":0,"in_class_competitions_hosted_count":0,"last_hour_searches_count":0,"api_has_token":false,"api_has_requests":false};</script>        <script>(function () { var w = window; var ic = w.Intercom; if (typeof ic === "function") { ic('reattach_activator'); ic('update', intercomSettings); } else { var d = document; var i = function () { i.c(arguments) }; i.q = []; i.c = function (args) { i.q.push(args) }; w.Intercom = i; function l() { var s = d.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = 'https://widget.intercom.io/widget/koj6gxx6'; var x = d.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x); } if (w.attachEvent) { w.attachEvent('onload', l); } else { w.addEventListener('load', l, false); } } })()</script>
    
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@kaggledatasets">
    <meta name="og:url" content="https://kaggle.com/insaff/img-feature-extraction-with-pretrained-resnet">
    <meta name="og:title" content="Img feature extraction with pretrained Resnet">
    <meta name="og:description" content="Using data from Avito Demand Prediction Challenge">
    <meta name="og:image" content="https://storage.googleapis.com/kaggle-avatars/thumbnails/465880-fb.jpg">


    
    

    
    
    
<script type="text/javascript">
    var Kaggle = Kaggle || {};

    Kaggle.Current = {
        userId: 1050034,
        userProfileUrl: '/insightseeker',
        userDisplayNameEscaped: 'KentHsieh',
        userThumbnailUrl: 'https://storage.googleapis.com/kaggle-avatars/thumbnails/1050034-gp.jpg',
        userEmail: 'kent1206@gmail.com',
        userIsPhoneVerified: true,
        userName: 'insightseeker',
        tier: 'Novice',
        antiForgeryToken: 'CfDJ8LdUzqlsSWBPr4Ce3rb9VL-PY5k2FPpUjY4W7ZDr8Pf8-lCImz1p83-ySEJmyeoJnMJu7jZ1Gg3HlM_04S8HARbLYHxATArzH0rWD-i0WDbc1-2g_jLr0qM-PQ5aPEsJvN5hgvlQJZVdkU64IWcdznhaXHdtvxJ3VzXvDevRG_TI7L6m9hZsv82tP0v4FjJypQ',
        isAnonymous: false,
        analyticsToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE1NjYzMDc5MzIsIlVzZXJJZCI6MTA1MDAzNH0.6LqUmyklybg2f2XisB6Jt_q3ztKZXIWqgBlDymOrzVU',
        analyticsTokenExpiry: 15,
        internetKernelsEnabled: true,
        
        
        
        
        
        
        mdeImageUploader: true,
        
        
        
    }
        Kaggle.Current.log = function(){};
        Kaggle.Current.warn = function(){};

    var decodeUserDisplayName = function () {
        var escapedUserDisplayName = Kaggle.Current.userDisplayNameEscaped || "";
        try {
            var textVersion = new DOMParser().parseFromString(escapedUserDisplayName, "text/html").documentElement.textContent;
            if (textVersion) {
                return textVersion;
            }
        } catch(ex) {}
        return escapedUserDisplayName;
    }
    Kaggle.Current.userDisplayName = decodeUserDisplayName();
</script>

    

<script type="text/javascript">
    var Kaggle = Kaggle || {};
    Kaggle.PageMessages = [];
</script>

    
<script type="text/javascript">
/* <![CDATA[ */
goog_snippet_vars = function() {
    var w = window;
    w.google_conversion_id = 955616553;
    w.google_conversion_label = "QSjvCKDksHMQqZrWxwM";
    w.google_conversion_value = 0.00;
    w.google_conversion_currency = "USD";
    w.google_remarketing_only = false;
    w.google_conversion_language = "en";
    w.google_conversion_format = "3";
    w.google_conversion_color = "ffffff";
}
// DO NOT CHANGE THE CODE BELOW.
goog_report_conversion = function(url) {
    goog_snippet_vars();
    window.google_conversion_format = "3";
    var opt = new Object();
    opt.onload_callback = function() {
        if (typeof(url) != 'undefined') {
            window.location = url;
        }
    }
    var conv_handler = window['google_trackConversion'];
    if (typeof(conv_handler) == 'function') {
        conv_handler(opt);
    }
}
/* ]]> */
</script>
<script type="text/javascript" src="./Img feature extraction with pretrained Resnet _ Kaggle_files/f.txt">
</script>



        <script>window['useKaggleAnalytics'] = true;</script>

    <script src="./Img feature extraction with pretrained Resnet _ Kaggle_files/vendor.js.下載" data-turbolinks-track="reload"></script>
    <script src="./Img feature extraction with pretrained Resnet _ Kaggle_files/app.js.下載" data-turbolinks-track="reload"></script><style data-styled="" data-styled-version="4.3.2" id="kaggle-sc-1" data-turbolinks-permanent="true"></style><style data-styled="" data-styled-version="4.3.2" id="kaggle-sc-2" data-turbolinks-permanent="true"></style><style data-styled="" data-styled-version="4.3.2" id="kaggle-sc-3" data-turbolinks-permanent="true"></style><style data-emotion=""></style>
        <script>
            (function() {
                if ('serviceWorker' in navigator) {
                    navigator.serviceWorker.register("/static/assets/service-worker.js").then(function(reg) {
                        reg.onupdatefound = function() {
                            var installingWorker = reg.installing;
                            installingWorker.onstatechange = function() {
                                switch (installingWorker.state) {
                                case 'installed':
                                    if (navigator.serviceWorker.controller) {
                                        console.log('New or updated content is available.');
                                    } else {
                                        console.log('Content is now available offline!');
                                    }
                                    break;
                                case 'redundant':
                                    console.error('The installing service worker became redundant.');
                                    break;
                                }
                            };
                        };
                    }).catch(function(e) {
                      console.error('Error during service worker registration:', e);
                    });
                }
            })();
        </script>
    <script>
        function handleClientLoad() {
            try {
                gapi.load('client:auth2');
            } catch (e) {
                // In Opera, readystatechange is an unreliable detection of script load, causing
                // this function to be called before gapi exists on the window. The onload callback
                // is still called at the correct time, so the feature works as expected - it's
                // just generating noisy errors.
            }
        }
    </script>
    <script async="" defer="" src="./Img feature extraction with pretrained Resnet _ Kaggle_files/api.js.下載" onload="this.googleApiOnLoad=function(){};handleClientLoad()" onreadystatechange="if (this.readyState === &#39;complete&#39;) this.googleApiOnLoad()" gapi_processed="true">
    </script>
            <script defer="" src="./Img feature extraction with pretrained Resnet _ Kaggle_files/stackdriver-errors-concat.min.js.下載"></script>
        <script type="text/javascript">
            window.addEventListener('DOMContentLoaded', function () {
                var errorHandler = new StackdriverErrorReporter();
                errorHandler.start({
                    key: 'AIzaSyDANGXFHtSIVc51MIdGwg4mQFgm3oNrKoo',
                    projectId: 'kaggle-161607',
                    service: 'web-fe',
                    version: '5e53d32f0881edb5488fcc78985b08445a6ac51a',
                    context: { user: '1050034' }
                });
            });
        </script>
<script charset="utf-8" src="./Img feature extraction with pretrained Resnet _ Kaggle_files/4.js.下載"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
<body data-turbolinks="true"><div id="MathJax_Message" style="display: none;"></div>
    <main>
        






<div class="site-layout">
        <div class="site-layout__header">
            <div data-component-name="SiteHeaderContainer" style="display: flex; flex-direction: column; flex: 1 0 auto;"><div style="--mdc-theme-on-primary:#fff; --mdc-theme-on-surface:rgba(0, 0, 0, 0.87); --mdc-theme-text-primary-on-background:rgba(0, 0, 0, 0.87); --mdc-theme-text-secondary-on-background:rgba(0, 0, 0, 0.54); --mdc-theme-text-hint-on-background:rgba(0, 0, 0, 0.38); --mdc-theme-text-disabled-on-background:rgba(0, 0, 0, 0.38); --mdc-theme-text-icon-on-background:rgba(0, 0, 0, 0.38); --mdc-theme-primary:#20BEFF; --mdc-theme-error:#F58B8A; --mdc-theme-background:#F8F8F8; --mdc-theme-surface:#F8F8F8; --mdc-theme-primary-bg:#20BEFF; --mdc-theme-secondary-bg:#919294;"><div class="site-header-react"><div class="site-header-react__wrapper-cookies-header"><div class="site-header-react__container"><div class="site-header-react__content"><div class="site-header-react__logo"><a href="https://www.kaggle.com/"><img alt="Kaggle" src="./Img feature extraction with pretrained Resnet _ Kaggle_files/site-logo.png"></a></div><div class="site-header-react__quick-search"><div class="quick-search undefined quick-search--dark false undefined"><div class="quick-search__search-box-container"><input aria-label="Site search" class="quick-search__search-box " type="text" placeholder="Search"><div class="quick-search__button"><i class="fa fa-search"></i></div></div></div></div><nav class="site-header-react__nav"><ol class="SiteHeader_SiteHeaderNavList-sc-fru52l btMbfT"><li class="site-header-react__nav-item site-header-react__nav-item--first"><a id="site-header-competitions__a" href="https://www.kaggle.com/competitions">Competitions</a></li><li class="site-header-react__nav-item "><a id="site-header-datasets__a" href="https://www.kaggle.com/datasets">Datasets</a></li><li class="site-header-react__nav-item "><a id="site-header-notebooks__a" href="https://www.kaggle.com/kernels">Notebooks</a></li><li class="site-header-react__nav-item "><a id="site-header-discussion__a" href="https://www.kaggle.com/discussion">Discussion</a></li><li class="site-header-react__nav-item "><a id="site-header-courses__a" href="https://www.kaggle.com/learn">Courses</a></li><li class="site-header-react__nav-item"><a class="site-header-react__extra-link" title="More"><svg class="site-header-react__nav-ellipsis" width="18px" height="4px" viewBox="0 0 18 4"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M16,4 C14.8954305,4 14,3.1045695 14,2 C14,0.8954305 14.8954305,0 16,0 C17.1045695,0 18,0.8954305 18,2 C18,3.1045695 17.1045695,4 16,4 Z M9,4 C7.8954305,4 7,3.1045695 7,2 C7,0.8954305 7.8954305,0 9,0 C10.1045695,0 11,0.8954305 11,2 C11,3.1045695 10.1045695,4 9,4 Z M2,4 C0.8954305,4 0,3.1045695 0,2 C0,0.8954305 0.8954305,0 2,0 C3.1045695,0 4,0.8954305 4,2 C4,3.1045695 3.1045695,4 2,4 Z" fill="#FFFFFF"></path></g></svg></a></li></ol></nav><div class="NotificationContainer_NotificationContainerWrapper-sc-bb4fan kMXxed"><span class="tooltip-container NotificationContainer_NotificationTooltipWrapper-sc-1jdjwer TZodN" data-tooltip="Notifications"><div class="NotificationIcon_NotificationIconWrapper-sc-3rbk7d dBubSX"><div class="NotificationIcon_NotificationIconIcon-sc-wpy2fb bdBygo"><span name="bell" class="fa fa-bell"></span></div></div></span><div></div></div><div class="site-header-react__user"><span class="tooltip-container" data-tooltip="Your profile"><div class="site-header-react__user--logged-in"><ul><li class="site-header-react__user-avatar"><img src="./Img feature extraction with pretrained Resnet _ Kaggle_files/1050034-gp.jpg"></li></ul></div></span></div></div></div></div></div></div></div><script>var Kaggle=window.Kaggle||{};Kaggle.State=Kaggle.State||[];Kaggle.State.push({});performance && performance.mark && performance.mark("SiteHeaderContainer.componentCouldBootstrap");</script>
        </div>

    <div class="site-layout__main-content">
        

<div data-component-name="KernelViewer" style="display: flex; flex-direction: column; flex: 1 0 auto;"><div style="--mdc-theme-on-primary:#fff; --mdc-theme-on-surface:rgba(0, 0, 0, 0.87); --mdc-theme-text-primary-on-background:rgba(0, 0, 0, 0.87); --mdc-theme-text-secondary-on-background:rgba(0, 0, 0, 0.54); --mdc-theme-text-hint-on-background:rgba(0, 0, 0, 0.38); --mdc-theme-text-disabled-on-background:rgba(0, 0, 0, 0.38); --mdc-theme-text-icon-on-background:rgba(0, 0, 0, 0.38); --mdc-theme-primary:#20BEFF; --mdc-theme-error:#F58B8A; --mdc-theme-background:#F8F8F8; --mdc-theme-surface:#F8F8F8; --mdc-theme-primary-bg:#20BEFF; --mdc-theme-secondary-bg:#919294;"><div><div id="kernel-header-wrapper" class="KernelViewer_HeaderWrapper-sc-ohc1yt sDEXm" style="top: 0px;"><div class="KernelViewerContext_ViewerHeader-sc-rb9dne gsvLRR"><span class="KernelViewerContext_PrimaryInfoWrapper-sc-ia2f3h iJGizJ"><span class="KernelViewerContext_AuthorThumbnailWrapper-sc-16ybk5w gKyUfk"><span class="tooltip-container tooltip-container--left" data-tooltip="Insaf Ashrapov"><a class="avatar" href="https://www.kaggle.com/insaff" style="width: 37px;"><img class="avatar__thumbnail" src="./Img feature extraction with pretrained Resnet _ Kaggle_files/465880-fb.jpg" alt="Insaf Ashrapov" width="37" height="37" style="border-radius: 3.7px;"><img class="avatar__tier" src="./Img feature extraction with pretrained Resnet _ Kaggle_files/avatier-expert@2x.png" alt="expert tier" width="37" style="margin-top: 1.85px;"></a></span><span class="KernelViewerContext_TruncatedCollaboratorsWrapper-sc-t3tbmb gucpcS"><span><span class="TruncatedCollaborators_CollaboratorThumbnailWrapper-sc-soe92h eyJHdD"></span></span></span></span><span class="KernelViewerContext_TitleBlock-sc-jekzgk iwNYec"><a class="KernelViewerContext_KernelTitle-sc-jsmupn GtGFN">Img feature extraction with pretrained Resnet</a><br><span class="KernelViewerContext_KernelSubtitle-sc-1joh4f8 hwbMpd"><span class="KernelViewerContext_KernelTypeInfo-sc-1l6fza6 cCZXYa">Python script using data from</span><a href="https://www.kaggle.com/c/avito-demand-prediction" class="KernelViewerContext_DataSourceUrl-sc-1dm3ij9 jFvyqr"> Avito Demand Prediction Challenge</a><span> · <span>3,767</span> views</span><span> · <span title="Tue May 29 2018 05:11:15 GMT+0800 (台北標準時間)">1y ago</span></span><span class="KernelViewerContext_CategoriesWrapper-sc-8yrjj dLfERf"><span></span></span></span></span></span><span class="HeaderOptionsContext_CommunityWrapper-sc-1xsfcpi kzxDmz"><span class="KernelVoteButton_VoteButtonWrapper-sc-2bmt8m dMnHdH"><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled"><div class="vote-button__button vote-button__button--up vb-upvote"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up vote-button__vote-count-container"><span class="vote-button__vote-count">7</span></div><div class="vote-button__button-placeholder"></div></div></div></span><span class="fork-button ForkButton_JoinedForkContainer-sc-c3nw8f drKHMd"><a class="copy-and-edit-link ForkButton_ForkButtonContainer-sc-l7qw5r kBdRw" href="https://www.kaggle.com/kernels/fork/1040286"><span class="ForkButton_ForkTextContainer-sc-ij05fn cLUeWe"><span class="fa fa-code-fork ForkButton_CodeForkIcon-sc-1q1gn6s cjcKpm"></span> Copy and Edit</span></a><a class="ForkButton_ForkButtonContainer-sc-l7qw5r ForkButton_ForkCountContainer-sc-11dafe6 ibzcfR">2</a></span><span class="HeaderOptionsContext_InlineDropdown-sc-183b1ux eVsYcS"><div class="NewsfeedDropdown_DropdownContainer-sc-15xb820 jnulvx"><div class="NewsfeedDropdown_DropdownIconContainer-sc-xh44ey kkVeZz"><span name="ellipsis-h" class="fa fa-ellipsis-h"></span> </div></div></span></span></div><div class="sc-buGlAa crIovC"></div></div><div class="KernelViewer_ViewerContent-sc-c2nrua fxgEVS"><div class="kernel-viewer"><span class="KernelViewer_NavigationSidebarWrapper-sc-56cp8f jJbHsV"><div class="KernelViewerContext_FullNavigationMenu-sc-1n0pzuj PexAa"><span><div class="VersionsInfoBox_VersionTitle-sc-1a29ina bRHlaX">Version 1</div><div class="VersionsInfoBox_VersionTitle-sc-1a29ina VersionsInfoBox_VersionSubtitle-sc-so54uw hPSNEW"><span class="fa fa-history VersionsInfoBox_RecentCommitsIcon-sc-1gnl07a cXSqyw"><span> <span>1 commit</span></span></span></div></span><div class="navbox__container"><div class="navbox__nav-wrapper"><nav class="navbox__nav"><a class="navbox__nav-item--selected-with-bar" href="https://www.kaggle.com/insaff/img-feature-extraction-with-pretrained-resnet/code" title="Code">Code</a><div class="navbox__page"></div><a class="navbox__nav-item" href="https://www.kaggle.com/insaff/img-feature-extraction-with-pretrained-resnet/log" title="Log">Log</a><a class="navbox__nav-item" href="https://www.kaggle.com/insaff/img-feature-extraction-with-pretrained-resnet/data" title="Data">Data</a><a class="navbox__nav-item" href="https://www.kaggle.com/insaff/img-feature-extraction-with-pretrained-resnet/comments" title="Comments">Comments</a></nav></div></div></div></span><div class="kernel-viewer__container"><div class="kernel-viewer__pane-container" id="kernel-viewer__pane-container"><div class="KernelViewer_SubmissionWrapper-sc-setng8 jYMQsD"></div><div id="notebook"></div><div id="code"><div><div><div class="content-box"><div><div class="content-box__title-bar"><div class="ContentBox_Title-sc-6fbrxj iCvEyH" style="line-height: 46px;">Code</div><div class="content-box__right-side"><div class="kernel-code-pane__right-section"><div class="kernel-code-pane__subtitle">This kernel has been released under the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0</a> open source license.</div><a href="https://www.kaggle.com/kernels/scriptcontent/3804868/download" class="kernel-code-pane__download">Download Code</a></div></div></div></div><div class="content-box__content-section"><div class="kernel-code-pane"><div class="kernel-code-pane__contents"><pre class="line-numbers  language-python" id="lines" data-line="null"><code class="  language-python"><span class="token comment"># This Python 3 environment comes with many helpful analytics libraries installed</span>
<span class="token comment"># It is defined by the kaggle/python docker image: https://github.com/kaggle/docker-python</span>
<span class="token comment"># For example, here's several helpful packages to load in </span>

<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm 
<span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf 
<span class="token keyword">from</span> keras<span class="token punctuation">.</span>applications<span class="token punctuation">.</span>resnet50 <span class="token keyword">import</span> ResNet50
<span class="token keyword">from</span> keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> Flatten<span class="token punctuation">,</span> Input
<span class="token keyword">from</span> keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> Model
<span class="token keyword">from</span> keras<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> image
<span class="token keyword">from</span> keras<span class="token punctuation">.</span>applications<span class="token punctuation">.</span>imagenet_utils <span class="token keyword">import</span> preprocess_input
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> google<span class="token punctuation">.</span>cloud <span class="token keyword">import</span> storage 
<span class="token keyword">from</span> io <span class="token keyword">import</span> BytesIO
<span class="token keyword">import</span> time
<span class="token keyword">import</span> cv2
start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>


model <span class="token operator">=</span> ResNet50<span class="token punctuation">(</span>weights<span class="token operator">=</span><span class="token string">'imagenet'</span><span class="token punctuation">,</span> pooling<span class="token operator">=</span><span class="token builtin">max</span><span class="token punctuation">,</span> include_top <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">)</span> 

<span class="token comment">####### GENERATING FEATURES</span>
featues <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'train_featues.txt'</span><span class="token punctuation">,</span> <span class="token string">'w+'</span><span class="token punctuation">)</span> <span class="token comment">#to save features</span>
train_dir <span class="token operator">=</span> <span class="token string">'.../train'</span>
train_files <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>train_dir<span class="token punctuation">)</span>

 
start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span>  tqdm<span class="token punctuation">(</span>train_files<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        f <span class="token operator">=</span> v2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>train_dir<span class="token punctuation">,</span> <span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        img <span class="token operator">=</span> image<span class="token punctuation">.</span>load_img<span class="token punctuation">(</span>f<span class="token punctuation">,</span> target_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
        x <span class="token operator">=</span> image<span class="token punctuation">.</span>img_to_array<span class="token punctuation">(</span>img<span class="token punctuation">)</span> 
        x <span class="token operator">=</span> np<span class="token punctuation">.</span>expand_dims<span class="token punctuation">(</span>x<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span> 
        x <span class="token operator">=</span> preprocess_input<span class="token punctuation">(</span>x<span class="token punctuation">)</span> 
        features <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x<span class="token punctuation">)</span> 
        features_reduce <span class="token operator">=</span> features<span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span><span class="token punctuation">)</span> 
        train_featues<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> features<span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span> <span class="token comment"># to skip not files in a wrong format</span>
         <span class="token keyword">pass</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\n\ntime spend: '</span> <span class="token punctuation">,</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">60</span> <span class="token punctuation">,</span> <span class="token string">' minutes \n\n'</span><span class="token punctuation">)</span>

train_filenames<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code><div aria-hidden="true" data-range="null" class=" line-highlight"></div></pre></div></div></div></div></div><div class="upvote-suggestion upvote-suggestion__kernel"><div class="upvote-suggestion__text"><div class="upvote-suggestion__main-text">Did you find this Kernel useful?</div><div class="upvote-suggestion__sub-text">Show your appreciation with an upvote</div></div><div class="upvote-suggestion__button"><div class="vote-button__container "><div class="vote-button vote-button--enabled"><div class="vote-button__button vote-button__button--up vb-upvote"><span class="fa fa-caret-up"></span></div><div class="vote-button__button vote-button__button--up vote-button__vote-count-container"><span class="vote-button__vote-count">7</span></div><div class="vote-button__button-placeholder"></div></div></div></div><div class="upvote-suggestion__voters"><div class="upvote-suggestion__voter upvote-suggestion__voter-top"><span class="tooltip-container" data-tooltip="Larry Freeman" data-tooltip-size="small"><a href="https://www.kaggle.com/larryfreeman" class="upvote-suggestion__voter-link"><img src="./Img feature extraction with pretrained Resnet _ Kaggle_files/7490-gr.jpg" alt="Larry Freeman" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-top"><span class="tooltip-container" data-tooltip="Insaf Ashrapov" data-tooltip-size="small"><a href="https://www.kaggle.com/insaff" class="upvote-suggestion__voter-link"><img src="./Img feature extraction with pretrained Resnet _ Kaggle_files/465880-fb.jpg" alt="Insaf Ashrapov" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-top"><span class="tooltip-container" data-tooltip="Chi-KangSu" data-tooltip-size="small"><a href="https://www.kaggle.com/judesu" class="upvote-suggestion__voter-link"><img src="./Img feature extraction with pretrained Resnet _ Kaggle_files/747462-fb.jpg" alt="Chi-KangSu" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-more"><span class="tooltip-container" data-tooltip="Kun Hao Yeh" data-tooltip-size="small"><a href="https://www.kaggle.com/khyeh0719" class="upvote-suggestion__voter-link"><img src="./Img feature extraction with pretrained Resnet _ Kaggle_files/1264580-kg.JPG" alt="Kun Hao Yeh" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-more"><span class="tooltip-container" data-tooltip="Crea" data-tooltip-size="small"><a href="https://www.kaggle.com/creacyhuang" class="upvote-suggestion__voter-link"><img src="./Img feature extraction with pretrained Resnet _ Kaggle_files/2416568-gp.jpg" alt="Crea" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-more"><span class="tooltip-container" data-tooltip="Arun" data-tooltip-size="small"><a href="https://www.kaggle.com/arunneelakandan" class="upvote-suggestion__voter-link"><img src="./Img feature extraction with pretrained Resnet _ Kaggle_files/2810844-gp.jpg" alt="Arun" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-more"><span class="tooltip-container" data-tooltip="Yi-Ting Kuo" data-tooltip-size="small"><a href="https://www.kaggle.com/tgnco1218" class="upvote-suggestion__voter-link"><img src="./Img feature extraction with pretrained Resnet _ Kaggle_files/3068030-kg.jpg" alt="Yi-Ting Kuo" class="upvote-suggestion__voter-img"></a></span></div></div></div></div></div><div id="log"><div class="kernel-log-pane"><div class="content-box"><div><div class="content-box__title-bar"><div class="ContentBox_Title-sc-6fbrxj iCvEyH" style="line-height: 46px;">Run Info</div></div></div><div class="content-box__content-section"><div class="kernel-log-pane__run-info"><div class="kernel-log-pane__run-info-top"><div class="kernel-log-pane__run-info-column"><div class="kernel-log-pane__run-info-row"><div class="kernel-log-pane__run-info-left">Succeeded</div><div class="kernel-log-pane__run-info-right">False</div></div><div class="kernel-log-pane__run-info-row"><div class="kernel-log-pane__run-info-left">Exit Code</div><div class="kernel-log-pane__run-info-right">1</div></div><div class="kernel-log-pane__run-info-row"><div class="kernel-log-pane__run-info-left">Docker Image Name</div><div class="kernel-log-pane__run-info-right"><a href="https://registry.hub.docker.com/u/kaggle/python/">kaggle/python</a> (<a href="https://github.com/Kaggle/docker-python/blob/master/Dockerfile">Dockerfile</a>)</div></div><div class="kernel-log-pane__run-info-row"><div class="kernel-log-pane__run-info-left">Timeout Exceeded</div><div class="kernel-log-pane__run-info-right">False</div></div></div><div class="kernel-log-pane__run-info-column"><div class="kernel-log-pane__run-info-row"><div class="kernel-log-pane__run-info-left">Run Time</div><div class="kernel-log-pane__run-info-right">5.8 seconds</div></div><div class="kernel-log-pane__run-info-row"><div class="kernel-log-pane__run-info-left">Queue Time</div><div class="kernel-log-pane__run-info-right">0 seconds</div></div><div class="kernel-log-pane__run-info-row"><div class="kernel-log-pane__run-info-left">Output Size</div><div class="kernel-log-pane__run-info-right">0</div></div><div class="kernel-log-pane__run-info-row"><div class="kernel-log-pane__run-info-left">Used All Space</div><div class="kernel-log-pane__run-info-right">False</div></div></div></div><div class="kernel-log-pane__run-info-row"><div class="kernel-log-pane__run-info-left">Failure Message</div><div class="kernel-log-pane__run-info-right">The kernel returned an unsuccessful exit code (1).</div></div></div></div></div><div class="content-box"><div><div class="content-box__title-bar"><div class="ContentBox_Title-sc-6fbrxj iCvEyH" style="line-height: 46px;">Log</div><div class="content-box__right-side"><div class="kernel-code-pane__right-section"><a href="data:text/plain;charset=utf-8,Using%20TensorFlow%20backend.%0A%0ATraceback%20(most%20recent%20call%20last)%3A%0A%20%20File%20%22..%2Fsrc%2Fscript.py%22%2C%20line%2013%2C%20in%20%3Cmodule%3E%0A%0A%20%20%20%20from%20google.cloud%20import%20storage%20%0AImportError%3A%20cannot%20import%20name%20&#39;storage&#39;%0A" class="kernel-code-pane__download" download="img-feature-extraction-with-pretrained-resnet.log">Download Log</a></div></div></div></div><div class="content-box__content-section"><div class="kernel-log-pane__log"><div><div class="kernel-log-pane__line"><span class="kernel-log-pane__time-column kernel-log-pane__time-column--header">Time</span><span class="kernel-log-pane__line-no-column kernel-log-pane__line-no-column--header">Line #</span><span class="kernel-log-pane__data-column kernel-log-pane__data-column--header">Log Message</span></div><div class="kernel-log-pane__line"><span class="kernel-log-pane__time-column">4.4s</span><span class="kernel-log-pane__line-no-column">1</span><span class="kernel-log-pane__data-column--stderr">Using TensorFlow backend.
</span></div><div class="kernel-log-pane__line"><span class="kernel-log-pane__time-column">4.9s</span><span class="kernel-log-pane__line-no-column">2</span><span class="kernel-log-pane__data-column--stderr">Traceback (most recent call last):
  File "../src/script.py", line 13, in &lt;module&gt;
</span></div><div class="kernel-log-pane__line"><span class="kernel-log-pane__time-column">4.9s</span><span class="kernel-log-pane__line-no-column">3</span><span class="kernel-log-pane__data-column--stderr">    from google.cloud import storage 
ImportError: cannot import name 'storage'
</span></div><div><div class="kernel-log-pane__line"><span class="kernel-log-pane__time-column">4.9s</span><span class="kernel-log-pane__line-no-column">4</span><span class="kernel-log-pane__data-column"></span></div><div class="kernel-log-pane__line"><span class="kernel-log-pane__time-column">4.9s</span><span class="kernel-log-pane__line-no-column">6</span><span class="kernel-log-pane__data-column--stderr">Failed. Exited with code 1.</span></div></div></div></div></div></div></div></div><div id="data"><div class="DataExplorer_Container-sc-3uk7qa koHlGt"><div class="content-box"><div><div class="content-box__title-bar"><div class="ContentBox_Title-sc-6fbrxj iCvEyH" style="line-height: 46px;">Data</div><div class="content-box__right-side"><div class="DataExplorerOverview_TitleBarRight-sc-41u5ex fQnYEh"><div class="DataExplorerOverview_TitleBarItem-sc-7z0gmy jyhbDO"><span name="arrows-alt" class="DataExplorerOverview_ModalButton-sc-16rlqid gECrJu DataExplorerPreview_TitleButtonInactive-sc-bzj2yc dDfMPl fa fa-arrows-alt"></span></div></div></div></div></div><div class="content-box__content-section"><div class="DataExplorerOverview_MainContentFlexHeight-sc-mttnn1 lnvRMd"><div class="DataExplorerOverview_Column-sc-1xt9894 DataExplorerOverview_ListColumn-sc-1njtlh9 yQpPz"><div class="DataExplorerList_ExplorerContainer-sc-1a88ctb cTVrfV"><div class="data-explorer-list__header DataExplorerList_Header-sc-kx3nd2 iKHbXp"><div class="DataExplorerList_HeaderTitle-sc-b3zndu eydspt">Data Sources</div><div class="DataExplorerList_HeaderRight-sc-17seut1 gAngP"></div></div><div class="DataExplorerList_Content-sc-t0yrr2 fXPaho"><div class="DataExplorerList_Entry-sc-1uffrzs khXEaG"><div class="DataExplorerList_UnselectedEntry-sc-1lv5br0 DataExplorerList_SelectedEntry-sc-tsuri7 cWTFrR"><div style="width: 16px; min-width: 16px; max-width: 16px;"></div><span name="chevron-down" class="DataExplorerList_CollapsedIcon-sc-1qjwt1i jUrboE fa fa-chevron-down"></span><span name="trophy" class="DataExplorerList_TypeIcon-sc-mjsupj kUeJgO fa fa-trophy"></span><div class="DataExplorerList_EntryNameToolTip2-sc-kc4oz cMQbPv ToolTip_ToolTipContainer-sc-f0vhmk eHUYTV"><div data-tip="true" data-for="tooltip_0" class="DataExplorerList_EntryName-sc-12cja4h eKEqwz" currentitem="false">Avito Demand Prediction Challenge</div><div class="__react_component_tooltip place-top type-dark " id="tooltip_0" data-id="tooltip"><div class="ToolTip_ToolTipView-sc-1ci7zcv iiWQyY"><span>Avito Demand Prediction Challenge</span></div></div></div><div class="DataExplorerList_EntryInfoSpacer-sc-6qxfsx Hmlgy"></div></div><div class="DataExplorerList_EntryChildren-sc-1x9zgty fGsVOx"><div class="DataExplorerList_Entry-sc-1uffrzs khXEaG"><div class="DataExplorerList_UnselectedEntry-sc-1lv5br0 bgskLU"><div style="width: 32px; min-width: 32px; max-width: 32px;"></div><span name="chevron-right" class="DataExplorerList_CollapsedIcon-sc-1qjwt1i DataExplorerList_DisabledCollapsedIcon-sc-1qkqjxo fZbCWh fa fa-chevron-right"></span><span name="table" class="DataExplorerList_TypeIcon-sc-mjsupj kUeJgO fa fa-table"></span><div class="DataExplorerList_EntryNameToolTip2-sc-kc4oz cMQbPv ToolTip_ToolTipContainer-sc-f0vhmk eHUYTV"><div data-tip="true" data-for="tooltip_1" class="DataExplorerList_EntryName-sc-12cja4h eKEqwz" currentitem="false">periods_test.csv</div><div class="__react_component_tooltip place-top type-dark " id="tooltip_1" data-id="tooltip"><div class="ToolTip_ToolTipView-sc-1ci7zcv iiWQyY"><span>periods_test.csv</span></div></div></div><div class="DataExplorerList_EntryInfoSpacer-sc-6qxfsx Hmlgy"></div></div><a href="https://www.kaggle.com/c/avito-demand-prediction/download/periods_test.csv" class="DataExplorerList_EntryAction-sc-1hkyq01 kJGSCc"><span name="download" class="DataExplorerList_EntryActionIconBackground-sc-aljf47 gfXnRe fa fa-download"></span></a></div><div class="DataExplorerList_Entry-sc-1uffrzs khXEaG"><div class="DataExplorerList_UnselectedEntry-sc-1lv5br0 bgskLU"><div style="width: 32px; min-width: 32px; max-width: 32px;"></div><span name="chevron-right" class="DataExplorerList_CollapsedIcon-sc-1qjwt1i DataExplorerList_DisabledCollapsedIcon-sc-1qkqjxo fZbCWh fa fa-chevron-right"></span><span name="table" class="DataExplorerList_TypeIcon-sc-mjsupj kUeJgO fa fa-table"></span><div class="DataExplorerList_EntryNameToolTip2-sc-kc4oz cMQbPv ToolTip_ToolTipContainer-sc-f0vhmk eHUYTV"><div data-tip="true" data-for="tooltip_2" class="DataExplorerList_EntryName-sc-12cja4h eKEqwz" currentitem="false">periods_train.csv</div><div class="__react_component_tooltip place-top type-dark " id="tooltip_2" data-id="tooltip"><div class="ToolTip_ToolTipView-sc-1ci7zcv iiWQyY"><span>periods_train.csv</span></div></div></div><div class="DataExplorerList_EntryInfoSpacer-sc-6qxfsx Hmlgy"></div></div><a href="https://www.kaggle.com/c/avito-demand-prediction/download/periods_train.csv" class="DataExplorerList_EntryAction-sc-1hkyq01 kJGSCc"><span name="download" class="DataExplorerList_EntryActionIconBackground-sc-aljf47 gfXnRe fa fa-download"></span></a></div><div class="DataExplorerList_Entry-sc-1uffrzs khXEaG"><div class="DataExplorerList_UnselectedEntry-sc-1lv5br0 bgskLU"><div style="width: 32px; min-width: 32px; max-width: 32px;"></div><span name="chevron-right" class="DataExplorerList_CollapsedIcon-sc-1qjwt1i DataExplorerList_DisabledCollapsedIcon-sc-1qkqjxo fZbCWh fa fa-chevron-right"></span><span name="table" class="DataExplorerList_TypeIcon-sc-mjsupj kUeJgO fa fa-table"></span><div class="DataExplorerList_EntryNameToolTip2-sc-kc4oz cMQbPv ToolTip_ToolTipContainer-sc-f0vhmk eHUYTV"><div data-tip="true" data-for="tooltip_3" class="DataExplorerList_EntryName-sc-12cja4h eKEqwz" currentitem="false">sample_submission.csv</div><div class="__react_component_tooltip place-top type-dark " id="tooltip_3" data-id="tooltip"><div class="ToolTip_ToolTipView-sc-1ci7zcv iiWQyY"><span>sample_submission.csv</span></div></div></div><div class="DataExplorerList_EntryInfoSpacer-sc-6qxfsx Hmlgy"></div></div><a href="https://www.kaggle.com/c/avito-demand-prediction/download/sample_submission.csv" class="DataExplorerList_EntryAction-sc-1hkyq01 kJGSCc"><span name="download" class="DataExplorerList_EntryActionIconBackground-sc-aljf47 gfXnRe fa fa-download"></span></a></div><div class="DataExplorerList_Entry-sc-1uffrzs khXEaG"><div class="DataExplorerList_UnselectedEntry-sc-1lv5br0 bgskLU"><div style="width: 32px; min-width: 32px; max-width: 32px;"></div><span name="chevron-right" class="DataExplorerList_CollapsedIcon-sc-1qjwt1i DataExplorerList_DisabledCollapsedIcon-sc-1qkqjxo fZbCWh fa fa-chevron-right"></span><span name="table" class="DataExplorerList_TypeIcon-sc-mjsupj kUeJgO fa fa-table"></span><div class="DataExplorerList_EntryNameToolTip2-sc-kc4oz cMQbPv ToolTip_ToolTipContainer-sc-f0vhmk eHUYTV"><div data-tip="true" data-for="tooltip_4" class="DataExplorerList_EntryName-sc-12cja4h eKEqwz" currentitem="false">test.csv</div><div class="__react_component_tooltip place-top type-dark " id="tooltip_4" data-id="tooltip"><div class="ToolTip_ToolTipView-sc-1ci7zcv iiWQyY"><span>test.csv</span></div></div></div><div class="DataExplorerList_EntryInfoSpacer-sc-6qxfsx Hmlgy"></div></div><a href="https://www.kaggle.com/c/avito-demand-prediction/download/test.csv" class="DataExplorerList_EntryAction-sc-1hkyq01 kJGSCc"><span name="download" class="DataExplorerList_EntryActionIconBackground-sc-aljf47 gfXnRe fa fa-download"></span></a></div><div class="DataExplorerList_Entry-sc-1uffrzs khXEaG"><div class="DataExplorerList_UnselectedEntry-sc-1lv5br0 bgskLU"><div style="width: 32px; min-width: 32px; max-width: 32px;"></div><span name="chevron-right" class="DataExplorerList_CollapsedIcon-sc-1qjwt1i DataExplorerList_DisabledCollapsedIcon-sc-1qkqjxo fZbCWh fa fa-chevron-right"></span><span name="table" class="DataExplorerList_TypeIcon-sc-mjsupj kUeJgO fa fa-table"></span><div class="DataExplorerList_EntryNameToolTip2-sc-kc4oz cMQbPv ToolTip_ToolTipContainer-sc-f0vhmk eHUYTV"><div data-tip="true" data-for="tooltip_5" class="DataExplorerList_EntryName-sc-12cja4h eKEqwz" currentitem="false">test_active.csv</div><div class="__react_component_tooltip place-top type-dark " id="tooltip_5" data-id="tooltip"><div class="ToolTip_ToolTipView-sc-1ci7zcv iiWQyY"><span>test_active.csv</span></div></div></div><div class="DataExplorerList_EntryInfoSpacer-sc-6qxfsx Hmlgy"></div></div><a href="https://www.kaggle.com/c/avito-demand-prediction/download/test_active.csv" class="DataExplorerList_EntryAction-sc-1hkyq01 kJGSCc"><span name="download" class="DataExplorerList_EntryActionIconBackground-sc-aljf47 gfXnRe fa fa-download"></span></a></div><div class="DataExplorerList_Entry-sc-1uffrzs khXEaG"><div class="DataExplorerList_UnselectedEntry-sc-1lv5br0 bgskLU"><div style="width: 32px; min-width: 32px; max-width: 32px;"></div><span name="chevron-right" class="DataExplorerList_CollapsedIcon-sc-1qjwt1i DataExplorerList_DisabledCollapsedIcon-sc-1qkqjxo fZbCWh fa fa-chevron-right"></span><span name="table" class="DataExplorerList_TypeIcon-sc-mjsupj kUeJgO fa fa-table"></span><div class="DataExplorerList_EntryNameToolTip2-sc-kc4oz cMQbPv ToolTip_ToolTipContainer-sc-f0vhmk eHUYTV"><div data-tip="true" data-for="tooltip_6" class="DataExplorerList_EntryName-sc-12cja4h eKEqwz" currentitem="false">train.csv</div><div class="__react_component_tooltip place-top type-dark " id="tooltip_6" data-id="tooltip"><div class="ToolTip_ToolTipView-sc-1ci7zcv iiWQyY"><span>train.csv</span></div></div></div><div class="DataExplorerList_EntryInfoSpacer-sc-6qxfsx Hmlgy"></div></div><a href="https://www.kaggle.com/c/avito-demand-prediction/download/train.csv" class="DataExplorerList_EntryAction-sc-1hkyq01 kJGSCc"><span name="download" class="DataExplorerList_EntryActionIconBackground-sc-aljf47 gfXnRe fa fa-download"></span></a></div><div class="DataExplorerList_Entry-sc-1uffrzs khXEaG"><div class="DataExplorerList_UnselectedEntry-sc-1lv5br0 bgskLU"><div style="width: 32px; min-width: 32px; max-width: 32px;"></div><span name="chevron-right" class="DataExplorerList_CollapsedIcon-sc-1qjwt1i DataExplorerList_DisabledCollapsedIcon-sc-1qkqjxo fZbCWh fa fa-chevron-right"></span><span name="table" class="DataExplorerList_TypeIcon-sc-mjsupj kUeJgO fa fa-table"></span><div class="DataExplorerList_EntryNameToolTip2-sc-kc4oz cMQbPv ToolTip_ToolTipContainer-sc-f0vhmk eHUYTV"><div data-tip="true" data-for="tooltip_7" class="DataExplorerList_EntryName-sc-12cja4h eKEqwz" currentitem="false">train_active.csv</div><div class="__react_component_tooltip place-top type-dark " id="tooltip_7" data-id="tooltip"><div class="ToolTip_ToolTipView-sc-1ci7zcv iiWQyY"><span>train_active.csv</span></div></div></div><div class="DataExplorerList_EntryInfoSpacer-sc-6qxfsx Hmlgy"></div></div><a href="https://www.kaggle.com/c/avito-demand-prediction/download/train_active.csv" class="DataExplorerList_EntryAction-sc-1hkyq01 kJGSCc"><span name="download" class="DataExplorerList_EntryActionIconBackground-sc-aljf47 gfXnRe fa fa-download"></span></a></div><div class="DataExplorerList_Entry-sc-1uffrzs khXEaG"><div class="DataExplorerList_UnselectedEntry-sc-1lv5br0 bgskLU"><div style="width: 32px; min-width: 32px; max-width: 32px;"></div><span name="chevron-right" class="DataExplorerList_CollapsedIcon-sc-1qjwt1i DataExplorerList_DisabledCollapsedIcon-sc-1qkqjxo fZbCWh fa fa-chevron-right"></span><span name="file-zip-o" class="DataExplorerList_TypeIcon-sc-mjsupj kUeJgO fa fa-file-zip-o"></span><div class="DataExplorerList_EntryNameToolTip2-sc-kc4oz cMQbPv ToolTip_ToolTipContainer-sc-f0vhmk eHUYTV"><div data-tip="true" data-for="tooltip_8" class="DataExplorerList_EntryName-sc-12cja4h eKEqwz" currentitem="false">test_jpg.zip</div><div class="__react_component_tooltip place-top type-dark " id="tooltip_8" data-id="tooltip"><div class="ToolTip_ToolTipView-sc-1ci7zcv iiWQyY"><span>test_jpg.zip</span></div></div></div><div class="DataExplorerList_EntryInfoSpacer-sc-6qxfsx Hmlgy"></div></div><a href="https://www.kaggle.com/c/avito-demand-prediction/download/test_jpg.zip" class="DataExplorerList_EntryAction-sc-1hkyq01 kJGSCc"><span name="download" class="DataExplorerList_EntryActionIconBackground-sc-aljf47 gfXnRe fa fa-download"></span></a></div><div class="DataExplorerList_Entry-sc-1uffrzs khXEaG"><div class="DataExplorerList_UnselectedEntry-sc-1lv5br0 bgskLU"><div style="width: 32px; min-width: 32px; max-width: 32px;"></div><span name="chevron-right" class="DataExplorerList_CollapsedIcon-sc-1qjwt1i DataExplorerList_DisabledCollapsedIcon-sc-1qkqjxo fZbCWh fa fa-chevron-right"></span><span name="file-zip-o" class="DataExplorerList_TypeIcon-sc-mjsupj kUeJgO fa fa-file-zip-o"></span><div class="DataExplorerList_EntryNameToolTip2-sc-kc4oz cMQbPv ToolTip_ToolTipContainer-sc-f0vhmk eHUYTV"><div data-tip="true" data-for="tooltip_9" class="DataExplorerList_EntryName-sc-12cja4h eKEqwz" currentitem="false">train_jpg.zip</div><div class="__react_component_tooltip place-top type-dark " id="tooltip_9" data-id="tooltip"><div class="ToolTip_ToolTipView-sc-1ci7zcv iiWQyY"><span>train_jpg.zip</span></div></div></div><div class="DataExplorerList_EntryInfoSpacer-sc-6qxfsx Hmlgy"></div></div><a href="https://www.kaggle.com/c/avito-demand-prediction/download/train_jpg.zip" class="DataExplorerList_EntryAction-sc-1hkyq01 kJGSCc"><span name="download" class="DataExplorerList_EntryActionIconBackground-sc-aljf47 gfXnRe fa fa-download"></span></a></div><div class="DataExplorerList_Entry-sc-1uffrzs khXEaG"><div class="DataExplorerList_UnselectedEntry-sc-1lv5br0 bgskLU"><div style="width: 32px; min-width: 32px; max-width: 32px;"></div><span name="chevron-right" class="DataExplorerList_CollapsedIcon-sc-1qjwt1i DataExplorerList_DisabledCollapsedIcon-sc-1qkqjxo fZbCWh fa fa-chevron-right"></span><span name="file-zip-o" class="DataExplorerList_TypeIcon-sc-mjsupj kUeJgO fa fa-file-zip-o"></span><div class="DataExplorerList_EntryNameToolTip2-sc-kc4oz cMQbPv ToolTip_ToolTipContainer-sc-f0vhmk eHUYTV"><div data-tip="true" data-for="tooltip_10" class="DataExplorerList_EntryName-sc-12cja4h eKEqwz" currentitem="false">train_jpg_0.zip</div><div class="__react_component_tooltip place-top type-dark " id="tooltip_10" data-id="tooltip"><div class="ToolTip_ToolTipView-sc-1ci7zcv iiWQyY"><span>train_jpg_0.zip</span></div></div></div><div class="DataExplorerList_EntryInfoSpacer-sc-6qxfsx Hmlgy"></div></div><a href="https://www.kaggle.com/c/avito-demand-prediction/download/train_jpg_0.zip" class="DataExplorerList_EntryAction-sc-1hkyq01 kJGSCc"><span name="download" class="DataExplorerList_EntryActionIconBackground-sc-aljf47 gfXnRe fa fa-download"></span></a></div><div class="DataExplorerList_Entry-sc-1uffrzs khXEaG"><div class="DataExplorerList_UnselectedEntry-sc-1lv5br0 DataExplorerList_MoreEntryUnclickable-sc-h1ke76 bfloNK"><div style="width: 32px; min-width: 32px; max-width: 32px;"></div><span name="chevron-right" class="DataExplorerList_CollapsedIcon-sc-1qjwt1i DataExplorerList_DisabledCollapsedIcon-sc-1qkqjxo fZbCWh fa fa-chevron-right"></span><span name="ellipsis-h" class="DataExplorerList_TypeIcon-sc-mjsupj kUeJgO fa fa-ellipsis-h"></span><div class="ToolTip_ToolTipContainer-sc-f0vhmk eHUYTV"><div data-tip="true" data-for="tooltip_11" class="DataExplorerList_EntryName-sc-12cja4h DataExplorerList_EntryMore-sc-1igsxs7 dwCySX" currentitem="false">4 more</div><div class="__react_component_tooltip place-top type-dark " id="tooltip_11" data-id="tooltip"><div class="ToolTip_ToolTipView-sc-1ci7zcv iiWQyY">14 children total</div></div></div></div></div></div><a href="https://www.kaggle.com/c/avito-demand-prediction" target="_blank" class="DataExplorerList_EntryAction-sc-1hkyq01 kJGSCc"><span name="external-link" class="DataExplorerList_EntryActionIconBackground-sc-aljf47 gfXnRe fa fa-external-link"></span></a></div></div></div></div><div class="DataExplorerOverview_Column-sc-1xt9894 DataExplorerOverview_ObjectColumn-sc-v8kz4s ihDqUe"><div class="DataExplorerDescription_Container-sc-rtvgew bNXSrs"><div class="DataExplorerDescription_DatasourceHeader-sc-1jjl64y hYvtkD"><img src="./Img feature extraction with pretrained Resnet _ Kaggle_files/thumb76_76.png" alt="Avito Demand Prediction Challenge source image" class="DataExplorerDescription_DatasourceImage-sc-124hjw6 faQqwa"><div class="DataExplorerDescription_DatasourceDetails-sc-6z9az5 cgraVO"><div class="DataExplorerDescription_DatasourceName-sc-16246cx dGdqfj"><a href="https://www.kaggle.com/c/avito-demand-prediction" class="DataExplorerDescription_DatasourceLink-sc-40is1k cdJMFj">Avito Demand Prediction Challenge</a></div><div class="DataExplorerDescription_DatasourceOverview-sc-64u3xx dthRbg">Predict demand for an online classified ad</div><div class="DataExplorerDescription_DatasourceLastUpdated-sc-1bnzx7s gFoPLV">Last Updated: <span title="Wed Apr 25 2018 05:44:34 GMT+0800 (台北標準時間)">a year ago</span></div></div></div><div class="DataExplorerDescription_Header-sc-9udzgu kagSZQ"><div class="DataExplorerDescription_HeaderTitle-sc-8yzcy8 kIiVNS">About this Competition</div><div class="DataExplorerDescription_HeaderRight-sc-m2iwyg fyjBEU"></div></div><div class="DataExplorerDescription_Content-sc-yp9anb eysdMp"><div class="markdown-converter__text--rendered data-explorer-overview-description"><h2>Update</h2>

<p>To make it easier to download the training images, we have added several smaller zip archives that hold the same images as train_jpg.zip. If you have already downloaded train_jpg.zip you can ignore these completely.</p>

<h2>File and column descriptions</h2>

<ul>
<li><strong>train.csv</strong> - Train data.
<ul><li><code>item_id</code>  - Ad id.</li>
<li><code>user_id</code> - User id.</li>
<li><code>region</code> - Ad region.</li>
<li><code>city</code> - Ad city.</li>
<li><code>parent_category_name</code> - Top level ad category as classified by Avito's ad model.</li>
<li><code>category_name</code> - Fine grain ad category as classified by Avito's ad model.</li>
<li><code>param_1</code> - Optional parameter from Avito's ad model.</li>
<li><code>param_2</code> - Optional parameter from Avito's ad model.</li>
<li><code>param_3</code> - Optional parameter from Avito's ad model.</li>
<li><code>title</code> - Ad title.</li>
<li><code>description</code> - Ad description.</li>
<li><code>price</code> - Ad price.</li>
<li><code>item_seq_number</code> - Ad sequential number for user.</li>
<li><code>activation_date</code>- Date ad was placed.</li>
<li><code>user_type</code> - User type.</li>
<li><code>image</code> - Id code of image. Ties to a jpg file in train_jpg. Not every ad has an image.</li>
<li><code>image_top_1</code> - Avito's classification code for the image.</li>
<li><code>deal_probability</code> - <strong>The target variable</strong>. This is the likelihood that an ad actually sold something. It's not possible to verify every transaction with certainty, so this column's value can be any float from zero to one.</li></ul></li>
<li><strong>test.csv</strong> - Test data. Same schema as the train data, minus deal_probability.</li>
<li><strong>train_active.csv</strong> - Supplemental data from ads that were displayed during the same period as train.csv. Same schema as the train data minus deal_probability, image, and image_top_1.</li>
<li><strong>test_active.csv</strong> -  Supplemental data from ads that were displayed during the same period as test.csv. Same schema as the train data minus deal_probability, image, and image_top_1.</li>
<li><strong>periods_train.csv</strong> - Supplemental data showing the dates when the ads from train_active.csv were activated and when they where displayed.
<ul><li><code>item_id</code>  - Ad id. Maps to an id in train_active.csv. IDs may show up multiple times in this file if the ad was renewed.</li>
<li><code>activation_date</code>  - Date the ad was placed.</li>
<li><code>date_from</code>  - First day the ad was displayed.</li>
<li><code>date_to</code>  - Last day the ad was displayed.</li></ul></li>
<li><strong>periods_test.csv</strong> - Supplemental data showing the dates when the ads from test_active.csv were activated and when they where displayed. Same schema as periods_train.csv, except that the item ids map to an ad in test_active.csv.</li>
<li><strong>train_jpg.zip</strong> - Images from the ads in train.csv.</li>
<li><strong>test_jpg.zip</strong> - Images from the ads in test.csv.</li>
<li><strong>sample_submission.csv</strong> - A sample submission in the correct format.</li>
<li><strong>train_jpg_{0, 1, 2, 3, 4}.zip</strong> - These are the exact same images as you'll find in train_jpg.zip but split into smaller zip archives so the data are easier to download. If you already have train_jpg.zip you do NOT need to download these. We have not made these zips available in kernels as they would only increase the kernel creation time.</li>
</ul></div></div></div></div></div></div></div></div></div><div id="output"></div><div id="comments"><div class="comment-list"><div class="comment-list__header"><span class="comment-list__title">Comments <span class="comment-list__title-count">(3)</span></span><span class="comment-list__spacer"></span><div class="comment-list__sort-pane-button"><div class="Select KaggleSelect has-value Select--single"><div class="Select-control"><div class="Select-multi-value-wrapper" id="react-select-2--value"><div class="Select-value"><span class="Select-value-label" role="option" aria-selected="true" id="react-select-2--value-item">All Comments</span></div><div aria-expanded="false" aria-owns="" aria-activedescendant="react-select-2--value" aria-disabled="false" class="Select-input" role="combobox" tabindex="0" style="border: 0px; width: 1px; display: inline-block;"></div></div><span class="Select-arrow-zone"><span class="Select-arrow"></span></span></div></div><span><span class="comment-list__sortby-label">Sort by</span><div class="Select KaggleSelect has-value Select--single"><div class="Select-control"><div class="Select-multi-value-wrapper" id="react-select-3--value"><div class="Select-value"><span class="Select-value-label" role="option" aria-selected="true" id="react-select-3--value-item">Hotness</span></div><div aria-expanded="false" aria-owns="" aria-activedescendant="react-select-3--value" aria-disabled="false" class="Select-input" role="combobox" tabindex="0" style="border: 0px; width: 1px; display: inline-block;"></div></div><span class="Select-arrow-zone"><span class="Select-arrow"></span></span></div></div></span></div></div><div class="comment-wrapper comment-wrapper--mini-form"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/insightseeker" style="width: 40px;"><img class="avatar__thumbnail" src="./Img feature extraction with pretrained Resnet _ Kaggle_files/1050034-gp.jpg" alt="KentHsieh" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Img feature extraction with pretrained Resnet _ Kaggle_files/avatier-novice@2x.png" alt="novice tier" width="40" style="margin-top: 2px;"></a></div><div class="discussion-comment discussion-comment--parent"><div class="discussion-comment__body discussion-comment__body--mini discussion-comment__body--editing"><div class="Comment_PlaceholderInputWrapper-sc-17xtcz1 koqHBC"><textarea placeholder="Click here to comment..." class="Comment_PlaceholderInput-sc-1wlma0j cDsCxI"></textarea></div></div></div></div><div class="comment-list__comment-linking-spacer"></div><div><div id="464374"><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/rudrendum" style="width: 40px;"><img class="avatar__thumbnail" src="./Img feature extraction with pretrained Resnet _ Kaggle_files/default-thumb.png" alt="Rudrendu Mahindar" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Img feature extraction with pretrained Resnet _ Kaggle_files/avatier-novice@2x.png" alt="novice tier" width="40" style="margin-top: 2px;"></a></div><div class="discussion-comment"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link" href="https://www.kaggle.com/rudrendum" title="Rudrendu Mahindar">Rudrendu Mahindar</a></span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Latest Version</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Fri Feb 01 2019 02:25:39 GMT+0800 (台北標準時間)">7 months ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up vb-upvote"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up vote-button__vote-count-container"><span class="vote-button__vote-count">0</span></div><div class="vote-button__button-placeholder"></div></div></div></span><div class="discussion-comment__body"><div><div class="markdown-converter__text--rendered"><p>NameError: name 'train_filenames' is not defined<br>
AttributeError: 'list' object has no attribute 'close'</p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div></div></div></div></div></div><div class="comment-list__comment-linking-spacer"></div><div><div id="464372"><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/rudrendum" style="width: 40px;"><img class="avatar__thumbnail" src="./Img feature extraction with pretrained Resnet _ Kaggle_files/default-thumb.png" alt="Rudrendu Mahindar" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Img feature extraction with pretrained Resnet _ Kaggle_files/avatier-novice@2x.png" alt="novice tier" width="40" style="margin-top: 2px;"></a></div><div class="discussion-comment"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link" href="https://www.kaggle.com/rudrendum" title="Rudrendu Mahindar">Rudrendu Mahindar</a></span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Latest Version</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Fri Feb 01 2019 02:19:14 GMT+0800 (台北標準時間)">7 months ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up vb-upvote"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up vote-button__vote-count-container"><span class="vote-button__vote-count">0</span></div><div class="vote-button__button-placeholder"></div></div></div></span><div class="discussion-comment__body"><div><div class="markdown-converter__text--rendered"><p>NameError: name 'i' is not defined</p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div></div></div></div></div></div><div class="comment-list__comment-linking-spacer"></div><div><div id="334962"><div class="comment-wrapper"><div class="discussion-comment__author"><a class="avatar" href="https://www.kaggle.com/insaff" style="width: 40px;"><img class="avatar__thumbnail" src="./Img feature extraction with pretrained Resnet _ Kaggle_files/465880-fb.jpg" alt="Insaf Ashrapov" width="40" height="40" style="border-radius: 4px;"><img class="avatar__tier" src="./Img feature extraction with pretrained Resnet _ Kaggle_files/avatier-expert@2x.png" alt="expert tier" width="40" style="margin-top: 2px;"></a></div><div class="discussion-comment"><span class="discussion-comment__title"><span class="discussion-comment__title-author-link-wrapper"><a class="discussion-comment__title-author-link discussion-comment__title-author-link--topic-author" href="https://www.kaggle.com/insaff" title="Insaf Ashrapov">Insaf Ashrapov</a></span><span class="discussion-comment__title-poster-badge discussion-comment__title-poster-badge--topic-author">Kernel Author</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element">Posted on Latest Version</span><span class="discussion-comment__title-element">•</span><span class="discussion-comment__title-element"><span title="Tue May 29 2018 05:12:31 GMT+0800 (台北標準時間)">a year ago</span></span><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Options</a><span class="discussion-comment__title-element">•</span><a class="discussion-comment__title-element discussion-comment__title-element--link">Reply</a><span class="discussion-comment__title-element--spacer"></span><div class="vote-button__container "><div class="vote-button vote-button--compact vote-button--enabled vote-button--has-downvote"><div class="vote-button__button vote-button__button--up vb-upvote"><span class="fa fa-angle-up"></span></div><div class="vote-button__button vote-button__button--up vote-button__vote-count-container"><span class="vote-button__vote-count">0</span></div><div class="vote-button__button-placeholder"></div></div></div></span><div class="discussion-comment__body"><div><div class="markdown-converter__text--rendered"><p>Extracting features one by one might be slow, should be rewrited to work with minibatches</p></div><span class=""></span><div class="file-list file-list--compact"></div><div class="file-list file-list--compact"></div></div></div></div></div></div></div><div class="comment-list__comment-linking-spacer"></div></div></div></div></div><div class="KernelViewer_EmptyColumn-sc-bggm6s hnmdWt"></div></div></div><span class="KernelViewer_NavigationFooterWrapper-sc-4ovrl2 kcUtKL"><div class="StickyFooter-sc-17zvw1m fWlDXE"><nav class="NavBoxFooter_NavigationBar-sc-fpq4iw cMYHPq"><a href="https://www.kaggle.com/insaff/img-feature-extraction-with-pretrained-resnet/code" title="Code" class="NavBoxFooter_NavigationElement-sc-1a4m5yz NavBoxFooter_SelectedNavigationElement-sc-128c1nx cbSEkc"><div><span name="file-code-o" size="20" class="fa fa-file-code-o fa-stack-20x"></span></div><div class="NavBoxFooter_NavigationText-sc-p8ascv fWncVd">Code</div></a><a href="https://www.kaggle.com/insaff/img-feature-extraction-with-pretrained-resnet/log" title="Log" class="NavBoxFooter_NavigationElement-sc-1a4m5yz hmfEdB"><div><span name="file-text-o" size="20" class="fa fa-file-text-o fa-stack-20x"></span></div><div class="NavBoxFooter_NavigationText-sc-p8ascv fWncVd">Log</div></a><a href="https://www.kaggle.com/insaff/img-feature-extraction-with-pretrained-resnet/data" title="Data" class="NavBoxFooter_NavigationElement-sc-1a4m5yz hmfEdB"><div><span name="table" size="20" class="fa fa-table fa-stack-20x"></span></div><div class="NavBoxFooter_NavigationText-sc-p8ascv fWncVd">Data</div></a><a href="https://www.kaggle.com/insaff/img-feature-extraction-with-pretrained-resnet/comments" title="Comments" class="NavBoxFooter_NavigationElement-sc-1a4m5yz hmfEdB"><div><span name="comment" size="20" class="fa fa-comment fa-stack-20x"></span></div><div class="NavBoxFooter_NavigationText-sc-p8ascv fWncVd">Comments</div></a></nav><div class="navbox__page"></div></div></span></div></div></div><script>var Kaggle=window.Kaggle||{};Kaggle.State=Kaggle.State||[];Kaggle.State.push({"kernel":{"id":1040286,"title":"Img feature extraction with pretrained Resnet","forkParent":null,"currentRunId":3804868,"mostRecentRunId":3804868,"url":"/insaff/img-feature-extraction-with-pretrained-resnet","tags":[],"commentCount":0,"upvoteCount":7,"viewCount":3767,"forkCount":2,"bestPublicScore":null,"author":{"id":465880,"displayName":"Insaf Ashrapov","email":null,"editedEmail":null,"editedEmailCode":null,"userName":"insaff","thumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/465880-fb.jpg","profileUrl":"/insaff","registerDate":"0001-01-01T00:00:00Z","lastVisitDate":"0001-01-01T00:00:00Z","statusId":0,"performanceTier":2,"userRoles":null,"userLogins":null,"groupIds":null,"duplicateUsers":null,"hasPhoneVerifications":false,"failedNerdchas":0,"hasPendingNerdcha":false,"deleteRequests":null,"userAttributes":null,"isAdmin":false,"isTvc":false,"isKaggleBot":false,"isAdminOrTvc":false,"isAnonymous":false,"canAct":false,"canBeSeen":false,"thumbnailName":null,"activationCode":"00000000-0000-0000-0000-000000000000","isPhoneVerified":false},"isPrivate":false,"updatedTime":"2018-05-28T21:11:17.2433333Z","selfLink":"/kernels/1040286","pinnedDockerImageVersionId":null,"isLanguageTemplate":false,"medal":null,"topicId":57769,"readGroupId":null,"writeGroupId":null,"slug":"img-feature-extraction-with-pretrained-resnet"},"kernelBlob":{"id":2365729,"settings":{"dockerImageVersionId":null,"dataSources":[{"sourceType":"Competition","sourceId":8586,"databundleVersionId":null,"mountSlug":null}],"sourceType":"script","language":"python","isGpuEnabled":false,"isInternetEnabled":false},"source":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle/python docker image: https://github.com/kaggle/docker-python\n# For example, here\u0027s several helpful packages to load in \n\nfrom tqdm import tqdm \nimport tensorflow as tf \nfrom keras.applications.resnet50 import ResNet50\nfrom keras.layers import Flatten, Input\nfrom keras.models import Model\nfrom keras.preprocessing import image\nfrom keras.applications.imagenet_utils import preprocess_input\nimport numpy as np\nfrom google.cloud import storage \nfrom io import BytesIO\nimport time\nimport cv2\nstart = time.time()\n\n\nmodel = ResNet50(weights=\u0027imagenet\u0027, pooling=max, include_top = False) \n\n####### GENERATING FEATURES\nfeatues = open(\u0027train_featues.txt\u0027, \u0027w+\u0027) #to save features\ntrain_dir = \u0027.../train\u0027\ntrain_files = os.listdir(train_dir)\n\n \nstart = time.time()\n\nfor file in  tqdm(train_files):\n    try:\n        f = v2.imread(os.path.join(train_dir, file))\n        img = image.load_img(f, target_size=(224, 224)) \n        x = image.img_to_array(img) \n        x = np.expand_dims(x, axis=0) \n        x = preprocess_input(x) \n        features = model.predict(x) \n        features_reduce = features.squeeze() \n        train_featues.write(\u0027 \u0027.join(str(x) for x in features.squeeze()) + \u0027\\n\u0027)\n    except: # to skip not files in a wrong format\n         pass\n\nprint(i)\nend = time.time()\nprint(\u0027\\n\\ntime spend: \u0027 , (end - start)/60 , \u0027 minutes \\n\\n\u0027)\n\ntrain_filenames.close()\n","dateCreated":"2018-05-28T21:11:15.5163446Z"},"kernelRun":{"id":3804868,"kernelId":1040286,"status":"error","type":"batch","sourceType":"script","language":"python","title":"Img feature extraction with pretrained Resnet","dateCreated":"2018-05-28T21:11:15.813Z","dateEvaluated":"2018-05-28T21:11:17.243Z","workerContainerPort":null,"workerUptimeSeconds":20222,"workerIPAddress":"172.16.7.4     ","scriptLanguageId":2,"scriptLanguageName":"Python","renderedOutputUrl":null,"commit":{"id":2365729,"settings":{"dockerImageVersionId":null,"dataSources":[{"sourceType":"Competition","sourceId":8586,"databundleVersionId":null,"mountSlug":null}],"sourceType":"script","language":"python","isGpuEnabled":false,"isInternetEnabled":false},"source":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle/python docker image: https://github.com/kaggle/docker-python\n# For example, here\u0027s several helpful packages to load in \n\nfrom tqdm import tqdm \nimport tensorflow as tf \nfrom keras.applications.resnet50 import ResNet50\nfrom keras.layers import Flatten, Input\nfrom keras.models import Model\nfrom keras.preprocessing import image\nfrom keras.applications.imagenet_utils import preprocess_input\nimport numpy as np\nfrom google.cloud import storage \nfrom io import BytesIO\nimport time\nimport cv2\nstart = time.time()\n\n\nmodel = ResNet50(weights=\u0027imagenet\u0027, pooling=max, include_top = False) \n\n####### GENERATING FEATURES\nfeatues = open(\u0027train_featues.txt\u0027, \u0027w+\u0027) #to save features\ntrain_dir = \u0027.../train\u0027\ntrain_files = os.listdir(train_dir)\n\n \nstart = time.time()\n\nfor file in  tqdm(train_files):\n    try:\n        f = v2.imread(os.path.join(train_dir, file))\n        img = image.load_img(f, target_size=(224, 224)) \n        x = image.img_to_array(img) \n        x = np.expand_dims(x, axis=0) \n        x = preprocess_input(x) \n        features = model.predict(x) \n        features_reduce = features.squeeze() \n        train_featues.write(\u0027 \u0027.join(str(x) for x in features.squeeze()) + \u0027\\n\u0027)\n    except: # to skip not files in a wrong format\n         pass\n\nprint(i)\nend = time.time()\nprint(\u0027\\n\\ntime spend: \u0027 , (end - start)/60 , \u0027 minutes \\n\\n\u0027)\n\ntrain_filenames.close()\n","dateCreated":"2018-05-28T21:11:15.5163446Z"},"resources":null,"isolatorResults":"\u003cresults\u003e\u003cdisk_kb_free\u003e945524\u003c/disk_kb_free\u003e\u003cdocker_image_digest\u003e6dd711c2b4a1cb394f9c16db1697f54f27d5fad7a1dd4c596d3042209a5db80d\u003c/docker_image_digest\u003e\u003cdocker_image_id\u003esha256:e39b0c725c6ea95b65ac08ce0b83567873d64f5be033e681ba2d1b2f0e38dcd1\u003c/docker_image_id\u003e\u003cdocker_image_name\u003egcr.io/kaggle-images/python\u003c/docker_image_name\u003e\u003cexit_code\u003e1\u003c/exit_code\u003e\u003cfailure_message\u003eThe kernel returned an unsuccessful exit code (1).\u003c/failure_message\u003e\u003cinvalid_path_errors\u003eFalse\u003c/invalid_path_errors\u003e\u003cout_of_memory\u003eFalse\u003c/out_of_memory\u003e\u003crun_time_seconds\u003e5.80747339499794\u003c/run_time_seconds\u003e\u003csucceeded\u003eFalse\u003c/succeeded\u003e\u003ctimeout_exceeded\u003eFalse\u003c/timeout_exceeded\u003e\u003cused_all_space\u003eFalse\u003c/used_all_space\u003e\u003cwas_killed\u003eFalse\u003c/was_killed\u003e\u003c/results\u003e","runInfo":{"dockerfileUrl":"https://github.com/Kaggle/docker-python/blob/master/Dockerfile","dockerHubUrl":"https://registry.hub.docker.com/u/kaggle/python/","dockerImageDigest":"6dd711c2b4a1cb394f9c16db1697f54f27d5fad7a1dd4c596d3042209a5db80d","dockerImageId":"sha256:e39b0c725c6ea95b65ac08ce0b83567873d64f5be033e681ba2d1b2f0e38dcd1","dockerImageName":"kaggle/python","diskKbFree":945524,"failureMessage":"The kernel returned an unsuccessful exit code (1).","exitCode":1,"queuedSeconds":0,"outputSizeBytes":0,"runTimeSeconds":5.80747339499794,"usedAllSpace":false,"timeoutExceeded":false,"isValidStatus":false,"wasGpuEnabled":false,"wasInternetEnabled":false,"outOfMemory":false,"invalidPathErrors":false,"succeeded":false,"wasKilled":false},"outputFilesTotalSizeBytes":0,"dockerImageVersionId":3200,"usedCustomDockerImage":false,"dataSources":[{"sourceType":"Competition","sourceId":8586,"databundleVersionId":null,"mountSlug":""}]},"author":{"id":465880,"displayName":"Insaf Ashrapov","email":null,"editedEmail":null,"editedEmailCode":null,"userName":"insaff","thumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/465880-fb.jpg","profileUrl":"/insaff","registerDate":"0001-01-01T00:00:00Z","lastVisitDate":"0001-01-01T00:00:00Z","statusId":0,"performanceTier":2,"userRoles":null,"userLogins":null,"groupIds":null,"duplicateUsers":null,"hasPhoneVerifications":false,"failedNerdchas":0,"hasPendingNerdcha":false,"deleteRequests":null,"userAttributes":null,"isAdmin":false,"isTvc":false,"isKaggleBot":false,"isAdminOrTvc":false,"isAnonymous":false,"canAct":false,"canBeSeen":false,"thumbnailName":null,"activationCode":"00000000-0000-0000-0000-000000000000","isPhoneVerified":false},"baseUrl":"/insaff/img-feature-extraction-with-pretrained-resnet","collaborators":{"owner":{"userId":465880,"groupId":null,"groupMemberCount":null,"profileUrl":"/insaff","thumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/465880-fb.jpg","name":"Insaf Ashrapov","slug":"insaff","userTier":2,"joinDate":null,"type":"owner","isUser":true,"isGroup":false},"collaborators":[]},"initialTab":null,"log":"[{\n  \u0022data\u0022: \u0022Using TensorFlow backend.\\n\u0022,\n  \u0022stream_name\u0022: \u0022stderr\u0022,\n  \u0022time\u0022: 4.441449829999328\n},{\n  \u0022data\u0022: \u0022Traceback (most recent call last):\\n  File \\\u0022../src/script.py\\\u0022, line 13, in \u003cmodule\u003e\\n\u0022,\n  \u0022stream_name\u0022: \u0022stderr\u0022,\n  \u0022time\u0022: 4.911210237998603\n},{\n  \u0022data\u0022: \u0022    from google.cloud import storage \\nImportError: cannot import name \u0027storage\u0027\\n\u0022,\n  \u0022stream_name\u0022: \u0022stderr\u0022,\n  \u0022time\u0022: 4.943819121999695\n}]","outputFiles":[],"outputFilesCropped":false,"ouputFilesOwnerInfo":{"databundleVersionId":0,"dataset":null,"competition":null,"kernel":{"kernelId":1040286,"kernelVersionId":3804868,"dataviewToken":"eyJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2In0..fP52g38yA4kYIInaDwogTQ.-c5CuobRfx1JdIED6LJoih8QBemfP1vhYCEBlOAKiBzlra3B-KwIIkMGV11AX-8wDeYguE-78xvA_KEecbxo-P2hjkYNGMWVXGnRGSpHN9YnhEY3yefanVXYEqRjeei3_BbW2Mms5m30BUbZ92ya1UaUcaSi7eVG5j1qVctlefbPEKgh-SDNIfM_mqw9CJWk2BWvnRjYdsgfv_xmKU6dhFiMmZnuNt7uC_beyBvSOpXvlAkqsn7at2OBIoVwSOpaLH2ZBXN2msKXBjMmyflfnxJ-OrJboQFLiVp_sPMGDMMTxnvZG_8Sjy0a8ltWs5ISwXCuAMiE-7CMyFGNMvaYLHr1Be9lbzC6ZJeNw_44XfJ9-avrvT6ltQmKdA68ymU6laFzhUTFbE7DRMAQekByMJJC8kSAJPEPQfXbPfCJCfL1VQ4kvBPhGWBORTQmiCEcrI-_E4KpQL_n9HC30EDDTrhMNNekL3iWN3LhZ06bAszWBbu9NnN-W7yPkKRcyEFA.mdRmFP1pbIVqKTI1fGvUmw","scope":"insaff/img-feature-extraction-with-pretrained-resnet"},"previewsDisabled":false},"pageMessages":[],"dataSources":[{"imageUrl":"https://storage.googleapis.com/kaggle-competitions/kaggle/8586/logos/thumb76_76.png?t=2018-02-21-01-56-29","sourceUrl":"/c/avito-demand-prediction","slug":"avito-demand-prediction","lastUpdated":"2018-04-24T21:44:34.11Z","overview":"Predict demand for an online classified ad","sourceType":"competition","sourceVersionType":null,"sourceId":8586,"sourceVersionNumber":null,"maxVersionNumber":null,"descriptionMimeType":"text/markdown","deleted":false,"private":false,"privateButVisible":false,"ownerInfo":{"databundleVersionId":46657,"dataset":null,"competition":{"competitionId":8586,"dataviewToken":null,"scope":"c/avito-demand-prediction"},"kernel":null,"previewsDisabled":true},"mountSlug":"","type":"dataSource","collapsed":false,"info":{"metrics":null,"archiveInfo":null,"archiveInfoV2":null,"blobFileInfo":null,"convertCsvInfo":null,"kernelReference":null},"settings":{"csvSettings":null,"bigQuerySettings":null,"bigQueryMirrorSettings":null,"storageSettings":null,"remoteUrlSettings":null,"remoteGithubSettings":null},"render":null,"children":[{"id":121920,"blobFileId":435008,"databundleVersionId":46657,"databundleVersionObjectType":"file","url":null,"relativePath":"../input/periods_test.csv","creationDate":"2018-04-24T18:25:02.9Z","isDummy":false,"size":143030982,"fullPath":"../input/periods_test.csv","previewUrl":"kernels/competition-preview/8586?relativePath=periods_test.csv","downloadUrl":"/c/avito-demand-prediction/download/periods_test.csv","fileType":".csv","contentLength":143030982,"contentType":"application/zip","contentMD5":"6+2c63uODypwKVF1Y6O3uw==","validationErrors":null,"type":"databundleVersionObject","collapsed":false,"info":null,"settings":null,"render":null,"children":[],"firestorePath":null,"firestoreKey":null,"name":"periods_test.csv","description":""},{"id":121921,"blobFileId":435009,"databundleVersionId":46657,"databundleVersionObjectType":"file","url":null,"relativePath":"../input/periods_train.csv","creationDate":"2018-04-24T18:25:04.411Z","isDummy":false,"size":178533210,"fullPath":"../input/periods_train.csv","previewUrl":"kernels/competition-preview/8586?relativePath=periods_train.csv","downloadUrl":"/c/avito-demand-prediction/download/periods_train.csv","fileType":".csv","contentLength":178533210,"contentType":"application/zip","contentMD5":"IrMBYC4Cmiu5sbda8nQdQA==","validationErrors":null,"type":"databundleVersionObject","collapsed":false,"info":null,"settings":null,"render":null,"children":[],"firestorePath":null,"firestoreKey":null,"name":"periods_train.csv","description":""},{"id":121916,"blobFileId":434336,"databundleVersionId":46657,"databundleVersionObjectType":"file","url":null,"relativePath":"../input/sample_submission.csv","creationDate":"2018-04-23T21:26:51.304Z","isDummy":false,"size":8643471,"fullPath":"../input/sample_submission.csv","previewUrl":"kernels/competition-preview/8586?relativePath=sample_submission.csv","downloadUrl":"/c/avito-demand-prediction/download/sample_submission.csv","fileType":".csv","contentLength":8643471,"contentType":"text/csv","contentMD5":"het/dcK3Ynx/Ah3yCUNrTQ==","validationErrors":null,"type":"databundleVersionObject","collapsed":false,"info":null,"settings":null,"render":null,"children":[],"firestorePath":null,"firestoreKey":null,"name":"sample_submission.csv","description":""},{"id":121923,"blobFileId":435014,"databundleVersionId":46657,"databundleVersionObjectType":"file","url":null,"relativePath":"../input/test_active.csv","creationDate":"2018-04-24T18:31:08.938Z","isDummy":false,"size":2502067173,"fullPath":"../input/test_active.csv","previewUrl":"kernels/competition-preview/8586?relativePath=test_active.csv","downloadUrl":"/c/avito-demand-prediction/download/test_active.csv","fileType":".csv","contentLength":2502067173,"contentType":"application/zip","contentMD5":"eq9+WcIGFzv0K1k0o8xLmA==","validationErrors":null,"type":"databundleVersionObject","collapsed":false,"info":null,"settings":null,"render":null,"children":[],"firestorePath":null,"firestoreKey":null,"name":"test_active.csv","description":""},{"id":121917,"blobFileId":434362,"databundleVersionId":46657,"databundleVersionObjectType":"file","url":null,"relativePath":"../input/test_jpg.zip","creationDate":"2018-04-23T22:09:42.449Z","isDummy":false,"size":20113157563,"fullPath":"../input/test_jpg.zip","previewUrl":"kernels/competition-preview/8586?relativePath=test_jpg.zip","downloadUrl":"/c/avito-demand-prediction/download/test_jpg.zip","fileType":".zip","contentLength":20113157563,"contentType":"application/zip","contentMD5":"XbMFFRtaJHFqPTFlwhmCjg==","validationErrors":null,"type":"databundleVersionObject","collapsed":false,"info":null,"settings":null,"render":null,"children":[],"firestorePath":null,"firestoreKey":null,"name":"test_jpg.zip","description":""},{"id":121919,"blobFileId":435007,"databundleVersionId":46657,"databundleVersionObjectType":"file","url":null,"relativePath":"../input/test.csv","creationDate":"2018-04-24T18:25:00.508Z","isDummy":false,"size":112374170,"fullPath":"../input/test.csv","previewUrl":"kernels/competition-preview/8586?relativePath=test.csv","downloadUrl":"/c/avito-demand-prediction/download/test.csv","fileType":".csv","contentLength":112374170,"contentType":"application/zip","contentMD5":"pUp7lkvdaYLhXSX+w+UpVg==","validationErrors":null,"type":"databundleVersionObject","collapsed":false,"info":null,"settings":null,"render":null,"children":[],"firestorePath":null,"firestoreKey":null,"name":"test.csv","description":""},{"id":121924,"blobFileId":435021,"databundleVersionId":46657,"databundleVersionObjectType":"file","url":null,"relativePath":"../input/train_active.csv","creationDate":"2018-04-24T18:44:13.625Z","isDummy":false,"size":2706496502,"fullPath":"../input/train_active.csv","previewUrl":"kernels/competition-preview/8586?relativePath=train_active.csv","downloadUrl":"/c/avito-demand-prediction/download/train_active.csv","fileType":".csv","contentLength":2706496502,"contentType":"application/zip","contentMD5":"RFUconoeJQL3dOIu6gmMuA==","validationErrors":null,"type":"databundleVersionObject","collapsed":false,"info":null,"settings":null,"render":null,"children":[],"firestorePath":null,"firestoreKey":null,"name":"train_active.csv","description":""},{"id":121928,"blobFileId":440124,"databundleVersionId":46657,"databundleVersionObjectType":"file","url":null,"relativePath":"../input/train_jpg_0.zip","creationDate":"2018-05-01T22:40:06.322Z","isDummy":false,"size":10652250687,"fullPath":"../input/train_jpg_0.zip","previewUrl":"kernels/competition-preview/8586?relativePath=train_jpg_0.zip","downloadUrl":"/c/avito-demand-prediction/download/train_jpg_0.zip","fileType":".zip","contentLength":10652250687,"contentType":"application/zip","contentMD5":"YjL9uEgdrHI8ZzT8de+lVQ==","validationErrors":null,"type":"databundleVersionObject","collapsed":false,"info":null,"settings":null,"render":null,"children":[],"firestorePath":null,"firestoreKey":null,"name":"train_jpg_0.zip","description":""},{"id":121927,"blobFileId":440123,"databundleVersionId":46657,"databundleVersionObjectType":"file","url":null,"relativePath":"../input/train_jpg_1.zip","creationDate":"2018-05-01T22:40:06.16Z","isDummy":false,"size":10664299419,"fullPath":"../input/train_jpg_1.zip","previewUrl":"kernels/competition-preview/8586?relativePath=train_jpg_1.zip","downloadUrl":"/c/avito-demand-prediction/download/train_jpg_1.zip","fileType":".zip","contentLength":10664299419,"contentType":"application/zip","contentMD5":"TpyfCj5rGAVnaQER5fletQ==","validationErrors":null,"type":"databundleVersionObject","collapsed":false,"info":null,"settings":null,"render":null,"children":[],"firestorePath":null,"firestoreKey":null,"name":"train_jpg_1.zip","description":""},{"id":121926,"blobFileId":440122,"databundleVersionId":46657,"databundleVersionObjectType":"file","url":null,"relativePath":"../input/train_jpg_2.zip","creationDate":"2018-05-01T22:40:05.323Z","isDummy":false,"size":10628125885,"fullPath":"../input/train_jpg_2.zip","previewUrl":"kernels/competition-preview/8586?relativePath=train_jpg_2.zip","downloadUrl":"/c/avito-demand-prediction/download/train_jpg_2.zip","fileType":".zip","contentLength":10628125885,"contentType":"application/zip","contentMD5":"A+xLBsYG1S/3HpOYPgiOzQ==","validationErrors":null,"type":"databundleVersionObject","collapsed":false,"info":null,"settings":null,"render":null,"children":[],"firestorePath":null,"firestoreKey":null,"name":"train_jpg_2.zip","description":""},{"id":121929,"blobFileId":440125,"databundleVersionId":46657,"databundleVersionObjectType":"file","url":null,"relativePath":"../input/train_jpg_3.zip","creationDate":"2018-05-01T22:40:06.44Z","isDummy":false,"size":10650595035,"fullPath":"../input/train_jpg_3.zip","previewUrl":"kernels/competition-preview/8586?relativePath=train_jpg_3.zip","downloadUrl":"/c/avito-demand-prediction/download/train_jpg_3.zip","fileType":".zip","contentLength":10650595035,"contentType":"application/zip","contentMD5":"8Dds3yammkBx9UYACo/HSA==","validationErrors":null,"type":"databundleVersionObject","collapsed":false,"info":null,"settings":null,"render":null,"children":[],"firestorePath":null,"firestoreKey":null,"name":"train_jpg_3.zip","description":""},{"id":121925,"blobFileId":440121,"databundleVersionId":46657,"databundleVersionObjectType":"file","url":null,"relativePath":"../input/train_jpg_4.zip","creationDate":"2018-05-01T22:40:01.741Z","isDummy":false,"size":10633712691,"fullPath":"../input/train_jpg_4.zip","previewUrl":"kernels/competition-preview/8586?relativePath=train_jpg_4.zip","downloadUrl":"/c/avito-demand-prediction/download/train_jpg_4.zip","fileType":".zip","contentLength":10633712691,"contentType":"application/zip","contentMD5":"cdWsrF7el8Ko2G8o0gRSNw==","validationErrors":null,"type":"databundleVersionObject","collapsed":false,"info":null,"settings":null,"render":null,"children":[],"firestorePath":null,"firestoreKey":null,"name":"train_jpg_4.zip","description":""},{"id":121918,"blobFileId":434419,"databundleVersionId":46657,"databundleVersionObjectType":"file","url":null,"relativePath":"../input/train_jpg.zip","creationDate":"2018-04-23T23:06:39.868Z","isDummy":false,"size":53026809421,"fullPath":"../input/train_jpg.zip","previewUrl":"kernels/competition-preview/8586?relativePath=train_jpg.zip","downloadUrl":"/c/avito-demand-prediction/download/train_jpg.zip","fileType":".zip","contentLength":53026809421,"contentType":"application/zip","contentMD5":"azErfO39QSvNfpDDgmSg1g==","validationErrors":null,"type":"databundleVersionObject","collapsed":false,"info":null,"settings":null,"render":null,"children":[],"firestorePath":null,"firestoreKey":null,"name":"train_jpg.zip","description":""},{"id":121922,"blobFileId":435012,"databundleVersionId":46657,"databundleVersionObjectType":"file","url":null,"relativePath":"../input/train.csv","creationDate":"2018-04-24T18:26:58.248Z","isDummy":false,"size":322552680,"fullPath":"../input/train.csv","previewUrl":"kernels/competition-preview/8586?relativePath=train.csv","downloadUrl":"/c/avito-demand-prediction/download/train.csv","fileType":".csv","contentLength":322552680,"contentType":"application/zip","contentMD5":"t8WSCAopXLd3O+dizrlMXg==","validationErrors":null,"type":"databundleVersionObject","collapsed":false,"info":null,"settings":null,"render":null,"children":[],"firestorePath":null,"firestoreKey":null,"name":"train.csv","description":""}],"firestorePath":null,"firestoreKey":null,"name":"Avito Demand Prediction Challenge","description":"## Update\nTo make it easier to download the training images, we have added several smaller zip archives that hold the same images as train_jpg.zip. If you have already downloaded train_jpg.zip you can ignore these completely.\n\n## File and column descriptions\n\n- **train.csv** - Train data.\n    *    `item_id`  - Ad id.\n    *    `user_id` - User id.\n    *    `region` - Ad region.\n    *    `city` - Ad city.\n    *    `parent_category_name` - Top level ad category as classified by Avito\u0027s ad model.\n    *    `category_name` - Fine grain ad category as classified by Avito\u0027s ad model.\n    *    `param_1` - Optional parameter from Avito\u0027s ad model.\n    *    `param_2` - Optional parameter from Avito\u0027s ad model.\n    *    `param_3` - Optional parameter from Avito\u0027s ad model.\n    *    `title` - Ad title.\n    *    `description` - Ad description.\n    *    `price` - Ad price.\n    *    `item_seq_number` - Ad sequential number for user.\n    *    `activation_date`- Date ad was placed.\n    *    `user_type` - User type.\n    *    `image` - Id code of image. Ties to a jpg file in train_jpg. Not every ad has an image.\n    *    `image_top_1` - Avito\u0027s classification code for the image.\n    *    `deal_probability` - **The target variable**. This is the likelihood that an ad actually sold something. It\u0027s not possible to verify every transaction with certainty, so this column\u0027s value can be any float from zero to one.\n- **test.csv** - Test data. Same schema as the train data, minus deal_probability.\n- **train_active.csv** - Supplemental data from ads that were displayed during the same period as train.csv. Same schema as the train data minus deal_probability, image, and image_top_1.\n- **test_active.csv** -  Supplemental data from ads that were displayed during the same period as test.csv. Same schema as the train data minus deal_probability, image, and image_top_1.\n- **periods_train.csv** - Supplemental data showing the dates when the ads from train_active.csv were activated and when they where displayed.\n    *    `item_id`  - Ad id. Maps to an id in train_active.csv. IDs may show up multiple times in this file if the ad was renewed.\n    *    `activation_date`  - Date the ad was placed.\n    *    `date_from`  - First day the ad was displayed.\n    *    `date_to`  - Last day the ad was displayed.\n- **periods_test.csv** - Supplemental data showing the dates when the ads from test_active.csv were activated and when they where displayed. Same schema as periods_train.csv, except that the item ids map to an ad in test_active.csv.\n- **train_jpg.zip** - Images from the ads in train.csv.\n- **test_jpg.zip** - Images from the ads in test.csv.\n- **sample_submission.csv** - A sample submission in the correct format.\n- **train_jpg_{0, 1, 2, 3, 4}.zip** - These are the exact same images as you\u0027ll find in train_jpg.zip but split into smaller zip archives so the data are easier to download. If you already have train_jpg.zip you do NOT need to download these. We have not made these zips available in kernels as they would only increase the kernel creation time.\n"}],"versions":[{"id":3804868,"kernelVersionId":null,"isForkParent":false,"isNotebook":false,"languageName":"Python","lastRunTime":"2018-05-28T21:11:15.813Z","linesChangedFromPrevious":0,"linesDeletedFromPrevious":0,"linesInsertedFromPrevious":48,"outputFilesTotalSizeBytes":0,"runInfo":{"dockerfileUrl":"https://github.com/Kaggle/docker-python/blob/master/Dockerfile","dockerHubUrl":"https://registry.hub.docker.com/u/kaggle/python/","dockerImageId":"sha256:e39b0c725c6ea95b65ac08ce0b83567873d64f5be033e681ba2d1b2f0e38dcd1","dockerImageName":"gcr.io/kaggle-images/python","exitCode":1,"failureMessage":"The kernel returned an unsuccessful exit code (1).","isValidStatus":true,"runTimeSeconds":5.80747339499794,"succeeded":false,"timeoutExceeded":false,"usedAllSpace":false},"status":"error","title":"Img feature extraction with pretrained Resnet","url":"/insaff/img-feature-extraction-with-pretrained-resnet?scriptVersionId=3804868","versionNumber":1,"hasVersionNumber":true,"isRedacted":false,"versionAuthor":null}],"categories":{"categories":[],"type":"script"},"submitToCompetitionInfo":null,"downloadAllFilesUrl":"/kernels/svzip/3804868","submission":null,"menuLinks":[{"href":"/insaff/img-feature-extraction-with-pretrained-resnet/code","text":"Code","title":"Code","tab":"code","count":null,"showZeroCountExplicitly":false,"reportEventCategory":null,"reportEventType":null},{"href":"/insaff/img-feature-extraction-with-pretrained-resnet/log","text":"Log","title":"Log","tab":"log","count":null,"showZeroCountExplicitly":false,"reportEventCategory":null,"reportEventType":null},{"href":"/insaff/img-feature-extraction-with-pretrained-resnet/data","text":"Data","title":"Data","tab":"data","count":1,"showZeroCountExplicitly":false,"reportEventCategory":null,"reportEventType":null},{"href":"/insaff/img-feature-extraction-with-pretrained-resnet/comments","text":"Comments","title":"Comments","tab":"comments","count":3,"showZeroCountExplicitly":true,"reportEventCategory":null,"reportEventType":null}],"rightMenuLinks":[],"callToAction":{"href":"/kernels/fork-version/3804868","text":"Fork Script","title":"Fork Script","tab":null,"count":null,"showZeroCountExplicitly":false,"reportEventCategory":null,"reportEventType":null},"voteButton":{"totalVotes":7,"hasAlreadyVotedUp":false,"hasAlreadyVotedDown":false,"canUpvote":true,"canDownvote":false,"voteUpUrl":"/kernels/vote?id=1040286","voteDownUrl":null,"voters":[{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/7490-gr.jpg","displayName":"Larry Freeman","profileUrl":"/larryfreeman","tier":"Expert","tierInt":2,"userId":7490,"userName":"larryfreeman"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/465880-fb.jpg","displayName":"Insaf Ashrapov","profileUrl":"/insaff","tier":"Expert","tierInt":2,"userId":465880,"userName":"insaff"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/747462-fb.jpg","displayName":"Chi-KangSu","profileUrl":"/judesu","tier":"Novice","tierInt":0,"userId":747462,"userName":"judesu"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/1264580-kg.JPG","displayName":"Kun Hao Yeh","profileUrl":"/khyeh0719","tier":"Master","tierInt":3,"userId":1264580,"userName":"khyeh0719"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/2416568-gp.jpg","displayName":"Crea","profileUrl":"/creacyhuang","tier":"Novice","tierInt":0,"userId":2416568,"userName":"creacyhuang"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/2810844-gp.jpg","displayName":"Arun","profileUrl":"/arunneelakandan","tier":"Novice","tierInt":0,"userId":2810844,"userName":"arunneelakandan"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/3068030-kg.jpg","displayName":"Yi-Ting Kuo","profileUrl":"/tgnco1218","tier":"Novice","tierInt":0,"userId":3068030,"userName":"tgnco1218"}],"currentUserInfo":{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/1050034-gp.jpg","displayName":"KentHsieh","userName":"insightseeker","profileUrl":"/insightseeker","tier":"Novice","tierInt":0,"userId":1050034},"showVoters":true,"alwaysShowVoters":true},"parentDataSource":null,"parentName":"Avito Demand Prediction Challenge","parentUrl":"/c/avito-demand-prediction","thumbnailImageUrl":"https://storage.googleapis.com/kaggle-competitions/kaggle/8586/logos/thumb76_76.png?t=2018-02-21-01-56-29","canWrite":false,"canAdminister":false,"datasetHidden":false,"forkParentIsRedacted":false,"forkDiffLinesChanged":0,"forkDiffLinesDeleted":0,"forkDiffLinesInserted":0,"forkDiffUrl":null,"forkParentAuthorDisplayName":null,"forkParentAuthorUrl":null,"forkParentTitle":null,"forkParentUrl":null,"canSeeDataExplorerV2":true,"canSeeRevampedViewer":true,"canSeeInnerTableOfContents":true,"simplifiedViewer":false,"kernelOutputDataset":null});performance && performance.mark && performance.mark("KernelViewer.componentCouldBootstrap");</script>

<form action="https://www.kaggle.com/insaff/img-feature-extraction-with-pretrained-resnet" id="__AjaxAntiForgeryForm" method="post"><input name="X-XSRF-TOKEN" type="hidden" value="CfDJ8LdUzqlsSWBPr4Ce3rb9VL-PY5k2FPpUjY4W7ZDr8Pf8-lCImz1p83-ySEJmyeoJnMJu7jZ1Gg3HlM_04S8HARbLYHxATArzH0rWD-i0WDbc1-2g_jLr0qM-PQ5aPEsJvN5hgvlQJZVdkU64IWcdznhaXHdtvxJ3VzXvDevRG_TI7L6m9hZsv82tP0v4FjJypQ"></form>

<script type="text/x-mathjax-config;executed=true">
    MathJax.Hub.Config({
        "HTML-CSS": {
            preferredFont: "TeX",
            availableFonts: ["STIX", "TeX"],
            linebreaks: {
                automatic: true
            },
            EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
        },
        tex2jax: {
            inlineMath: [["\\(", "\\)"], ["\\\\(", "\\\\)"]],
            displayMath: [["$$", "$$"], ["\\[", "\\]"]],
            processEscapes: true,
            ignoreClass: "tex2jax_ignore|dno"
        },
        TeX: {
            noUndefined: {
                attributes: {
                    mathcolor: "red",
                    mathbackground: "#FFEEEE",
                    mathsize: "90%"
                }
            }
        },
        Macros: {
            href: "{}"
        },
        skipStartupTypeset: true,
        messageStyle: "none"
    });
</script>
<script type="text/javascript" async="" crossorigin="anonymous" src="./Img feature extraction with pretrained Resnet _ Kaggle_files/MathJax.js.下載"></script>



    </div>

        <div class="site-layout__footer">
            <footer class="site-footer">
    <div class="site-footer__content">
        <div class="site-footer__copyright">
            <span>© 2019 Kaggle Inc</span>
        </div>
        <nav class="site-footer__nav">
            <a href="https://www.kaggle.com/team">Our Team</a>
            <a href="https://www.kaggle.com/terms">Terms</a>
            <a href="https://www.kaggle.com/privacy">Privacy</a>
            <a href="https://www.kaggle.com/contact">Contact/Support</a>
        </nav>
        <nav class="site-footer__social">
            <div data-component-name="SocialIcons" style="display: flex; flex-direction: column; flex: 1 0 auto;"><div style="--mdc-theme-on-primary:#fff; --mdc-theme-on-surface:rgba(0, 0, 0, 0.87); --mdc-theme-text-primary-on-background:rgba(0, 0, 0, 0.87); --mdc-theme-text-secondary-on-background:rgba(0, 0, 0, 0.54); --mdc-theme-text-hint-on-background:rgba(0, 0, 0, 0.38); --mdc-theme-text-disabled-on-background:rgba(0, 0, 0, 0.38); --mdc-theme-text-icon-on-background:rgba(0, 0, 0, 0.38); --mdc-theme-primary:#20BEFF; --mdc-theme-error:#F58B8A; --mdc-theme-background:#F8F8F8; --mdc-theme-surface:#F8F8F8; --mdc-theme-primary-bg:#20BEFF; --mdc-theme-secondary-bg:#919294;"><div class="social-icons"><a class="social-icons__link" href="https://www.youtube.com/kaggle" title="Follow Kaggle on YouTube"><i class="fa fa-youtube-square"></i></a><a class="social-icons__link" href="http://www.twitter.com/kaggle" title="Follow Kaggle on Twitter"><i class="fa fa-twitter-square"></i></a><a class="social-icons__link" href="http://www.facebook.com/kaggle" title="Follow Kaggle on Facebook"><i class="fa fa-facebook-square"></i></a><a class="social-icons__link" href="http://www.linkedin.com/company/kaggle" title="Follow Kaggle on LinkedIn"><i class="fa fa-linkedin-square"></i></a></div></div></div><script>var Kaggle=window.Kaggle||{};Kaggle.State=Kaggle.State||[];Kaggle.State.push();performance && performance.mark && performance.mark("SocialIcons.componentCouldBootstrap");</script>
        </nav>
    </div>
</footer>

        </div>
</div>



    <!-- Cheers, web-55d8b9d4df-h8w69p. -->

    </main>


<iframe id="intercom-frame" style="position: absolute !important; opacity: 0 !important; width: 1px !important; height: 1px !important; top: 0 !important; left: 0 !important; border: none !important; display: block !important; z-index: -1 !important;" aria-hidden="true" tabindex="-1" src="./Img feature extraction with pretrained Resnet _ Kaggle_files/saved_resource.html"></iframe><div id="intercom-css-container"><style data-emotion="intercom-global"></style></div><div id="intercom-container" class="intercom-namespace"><style>html.intercom-mobile-messenger-active,html.intercom-mobile-messenger-active > body,html.intercom-modal-open,#intercom-container-body{overflow:hidden !important;}html.intercom-mobile-messenger-active,html.intercom-mobile-messenger-active > body{position:static !important;}html.intercom-mobile-messenger-active > body{height:0 !important;margin:0 !important;}iframe#intercom-frame{position:absolute !important;opacity:0 !important;width:1px !important;height:1px !important;top:0 !important;left:0 !important;border:none !important;display:block !important;z-index:-1 !important;}</style><div class="intercom-app" aria-live="polite"><div id="intercom-modal-container"></div></div></div></body></html>