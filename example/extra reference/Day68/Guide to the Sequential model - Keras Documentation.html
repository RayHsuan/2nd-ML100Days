<!DOCTYPE html>
<!-- saved from url=(0056)https://keras.io/getting-started/sequential-model-guide/ -->
<html class=" js flexbox flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths" lang="en"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="canonical" href="http://keras.io/getting-started/sequential-model-guide/">
  <link rel="shortcut icon" href="https://keras.io/img/favicon.ico">
  <title>Guide to the Sequential model - Keras Documentation</title>
  <link href="./Guide to the Sequential model - Keras Documentation_files/css" rel="stylesheet" type="text/css">

  <link rel="stylesheet" href="./Guide to the Sequential model - Keras Documentation_files/theme.css" type="text/css">
  <link rel="stylesheet" href="./Guide to the Sequential model - Keras Documentation_files/theme_extra.css" type="text/css">
  <link rel="stylesheet" href="./Guide to the Sequential model - Keras Documentation_files/github.min.css">
  
  <script async="" src="./Guide to the Sequential model - Keras Documentation_files/analytics.js.下載"></script><script>
    // Current page data
    var mkdocs_page_name = "Guide to the Sequential model";
    var mkdocs_page_input_path = "getting-started/sequential-model-guide.md";
    var mkdocs_page_url = "/getting-started/sequential-model-guide/";
  </script>
  
  <script src="./Guide to the Sequential model - Keras Documentation_files/jquery-2.1.1.min.js.下載" defer=""></script>
  <script src="./Guide to the Sequential model - Keras Documentation_files/modernizr-2.8.3.min.js.下載" defer=""></script>
  <script src="./Guide to the Sequential model - Keras Documentation_files/highlight.min.js.下載"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-61785484-1', 'keras.io');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <a href="https://keras.io/getting-started/sequential-model-guide/">
        <div class="keras-logo">
          <img src="./Guide to the Sequential model - Keras Documentation_files/keras-logo-small.jpg" class="keras-logo-img">
          Keras Documentation
        </div>
      </a>

      <div class="wy-side-nav-search">
        <div role="search">
  <form id="rtd-search-form" class="wy-form" action="https://keras.io/search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here">
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/">Home</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/why-use-keras/">Why use Keras</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Getting started</span></p>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="https://keras.io/getting-started/sequential-model-guide/"><span class="toctree-expand"></span>Guide to the Sequential model</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="https://keras.io/getting-started/sequential-model-guide/#specifying-the-input-shape">Specifying the input shape</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="https://keras.io/getting-started/sequential-model-guide/#compilation">Compilation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="https://keras.io/getting-started/sequential-model-guide/#training">Training</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="https://keras.io/getting-started/sequential-model-guide/#examples"><span class="toctree-expand"></span>Examples</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="https://keras.io/getting-started/sequential-model-guide/#multilayer-perceptron-mlp-for-multi-class-softmax-classification">Multilayer Perceptron (MLP) for multi-class softmax classification:</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="https://keras.io/getting-started/sequential-model-guide/#mlp-for-binary-classification">MLP for binary classification:</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="https://keras.io/getting-started/sequential-model-guide/#vgg-like-convnet">VGG-like convnet:</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="https://keras.io/getting-started/sequential-model-guide/#sequence-classification-with-lstm">Sequence classification with LSTM:</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="https://keras.io/getting-started/sequential-model-guide/#sequence-classification-with-1d-convolutions">Sequence classification with 1D convolutions:</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="https://keras.io/getting-started/sequential-model-guide/#stacked-lstm-for-sequence-classification">Stacked LSTM for sequence classification</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="https://keras.io/getting-started/sequential-model-guide/#same-stacked-lstm-model-rendered-stateful">Same stacked LSTM model, rendered "stateful"</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/getting-started/functional-api-guide/">Guide to the Functional API</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/getting-started/faq/">FAQ</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Models</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/models/about-keras-models/">About Keras models</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/models/sequential/">Sequential</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/models/model/">Model (functional API)</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Layers</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/layers/about-keras-layers/">About Keras layers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/layers/core/">Core Layers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/layers/convolutional/">Convolutional Layers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/layers/pooling/">Pooling Layers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/layers/local/">Locally-connected Layers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/layers/recurrent/">Recurrent Layers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/layers/embeddings/">Embedding Layers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/layers/merge/">Merge Layers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/layers/advanced-activations/">Advanced Activations Layers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/layers/normalization/">Normalization Layers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/layers/noise/">Noise layers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/layers/wrappers/">Layer wrappers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/layers/writing-your-own-keras-layers/">Writing your own Keras layers</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Preprocessing</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/preprocessing/sequence/">Sequence Preprocessing</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/preprocessing/text/">Text Preprocessing</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/preprocessing/image/">Image Preprocessing</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/losses/">Losses</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/metrics/">Metrics</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/optimizers/">Optimizers</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/activations/">Activations</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/callbacks/">Callbacks</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/datasets/">Datasets</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/applications/">Applications</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/backend/">Backend</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/initializers/">Initializers</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/regularizers/">Regularizers</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/constraints/">Constraints</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/visualization/">Visualization</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/scikit-learn-api/">Scikit-learn API</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/utils/">Utils</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/contributing/">Contributing</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Examples</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/examples/addition_rnn/">Addition RNN</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/examples/babi_rnn/">Baby RNN</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/examples/babi_memnn/">Baby MemNN</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/examples/cifar10_cnn/">CIFAR-10 CNN</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/examples/cifar10_cnn_capsule/">CIFAR-10 CNN-Capsule</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/examples/cifar10_cnn_tfaugment2d/">CIFAR-10 CNN with augmentation (TF)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/examples/cifar10_resnet/">CIFAR-10 ResNet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="https://keras.io/examples/conv_filter_visualization/">Convolution filter visualization</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="https://keras.io/">Keras Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="https://keras.io/">Docs</a> »</li>
    
      
        
          <li>Getting started »</li>
        
      
    
    <li>Guide to the Sequential model</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/keras-team/keras/tree/master/docs" class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="getting-started-with-the-keras-sequential-model">Getting started with the Keras Sequential model</h1>
<p>The <code>Sequential</code> model is a linear stack of layers.</p>
<p>You can create a <code>Sequential</code> model by passing a list of layer instances to the constructor:</p>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> keras.models <span class="hljs-keyword">import</span> Sequential
<span class="hljs-keyword">from</span> keras.layers <span class="hljs-keyword">import</span> Dense, Activation

model = Sequential([
    Dense(<span class="hljs-number">32</span>, input_shape=(<span class="hljs-number">784</span>,)),
    Activation(<span class="hljs-string">'relu'</span>),
    Dense(<span class="hljs-number">10</span>),
    Activation(<span class="hljs-string">'softmax'</span>),
])
</code></pre>

<p>You can also simply add layers via the <code>.add()</code> method:</p>
<pre><code class="python hljs">model = Sequential()
model.add(Dense(<span class="hljs-number">32</span>, input_dim=<span class="hljs-number">784</span>))
model.add(Activation(<span class="hljs-string">'relu'</span>))
</code></pre>

<hr>
<h2 id="specifying-the-input-shape">Specifying the input shape</h2>
<p>The model needs to know what input shape it should expect. For this reason, the first layer in a <code>Sequential</code> model (and only the first, because following layers can do automatic shape inference) needs to receive information about its input shape. There are several possible ways to do this:</p>
<ul>
<li>Pass an <code>input_shape</code> argument to the first layer. This is a shape tuple (a tuple of integers or <code>None</code> entries, where <code>None</code> indicates that any positive integer may be expected). In <code>input_shape</code>, the batch dimension is not included.</li>
<li>Some 2D layers, such as <code>Dense</code>, support the specification of their input shape via the argument <code>input_dim</code>, and some 3D temporal layers support the arguments <code>input_dim</code> and <code>input_length</code>.</li>
<li>If you ever need to specify a fixed batch size for your inputs (this is useful for stateful recurrent networks), you can pass a <code>batch_size</code> argument to a layer. If you pass both <code>batch_size=32</code> and <code>input_shape=(6, 8)</code> to a layer, it will then expect every batch of inputs to have the batch shape <code>(32, 6, 8)</code>.</li>
</ul>
<p>As such, the following snippets are strictly equivalent:</p>
<pre><code class="python hljs">model = Sequential()
model.add(Dense(<span class="hljs-number">32</span>, input_shape=(<span class="hljs-number">784</span>,)))
</code></pre>

<pre><code class="python hljs">model = Sequential()
model.add(Dense(<span class="hljs-number">32</span>, input_dim=<span class="hljs-number">784</span>))
</code></pre>

<hr>
<h2 id="compilation">Compilation</h2>
<p>Before training a model, you need to configure the learning process, which is done via the <code>compile</code> method. It receives three arguments:</p>
<ul>
<li>An optimizer. This could be the string identifier of an existing optimizer (such as <code>rmsprop</code> or <code>adagrad</code>), or an instance of the <code>Optimizer</code> class. See: <a href="https://keras.io/optimizers">optimizers</a>.</li>
<li>A loss function. This is the objective that the model will try to minimize. It can be the string identifier of an existing loss function (such as <code>categorical_crossentropy</code> or <code>mse</code>), or it can be an objective function. See: <a href="https://keras.io/losses">losses</a>.</li>
<li>A list of metrics. For any classification problem you will want to set this to <code>metrics=['accuracy']</code>. A metric could be the string identifier of an existing metric or a custom metric function.</li>
</ul>
<pre><code class="python hljs"><span class="hljs-comment"># For a multi-class classification problem</span>
model.compile(optimizer=<span class="hljs-string">'rmsprop'</span>,
              loss=<span class="hljs-string">'categorical_crossentropy'</span>,
              metrics=[<span class="hljs-string">'accuracy'</span>])

<span class="hljs-comment"># For a binary classification problem</span>
model.compile(optimizer=<span class="hljs-string">'rmsprop'</span>,
              loss=<span class="hljs-string">'binary_crossentropy'</span>,
              metrics=[<span class="hljs-string">'accuracy'</span>])

<span class="hljs-comment"># For a mean squared error regression problem</span>
model.compile(optimizer=<span class="hljs-string">'rmsprop'</span>,
              loss=<span class="hljs-string">'mse'</span>)

<span class="hljs-comment"># For custom metrics</span>
<span class="hljs-keyword">import</span> keras.backend <span class="hljs-keyword">as</span> K

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">mean_pred</span><span class="hljs-params">(y_true, y_pred)</span>:</span>
    <span class="hljs-keyword">return</span> K.mean(y_pred)

model.compile(optimizer=<span class="hljs-string">'rmsprop'</span>,
              loss=<span class="hljs-string">'binary_crossentropy'</span>,
              metrics=[<span class="hljs-string">'accuracy'</span>, mean_pred])
</code></pre>

<hr>
<h2 id="training">Training</h2>
<p>Keras models are trained on Numpy arrays of input data and labels. For training a model, you will typically use the <code>fit</code> function. <a href="https://keras.io/models/sequential">Read its documentation here</a>.</p>
<pre><code class="python hljs"><span class="hljs-comment"># For a single-input model with 2 classes (binary classification):</span>

model = Sequential()
model.add(Dense(<span class="hljs-number">32</span>, activation=<span class="hljs-string">'relu'</span>, input_dim=<span class="hljs-number">100</span>))
model.add(Dense(<span class="hljs-number">1</span>, activation=<span class="hljs-string">'sigmoid'</span>))
model.compile(optimizer=<span class="hljs-string">'rmsprop'</span>,
              loss=<span class="hljs-string">'binary_crossentropy'</span>,
              metrics=[<span class="hljs-string">'accuracy'</span>])

<span class="hljs-comment"># Generate dummy data</span>
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
data = np.random.random((<span class="hljs-number">1000</span>, <span class="hljs-number">100</span>))
labels = np.random.randint(<span class="hljs-number">2</span>, size=(<span class="hljs-number">1000</span>, <span class="hljs-number">1</span>))

<span class="hljs-comment"># Train the model, iterating on the data in batches of 32 samples</span>
model.fit(data, labels, epochs=<span class="hljs-number">10</span>, batch_size=<span class="hljs-number">32</span>)
</code></pre>

<pre><code class="python hljs"><span class="hljs-comment"># For a single-input model with 10 classes (categorical classification):</span>

model = Sequential()
model.add(Dense(<span class="hljs-number">32</span>, activation=<span class="hljs-string">'relu'</span>, input_dim=<span class="hljs-number">100</span>))
model.add(Dense(<span class="hljs-number">10</span>, activation=<span class="hljs-string">'softmax'</span>))
model.compile(optimizer=<span class="hljs-string">'rmsprop'</span>,
              loss=<span class="hljs-string">'categorical_crossentropy'</span>,
              metrics=[<span class="hljs-string">'accuracy'</span>])

<span class="hljs-comment"># Generate dummy data</span>
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
data = np.random.random((<span class="hljs-number">1000</span>, <span class="hljs-number">100</span>))
labels = np.random.randint(<span class="hljs-number">10</span>, size=(<span class="hljs-number">1000</span>, <span class="hljs-number">1</span>))

<span class="hljs-comment"># Convert labels to categorical one-hot encoding</span>
one_hot_labels = keras.utils.to_categorical(labels, num_classes=<span class="hljs-number">10</span>)

<span class="hljs-comment"># Train the model, iterating on the data in batches of 32 samples</span>
model.fit(data, one_hot_labels, epochs=<span class="hljs-number">10</span>, batch_size=<span class="hljs-number">32</span>)
</code></pre>

<hr>
<h2 id="examples">Examples</h2>
<p>Here are a few examples to get you started!</p>
<p>In the <a href="https://github.com/keras-team/keras/tree/master/examples">examples folder</a>, you will also find example models for real datasets:</p>
<ul>
<li>CIFAR10 small images classification: Convolutional Neural Network (CNN) with realtime data augmentation</li>
<li>IMDB movie review sentiment classification: LSTM over sequences of words</li>
<li>Reuters newswires topic classification: Multilayer Perceptron (MLP)</li>
<li>MNIST handwritten digits classification: MLP &amp; CNN</li>
<li>Character-level text generation with LSTM</li>
</ul>
<p>...and more.</p>
<h3 id="multilayer-perceptron-mlp-for-multi-class-softmax-classification">Multilayer Perceptron (MLP) for multi-class softmax classification:</h3>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> keras
<span class="hljs-keyword">from</span> keras.models <span class="hljs-keyword">import</span> Sequential
<span class="hljs-keyword">from</span> keras.layers <span class="hljs-keyword">import</span> Dense, Dropout, Activation
<span class="hljs-keyword">from</span> keras.optimizers <span class="hljs-keyword">import</span> SGD

<span class="hljs-comment"># Generate dummy data</span>
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
x_train = np.random.random((<span class="hljs-number">1000</span>, <span class="hljs-number">20</span>))
y_train = keras.utils.to_categorical(np.random.randint(<span class="hljs-number">10</span>, size=(<span class="hljs-number">1000</span>, <span class="hljs-number">1</span>)), num_classes=<span class="hljs-number">10</span>)
x_test = np.random.random((<span class="hljs-number">100</span>, <span class="hljs-number">20</span>))
y_test = keras.utils.to_categorical(np.random.randint(<span class="hljs-number">10</span>, size=(<span class="hljs-number">100</span>, <span class="hljs-number">1</span>)), num_classes=<span class="hljs-number">10</span>)

model = Sequential()
<span class="hljs-comment"># Dense(64) is a fully-connected layer with 64 hidden units.</span>
<span class="hljs-comment"># in the first layer, you must specify the expected input data shape:</span>
<span class="hljs-comment"># here, 20-dimensional vectors.</span>
model.add(Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">'relu'</span>, input_dim=<span class="hljs-number">20</span>))
model.add(Dropout(<span class="hljs-number">0.5</span>))
model.add(Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">'relu'</span>))
model.add(Dropout(<span class="hljs-number">0.5</span>))
model.add(Dense(<span class="hljs-number">10</span>, activation=<span class="hljs-string">'softmax'</span>))

sgd = SGD(lr=<span class="hljs-number">0.01</span>, decay=<span class="hljs-number">1e-6</span>, momentum=<span class="hljs-number">0.9</span>, nesterov=<span class="hljs-keyword">True</span>)
model.compile(loss=<span class="hljs-string">'categorical_crossentropy'</span>,
              optimizer=sgd,
              metrics=[<span class="hljs-string">'accuracy'</span>])

model.fit(x_train, y_train,
          epochs=<span class="hljs-number">20</span>,
          batch_size=<span class="hljs-number">128</span>)
score = model.evaluate(x_test, y_test, batch_size=<span class="hljs-number">128</span>)
</code></pre>

<h3 id="mlp-for-binary-classification">MLP for binary classification:</h3>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> keras.models <span class="hljs-keyword">import</span> Sequential
<span class="hljs-keyword">from</span> keras.layers <span class="hljs-keyword">import</span> Dense, Dropout

<span class="hljs-comment"># Generate dummy data</span>
x_train = np.random.random((<span class="hljs-number">1000</span>, <span class="hljs-number">20</span>))
y_train = np.random.randint(<span class="hljs-number">2</span>, size=(<span class="hljs-number">1000</span>, <span class="hljs-number">1</span>))
x_test = np.random.random((<span class="hljs-number">100</span>, <span class="hljs-number">20</span>))
y_test = np.random.randint(<span class="hljs-number">2</span>, size=(<span class="hljs-number">100</span>, <span class="hljs-number">1</span>))

model = Sequential()
model.add(Dense(<span class="hljs-number">64</span>, input_dim=<span class="hljs-number">20</span>, activation=<span class="hljs-string">'relu'</span>))
model.add(Dropout(<span class="hljs-number">0.5</span>))
model.add(Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">'relu'</span>))
model.add(Dropout(<span class="hljs-number">0.5</span>))
model.add(Dense(<span class="hljs-number">1</span>, activation=<span class="hljs-string">'sigmoid'</span>))

model.compile(loss=<span class="hljs-string">'binary_crossentropy'</span>,
              optimizer=<span class="hljs-string">'rmsprop'</span>,
              metrics=[<span class="hljs-string">'accuracy'</span>])

model.fit(x_train, y_train,
          epochs=<span class="hljs-number">20</span>,
          batch_size=<span class="hljs-number">128</span>)
score = model.evaluate(x_test, y_test, batch_size=<span class="hljs-number">128</span>)
</code></pre>

<h3 id="vgg-like-convnet">VGG-like convnet:</h3>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> keras
<span class="hljs-keyword">from</span> keras.models <span class="hljs-keyword">import</span> Sequential
<span class="hljs-keyword">from</span> keras.layers <span class="hljs-keyword">import</span> Dense, Dropout, Flatten
<span class="hljs-keyword">from</span> keras.layers <span class="hljs-keyword">import</span> Conv2D, MaxPooling2D
<span class="hljs-keyword">from</span> keras.optimizers <span class="hljs-keyword">import</span> SGD

<span class="hljs-comment"># Generate dummy data</span>
x_train = np.random.random((<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">3</span>))
y_train = keras.utils.to_categorical(np.random.randint(<span class="hljs-number">10</span>, size=(<span class="hljs-number">100</span>, <span class="hljs-number">1</span>)), num_classes=<span class="hljs-number">10</span>)
x_test = np.random.random((<span class="hljs-number">20</span>, <span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">3</span>))
y_test = keras.utils.to_categorical(np.random.randint(<span class="hljs-number">10</span>, size=(<span class="hljs-number">20</span>, <span class="hljs-number">1</span>)), num_classes=<span class="hljs-number">10</span>)

model = Sequential()
<span class="hljs-comment"># input: 100x100 images with 3 channels -&gt; (100, 100, 3) tensors.</span>
<span class="hljs-comment"># this applies 32 convolution filters of size 3x3 each.</span>
model.add(Conv2D(<span class="hljs-number">32</span>, (<span class="hljs-number">3</span>, <span class="hljs-number">3</span>), activation=<span class="hljs-string">'relu'</span>, input_shape=(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">3</span>)))
model.add(Conv2D(<span class="hljs-number">32</span>, (<span class="hljs-number">3</span>, <span class="hljs-number">3</span>), activation=<span class="hljs-string">'relu'</span>))
model.add(MaxPooling2D(pool_size=(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>)))
model.add(Dropout(<span class="hljs-number">0.25</span>))

model.add(Conv2D(<span class="hljs-number">64</span>, (<span class="hljs-number">3</span>, <span class="hljs-number">3</span>), activation=<span class="hljs-string">'relu'</span>))
model.add(Conv2D(<span class="hljs-number">64</span>, (<span class="hljs-number">3</span>, <span class="hljs-number">3</span>), activation=<span class="hljs-string">'relu'</span>))
model.add(MaxPooling2D(pool_size=(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>)))
model.add(Dropout(<span class="hljs-number">0.25</span>))

model.add(Flatten())
model.add(Dense(<span class="hljs-number">256</span>, activation=<span class="hljs-string">'relu'</span>))
model.add(Dropout(<span class="hljs-number">0.5</span>))
model.add(Dense(<span class="hljs-number">10</span>, activation=<span class="hljs-string">'softmax'</span>))

sgd = SGD(lr=<span class="hljs-number">0.01</span>, decay=<span class="hljs-number">1e-6</span>, momentum=<span class="hljs-number">0.9</span>, nesterov=<span class="hljs-keyword">True</span>)
model.compile(loss=<span class="hljs-string">'categorical_crossentropy'</span>, optimizer=sgd)

model.fit(x_train, y_train, batch_size=<span class="hljs-number">32</span>, epochs=<span class="hljs-number">10</span>)
score = model.evaluate(x_test, y_test, batch_size=<span class="hljs-number">32</span>)
</code></pre>

<h3 id="sequence-classification-with-lstm">Sequence classification with LSTM:</h3>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> keras.models <span class="hljs-keyword">import</span> Sequential
<span class="hljs-keyword">from</span> keras.layers <span class="hljs-keyword">import</span> Dense, Dropout
<span class="hljs-keyword">from</span> keras.layers <span class="hljs-keyword">import</span> Embedding
<span class="hljs-keyword">from</span> keras.layers <span class="hljs-keyword">import</span> LSTM

max_features = <span class="hljs-number">1024</span>

model = Sequential()
model.add(Embedding(max_features, output_dim=<span class="hljs-number">256</span>))
model.add(LSTM(<span class="hljs-number">128</span>))
model.add(Dropout(<span class="hljs-number">0.5</span>))
model.add(Dense(<span class="hljs-number">1</span>, activation=<span class="hljs-string">'sigmoid'</span>))

model.compile(loss=<span class="hljs-string">'binary_crossentropy'</span>,
              optimizer=<span class="hljs-string">'rmsprop'</span>,
              metrics=[<span class="hljs-string">'accuracy'</span>])

model.fit(x_train, y_train, batch_size=<span class="hljs-number">16</span>, epochs=<span class="hljs-number">10</span>)
score = model.evaluate(x_test, y_test, batch_size=<span class="hljs-number">16</span>)
</code></pre>

<h3 id="sequence-classification-with-1d-convolutions">Sequence classification with 1D convolutions:</h3>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> keras.models <span class="hljs-keyword">import</span> Sequential
<span class="hljs-keyword">from</span> keras.layers <span class="hljs-keyword">import</span> Dense, Dropout
<span class="hljs-keyword">from</span> keras.layers <span class="hljs-keyword">import</span> Embedding
<span class="hljs-keyword">from</span> keras.layers <span class="hljs-keyword">import</span> Conv1D, GlobalAveragePooling1D, MaxPooling1D

seq_length = <span class="hljs-number">64</span>

model = Sequential()
model.add(Conv1D(<span class="hljs-number">64</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>, input_shape=(seq_length, <span class="hljs-number">100</span>)))
model.add(Conv1D(<span class="hljs-number">64</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>))
model.add(MaxPooling1D(<span class="hljs-number">3</span>))
model.add(Conv1D(<span class="hljs-number">128</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>))
model.add(Conv1D(<span class="hljs-number">128</span>, <span class="hljs-number">3</span>, activation=<span class="hljs-string">'relu'</span>))
model.add(GlobalAveragePooling1D())
model.add(Dropout(<span class="hljs-number">0.5</span>))
model.add(Dense(<span class="hljs-number">1</span>, activation=<span class="hljs-string">'sigmoid'</span>))

model.compile(loss=<span class="hljs-string">'binary_crossentropy'</span>,
              optimizer=<span class="hljs-string">'rmsprop'</span>,
              metrics=[<span class="hljs-string">'accuracy'</span>])

model.fit(x_train, y_train, batch_size=<span class="hljs-number">16</span>, epochs=<span class="hljs-number">10</span>)
score = model.evaluate(x_test, y_test, batch_size=<span class="hljs-number">16</span>)
</code></pre>

<h3 id="stacked-lstm-for-sequence-classification">Stacked LSTM for sequence classification</h3>
<p>In this model, we stack 3 LSTM layers on top of each other,
making the model capable of learning higher-level temporal representations.</p>
<p>The first two LSTMs return their full output sequences, but the last one only returns
the last step in its output sequence, thus dropping the temporal dimension
(i.e. converting the input sequence into a single vector).</p>
<p><img src="./Guide to the Sequential model - Keras Documentation_files/regular_stacked_lstm.png" alt="stacked LSTM" style="width: 300px;"></p>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> keras.models <span class="hljs-keyword">import</span> Sequential
<span class="hljs-keyword">from</span> keras.layers <span class="hljs-keyword">import</span> LSTM, Dense
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

data_dim = <span class="hljs-number">16</span>
timesteps = <span class="hljs-number">8</span>
num_classes = <span class="hljs-number">10</span>

<span class="hljs-comment"># expected input data shape: (batch_size, timesteps, data_dim)</span>
model = Sequential()
model.add(LSTM(<span class="hljs-number">32</span>, return_sequences=<span class="hljs-keyword">True</span>,
               input_shape=(timesteps, data_dim)))  <span class="hljs-comment"># returns a sequence of vectors of dimension 32</span>
model.add(LSTM(<span class="hljs-number">32</span>, return_sequences=<span class="hljs-keyword">True</span>))  <span class="hljs-comment"># returns a sequence of vectors of dimension 32</span>
model.add(LSTM(<span class="hljs-number">32</span>))  <span class="hljs-comment"># return a single vector of dimension 32</span>
model.add(Dense(<span class="hljs-number">10</span>, activation=<span class="hljs-string">'softmax'</span>))

model.compile(loss=<span class="hljs-string">'categorical_crossentropy'</span>,
              optimizer=<span class="hljs-string">'rmsprop'</span>,
              metrics=[<span class="hljs-string">'accuracy'</span>])

<span class="hljs-comment"># Generate dummy training data</span>
x_train = np.random.random((<span class="hljs-number">1000</span>, timesteps, data_dim))
y_train = np.random.random((<span class="hljs-number">1000</span>, num_classes))

<span class="hljs-comment"># Generate dummy validation data</span>
x_val = np.random.random((<span class="hljs-number">100</span>, timesteps, data_dim))
y_val = np.random.random((<span class="hljs-number">100</span>, num_classes))

model.fit(x_train, y_train,
          batch_size=<span class="hljs-number">64</span>, epochs=<span class="hljs-number">5</span>,
          validation_data=(x_val, y_val))
</code></pre>

<h3 id="same-stacked-lstm-model-rendered-stateful">Same stacked LSTM model, rendered "stateful"</h3>
<p>A stateful recurrent model is one for which the internal states (memories) obtained after processing a batch
of samples are reused as initial states for the samples of the next batch. This allows to process longer sequences
while keeping computational complexity manageable.</p>
<p><a href="https://keras.io/getting-started/faq/#how-can-i-use-stateful-rnns">You can read more about stateful RNNs in the FAQ.</a></p>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> keras.models <span class="hljs-keyword">import</span> Sequential
<span class="hljs-keyword">from</span> keras.layers <span class="hljs-keyword">import</span> LSTM, Dense
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

data_dim = <span class="hljs-number">16</span>
timesteps = <span class="hljs-number">8</span>
num_classes = <span class="hljs-number">10</span>
batch_size = <span class="hljs-number">32</span>

<span class="hljs-comment"># Expected input batch shape: (batch_size, timesteps, data_dim)</span>
<span class="hljs-comment"># Note that we have to provide the full batch_input_shape since the network is stateful.</span>
<span class="hljs-comment"># the sample of index i in batch k is the follow-up for the sample i in batch k-1.</span>
model = Sequential()
model.add(LSTM(<span class="hljs-number">32</span>, return_sequences=<span class="hljs-keyword">True</span>, stateful=<span class="hljs-keyword">True</span>,
               batch_input_shape=(batch_size, timesteps, data_dim)))
model.add(LSTM(<span class="hljs-number">32</span>, return_sequences=<span class="hljs-keyword">True</span>, stateful=<span class="hljs-keyword">True</span>))
model.add(LSTM(<span class="hljs-number">32</span>, stateful=<span class="hljs-keyword">True</span>))
model.add(Dense(<span class="hljs-number">10</span>, activation=<span class="hljs-string">'softmax'</span>))

model.compile(loss=<span class="hljs-string">'categorical_crossentropy'</span>,
              optimizer=<span class="hljs-string">'rmsprop'</span>,
              metrics=[<span class="hljs-string">'accuracy'</span>])

<span class="hljs-comment"># Generate dummy training data</span>
x_train = np.random.random((batch_size * <span class="hljs-number">10</span>, timesteps, data_dim))
y_train = np.random.random((batch_size * <span class="hljs-number">10</span>, num_classes))

<span class="hljs-comment"># Generate dummy validation data</span>
x_val = np.random.random((batch_size * <span class="hljs-number">3</span>, timesteps, data_dim))
y_val = np.random.random((batch_size * <span class="hljs-number">3</span>, num_classes))

model.fit(x_train, y_train,
          batch_size=batch_size, epochs=<span class="hljs-number">5</span>, shuffle=<span class="hljs-keyword">False</span>,
          validation_data=(x_val, y_val))
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="https://keras.io/getting-started/functional-api-guide/" class="btn btn-neutral float-right" title="Guide to the Functional API">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="https://keras.io/why-use-keras/" class="btn btn-neutral" title="Why use Keras"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org/">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="http://github.com/keras-team/keras/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="https://keras.io/why-use-keras/" style="color: #fcfcfc;">« Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="https://keras.io/getting-started/functional-api-guide/" style="color: #fcfcfc">Next »</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="./Guide to the Sequential model - Keras Documentation_files/theme.js.下載" defer=""></script>
      <script src="./Guide to the Sequential model - Keras Documentation_files/main.js.下載" defer=""></script>
    <script type="text/javascript" defer="">
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>



</body></html>