webpackJsonp([78],{824:function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function l(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function r(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0});var c=n(1),a=n.n(c),s=n(32),u=n(48),f=n(54),p=n(5),d=n(26),m=n(119),h=n(8),y=n(34),b=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),g=r(["\n    0% {\n        opacity: 0;\n        transform: translateX(-50%) translateY(100%) translateZ(0);\n    }\n\n    100% {\n        opacity: 1;\n        transform: translateX(-50%) translateZ(0);\n    }\n"],["\n    0% {\n        opacity: 0;\n        transform: translateX(-50%) translateY(100%) translateZ(0);\n    }\n\n    100% {\n        opacity: 1;\n        transform: translateX(-50%) translateZ(0);\n    }\n"]),x=r(["\n    0% {\n        opacity: 1;\n    }\n\n    100% {\n        opacity: 0;\n    }\n"],["\n    0% {\n        opacity: 1;\n    }\n\n    100% {\n        opacity: 0;\n    }\n"]),w=r(["\n    width: 100%;\n    height: 100%;\n    padding: 0 32px;\n    color: #FFF;\n    font-size: 14;\n    display: flex;\n    align-items: center;\n    i {\n        margin: 0 20px 0 0;\n        font-size: 22px;\n    }\n"],["\n    width: 100%;\n    height: 100%;\n    padding: 0 32px;\n    color: #FFF;\n    font-size: 14;\n    display: flex;\n    align-items: center;\n    i {\n        margin: 0 20px 0 0;\n        font-size: 22px;\n    }\n"]),v=r(["\n    position: fixed;\n    left: 50%;\n    bottom: 20px;\n    background-color: ",";\n    "," {\n        padding: ",";\n    }\n    width: 480px;\n    height: 60px;\n    z-index: 2100;\n    display: flex;\n    border-radius: 3px;\n    box-shadow: 0px 2px 10px 0px rgba(0,0,0,0.20);\n    transform: translateX(-50%) translateZ(0);\n    animation: "," 0.1s linear;\n"],["\n    position: fixed;\n    left: 50%;\n    bottom: 20px;\n    background-color: ",";\n    "," {\n        padding: ",";\n    }\n    width: 480px;\n    height: 60px;\n    z-index: 2100;\n    display: flex;\n    border-radius: 3px;\n    box-shadow: 0px 2px 10px 0px rgba(0,0,0,0.20);\n    transform: translateX(-50%) translateZ(0);\n    animation: "," 0.1s linear;\n"]),S=r(["\n    max-width: 260px;\n    margin-right: 4px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n"],["\n    max-width: 260px;\n    margin-right: 4px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n"]),k=r(["\n    display: inline-block;\n    margin-left: auto;\n    text-decoration: underline;\n    cursor: pointer;\n    color: #FFF;\n    &:hover {\n        text-decoration: underline;\n    }\n"],["\n    display: inline-block;\n    margin-left: auto;\n    text-decoration: underline;\n    cursor: pointer;\n    color: #FFF;\n    &:hover {\n        text-decoration: underline;\n    }\n"]),T=r(["\n    display: inline-block;\n    text-decoration: underline;\n    cursor: pointer;\n    color: #FFF;\n"],["\n    display: inline-block;\n    text-decoration: underline;\n    cursor: pointer;\n    color: #FFF;\n"]),C=r(["\n    display: inline-flex;\n    cursor: pointer;\n    margin: 0 0 0 auto;\n    width: 60px;\n    height: 60px;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    i {\n        margin: 0;\n    }\n"],["\n    display: inline-flex;\n    cursor: pointer;\n    margin: 0 0 0 auto;\n    width: 60px;\n    height: 60px;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    i {\n        margin: 0;\n    }\n"]),N=Object(p.keyframes)(g),E=Object(p.keyframes)(x),L=p.default.div(w),F=p.default.div(v,function(e){switch(e.state){case"success":return"#008675";case"error":return d.e.Error;default:return d.e.Dark}},L,function(e){switch(e.state){case"error":return"0 0 0 32px";case"success":default:return"0 32px"}},function(e){return e.isBeginClose?E:N}),A=p.default.div(S),j=p.default.a(k),M=p.default.div(T),O=p.default.div(C),_=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnterHandler=n.onMouseEnterHandler.bind(n),n.onMouseLeaveHandler=n.onMouseLeaveHandler.bind(n),n.collectItems=n.collectItems.bind(n),n.collectionItem=n.collectionItem.bind(n),n.collectInfluNewsToLib=n.collectInfluNewsToLib.bind(n),n.collectMixNewsToLib=n.collectMixNewsToLib.bind(n),n.collectLinkurlToLib=n.collectLinkurlToLib.bind(n),n.timeoutToCloseNotify=n.timeoutToCloseNotify.bind(n),n.closeCollectNofify=n.closeCollectNofify.bind(n),n.showCollectResult=n.showCollectResult.bind(n),n.retry=n.retry.bind(n),n.closeTimeout=void 0,n._isMount=!0,n.state={collectState:"loading",isBeginClose:!1},n}return l(t,e),b(t,[{key:"componentDidMount",value:function(){this.collectItems()}},{key:"componentWillUnmount",value:function(){this._isMount=!1}},{key:"onMouseEnterHandler",value:function(){this.closeTimeout&&clearTimeout(this.closeTimeout)}},{key:"onMouseLeaveHandler",value:function(){this.state.isBeginClose||"success"!==this.state.collectState||(this.closeTimeout&&clearTimeout(this.closeTimeout),this.timeoutToCloseNotify())}},{key:"retry",value:function(){this.setState({collectState:"loading"},this.collectItems)}},{key:"showCollectResult",value:function(){this.props.webActions.cupoyStateGo(y.a.STATES.NEWSFEED_LIBRARY_ALL),this.closeCollectNofify()}},{key:"collectItems",value:function(){var e=this.props.collectItems;if(0===e.length)return void this.closeCollectNofify();1===e.length&&this.collectionItem(e[0])}},{key:"collectionItem",value:function(e){switch(e.matrix){case 3:this.collectInfluNewsToLib([e]);break;case 6:this.collectMixNewsToLib([e]);break;case 5:this.setState({collectState:"error"});break;default:e.linkurl?this.collectLinkurlToLib([e]):this.setState({collectState:"error"})}}},{key:"collectInfluNewsToLib",value:function(e){var t=this,n=new FormData;for(var o in e)e[o].itemid&&n.append("itemids[]",e[o].itemid);h.a.fetchWithCookies("/InfluencerAction.do?op=collectToLibrary",{method:"POST",body:n}).then(function(n){n.json().then(function(n){if(n&&!n.error){t.setState({collectState:"success"});for(var o=[],i=0;i<e.length;i++){var l=n[e[i].itemid];l&&o.push(l)}t.props.libraryActions.collectNewsSuccess(o),t.timeoutToCloseNotify()}else t.setState({collectState:"error"})}).catch(function(e){console.log(e),t.setState({collectState:"error"})})}).catch(function(e){console.log(e),t.setState({collectState:"error"})})}},{key:"collectMixNewsToLib",value:function(e){var t=this,n=new FormData;for(var o in e)e[o].itemuid&&n.append("itemids[]",e[o].itemuid);h.a.fetchWithCookies("/MixNewsAction.do?op=collectToLibrary",{method:"POST",body:n}).then(function(n){n.json().then(function(n){if(n&&!n.error){t.setState({collectState:"success"});for(var o=[],i=0;i<e.length;i++){var l=n[e[i].itemuid];l&&o.push(l)}t.props.libraryActions.collectNewsSuccess(o),t.timeoutToCloseNotify();for(var r=0;r<e.length;r++)t.props.gaActions.collectNewsItem(e[r])}else t.setState({collectState:"error"})}).catch(function(e){console.log(e),t.setState({collectState:"error"})})}).catch(function(e){console.log(e),t.setState({collectState:"error"})})}},{key:"collectLinkurlToLib",value:function(e){var t=this,n=new FormData,o=[];for(var i in e)e[i].linkurl&&(o.push(e[i].linkurl),n.append("urls[]",e[i].linkurl),n.append("titles[]",e[i].title),n.append("descriptions[]",e[i].txtcontent),n.append("usrdefimgurls[]",e[i].thumbnailurl),n.append("usrtags[]",""),n.append("withCBodyHtmls[]",!0),n.append("ctypes[]",5),n.append("annotations[]",""));0!==o.length&&h.a.fetchWithCookies("/URLUploadAction.do",{method:"POST",body:n}).then(function(e){e.json().then(function(e){e&&!e.error?(t.setState({collectState:"success"}),t.props.libraryActions.collectNewsSuccess(e),t.timeoutToCloseNotify()):t.setState({collectState:"error"})}).catch(function(e){console.log(e),t.setState({collectState:"error"})})}).catch(function(e){console.log(e),t.setState({collectState:"error"})})}},{key:"timeoutToCloseNotify",value:function(){var e=this;this.closeTimeout&&clearTimeout(this.closeTimeout),this.closeTimeout=setTimeout(function(){e._isMount&&e.closeCollectNofify()},3e3)}},{key:"closeCollectNofify",value:function(){var e=this;this.closeTimeout&&clearTimeout(this.closeTimeout),this.setState({isBeginClose:!0},function(){setTimeout(function(){e._isMount&&e.props.webActions.closeCollectNewsNofify()},50)})}},{key:"render",value:function(){var e=this.props.collectItems;return a.a.createElement(F,{state:this.state.collectState,isBeginClose:this.state.isBeginClose,onMouseEnter:this.onMouseEnterHandler,onMouseLeave:this.onMouseLeaveHandler},"loading"===this.state.collectState?a.a.createElement(L,null,a.a.createElement(d.i.Spin,{color:"#FFF",margin:"0 24px 0 0"}),a.a.createElement(m.a,{"translate-key":"component_collecting"},"\u6b63\u5728\u6536\u85cf"),"\u300c",1===e.length?a.a.createElement(A,null,e[0].title):a.a.createElement(A,null,e.length,"\u500b"),"\u300d"):null,"success"===this.state.collectState?a.a.createElement(L,null,a.a.createElement("i",{className:"zmdi-icon zmdi zmdi-check"}),a.a.createElement(m.a,{"translate-key":"component_collectedToMyLibrary"},"\u5df2\u5132\u5b58\u81f3\u6211\u7684\u6536\u85cf\u3002"),a.a.createElement(j,{onClick:this.showCollectResult},a.a.createElement(m.a,{"translate-key":"component_goToView"},"\u524d\u5f80\u67e5\u770b"))):null,"error"===this.state.collectState?a.a.createElement(L,null,a.a.createElement("i",{className:"zmdi zmdi-info"}),a.a.createElement(m.a,{"translate-key":"component_collectFailed"},"\u6536\u85cf\u5931\u6557\uff0c"),a.a.createElement(M,{onClick:this.retry},a.a.createElement(m.a,{"translate-key":"component_retry"},"\u518d\u8a66\u4e00\u6b21")),a.a.createElement(O,{onClick:this.closeCollectNofify},a.a.createElement("i",{className:"zmdi-icon zmdi zmdi-close"}))):null)}}]),t}(c.PureComponent),I=function(e){return{collectItems:e.web.collectItems}},z=function(e){return{webActions:Object(s.bindActionCreators)(f.a.webActionCreators,e),libraryActions:Object(s.bindActionCreators)(f.a.libraryActionCreators,e),mixNewsActions:Object(s.bindActionCreators)(f.a.mixNewsActionCreators,e),gaActions:Object(s.bindActionCreators)(f.a.gaActionCreators,e)}};t.default=Object(u.b)(I,z,null,{withRef:!0})(_)}});
//# sourceMappingURL=78.9ce35e36.chunk.js.map