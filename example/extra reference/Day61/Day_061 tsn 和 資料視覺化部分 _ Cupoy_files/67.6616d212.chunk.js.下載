webpackJsonp([67],{836:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function o(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function r(t,e){return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}Object.defineProperty(e,"__esModule",{value:!0});var l=n(1),s=n.n(l),c=n(32),p=n(48),d=n(54),u=n(119),g=n(26),h=n(5),m=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),f=r(["\n\theight: 500px;\n\tbackground-color: #FFF;\n\tdisplay: flex;\n\tflex-direction: column;\n"],["\n\theight: 500px;\n\tbackground-color: #FFF;\n\tdisplay: flex;\n\tflex-direction: column;\n"]),b=r(["\n\theight: 40px;\n\tpadding: 0 20px;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tbox-shadow: inset 0 -1px 0 0 #E2DFDE;\n"],["\n\theight: 40px;\n\tpadding: 0 20px;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tbox-shadow: inset 0 -1px 0 0 #E2DFDE;\n"]),x=r(["\n\tmargin: 0;\n\tfont-size: 16px;\n\tfont-weight: 600;\n"],["\n\tmargin: 0;\n\tfont-size: 16px;\n\tfont-weight: 600;\n"]),y=r(["\n\tposition: relative;\n\tflex: 2;\n\tbackground-color: ",";\n\toverflow: hidden;\n\tcursor: move;\n"],["\n\tposition: relative;\n\tflex: 2;\n\tbackground-color: ",";\n\toverflow: hidden;\n\tcursor: move;\n"]),v=r(["\n\tposition: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    border-style: solid;\n    border-color: rgba(255,255,255,0.7);\n    pointer-events: none;\n    z-index: 2;\n"],["\n\tposition: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    border-style: solid;\n    border-color: rgba(255,255,255,0.7);\n    pointer-events: none;\n    z-index: 2;\n"]),k=r(["\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\tz-index: 1;\n\tpointer-events: none;\n\ttransform-origin: top left;\n"],["\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\tz-index: 1;\n\tpointer-events: none;\n\ttransform-origin: top left;\n"]),w=r(["\n\tposition: absolute;\n\ttop: 10px;\n\tleft: 50%;\n\ttransform: translateX(-50%);\n\tbackground-color: rgba(0,0,0,0.7);\n\theight: 30px;\n\tpadding: 0 20px;\n\tcolor: #FFF;\n\tborder: 1px solid #FFF;\n\tborder-radius: 3px;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tz-index: 3;\n\tpointer-events: none;\n"],["\n\tposition: absolute;\n\ttop: 10px;\n\tleft: 50%;\n\ttransform: translateX(-50%);\n\tbackground-color: rgba(0,0,0,0.7);\n\theight: 30px;\n\tpadding: 0 20px;\n\tcolor: #FFF;\n\tborder: 1px solid #FFF;\n\tborder-radius: 3px;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tz-index: 3;\n\tpointer-events: none;\n"]),S=r(["\n\tmargin: 0 4px;\n"],["\n\tmargin: 0 4px;\n"]),E=r(["\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\tright: 0;\n\tbackground-color: rgba(0,0,0,0.7);\n\theight: 30px;\n\tpadding: 0 20px;\n\tcolor: #FFF;\n\tborder-radius: 3px;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tz-index: 3;\n\tpointer-events: none;\n"],["\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\tright: 0;\n\tbackground-color: rgba(0,0,0,0.7);\n\theight: 30px;\n\tpadding: 0 20px;\n\tcolor: #FFF;\n\tborder-radius: 3px;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tz-index: 3;\n\tpointer-events: none;\n"]),F=r(["\n\tdisplay: flex;\n\tbox-shadow: inset 0 1px 0 0 #E2DFDE;\n"],["\n\tdisplay: flex;\n\tbox-shadow: inset 0 1px 0 0 #E2DFDE;\n"]),M=r(["\n\tflex: 1;\n\tmargin: 0 10px 0 0;\n\tpadding: 0 0 0 10px;\n\theight: 50px;\n\tdisplay: inline-flex;\n\talign-items: center;\n"],["\n\tflex: 1;\n\tmargin: 0 10px 0 0;\n\tpadding: 0 0 0 10px;\n\theight: 50px;\n\tdisplay: inline-flex;\n\talign-items: center;\n"]),z=r(["\n\tflex: 3;\n\tmargin: 0 10px;\n\theight: 50px;\n\tdisplay: inline-flex;\n\talign-items: center;\n\tjustify-content: center;\n"],["\n\tflex: 3;\n\tmargin: 0 10px;\n\theight: 50px;\n\tdisplay: inline-flex;\n\talign-items: center;\n\tjustify-content: center;\n"]),W=r(["\n\tmargin: 0 10px;\n\tcolor: ",";\n\tfont-size: ",";\n"],["\n\tmargin: 0 10px;\n\tcolor: ",";\n\tfont-size: ",";\n"]),R=r(["\n\theight: 50px;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\t\n\t// IE \u7684input type=range \u8981\u7368\u7acb\u5be6\u4f5c\u6a23\u5f0f\n\tinput[type=range]::-ms-track {\n\t    // width: 300px;\n\t    height: 5px;\n\t    \n\t    /*remove bg colour from the track, we'll use ms-fill-lower and ms-fill-upper instead */\n\t    background: transparent;\n\t    \n\t    /*leave room for the larger thumb to overflow with a transparent border */\n\t    border-color: transparent;\n\t    border-width: 6px 0;\n\n\t    /*remove default tick marks*/\n\t    color: transparent;\n\t}\n\tinput[type=range]::-ms-fill-lower {\n\t    background: #777;\n\t    border-radius: 10px;\n\t}\n\tinput[type=range]::-ms-fill-upper {\n\t    background: #ddd;\n\t    border-radius: 10px;\n\t}\n\tinput[type=range]::-ms-thumb {\n\t    border: none;\n\t    height: 16px;\n\t    width: 16px;\n\t    border-radius: 50%;\n\t    background-color: #CCC;\n\t    border: 1px solid #333;\n\t}\n\tinput[type=range]:focus::-ms-fill-lower {\n\t    background: #888;\n\t}\n\tinput[type=range]:focus::-ms-fill-upper {\n\t    background: #ccc;\n\t}\n\n"],["\n\theight: 50px;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\t\n\t// IE \u7684input type=range \u8981\u7368\u7acb\u5be6\u4f5c\u6a23\u5f0f\n\tinput[type=range]::-ms-track {\n\t    // width: 300px;\n\t    height: 5px;\n\t    \n\t    /*remove bg colour from the track, we'll use ms-fill-lower and ms-fill-upper instead */\n\t    background: transparent;\n\t    \n\t    /*leave room for the larger thumb to overflow with a transparent border */\n\t    border-color: transparent;\n\t    border-width: 6px 0;\n\n\t    /*remove default tick marks*/\n\t    color: transparent;\n\t}\n\tinput[type=range]::-ms-fill-lower {\n\t    background: #777;\n\t    border-radius: 10px;\n\t}\n\tinput[type=range]::-ms-fill-upper {\n\t    background: #ddd;\n\t    border-radius: 10px;\n\t}\n\tinput[type=range]::-ms-thumb {\n\t    border: none;\n\t    height: 16px;\n\t    width: 16px;\n\t    border-radius: 50%;\n\t    background-color: #CCC;\n\t    border: 1px solid #333;\n\t}\n\tinput[type=range]:focus::-ms-fill-lower {\n\t    background: #888;\n\t}\n\tinput[type=range]:focus::-ms-fill-upper {\n\t    background: #ccc;\n\t}\n\n"]),j=r(["\n\tflex: 1;\n\tpadding: 0 20px 0 0;\n\tdisplay: inline-flex;\n\talign-items: center;\n\tjustify-content: flex-end;\n"],["\n\tflex: 1;\n\tpadding: 0 20px 0 0;\n\tdisplay: inline-flex;\n\talign-items: center;\n\tjustify-content: flex-end;\n"]),C=r(["\n\tdisplay: inline-flex;\n\tcolor: ",";\n\tcursor: pointer;\n\tpadding: 0 10px;\n\ttransition: all 300ms cubic-bezier(0.000, 0.000, 0.580, 1.000); /* ease-out */\n\ttransition-timing-function: cubic-bezier(0.000, 0.000, 0.580, 1.000); /* ease-out */\n\t&:hover {\n\t\tcolor: ",";\n\t}\n"],["\n\tdisplay: inline-flex;\n\tcolor: ",";\n\tcursor: pointer;\n\tpadding: 0 10px;\n\ttransition: all 300ms cubic-bezier(0.000, 0.000, 0.580, 1.000); /* ease-out */\n\ttransition-timing-function: cubic-bezier(0.000, 0.000, 0.580, 1.000); /* ease-out */\n\t&:hover {\n\t\tcolor: ",";\n\t}\n"]),H=r(["\n\t",";\n\tmargin: 0 0 0 10px;\n"],["\n\t",";\n\tmargin: 0 0 0 10px;\n"]),D=r(["\n\t",";\t\n"],["\n\t",";\t\n"]),L=h.default.div(f),O=h.default.div(b),T=h.default.h6(x),_=h.default.div(y,g.e.Dark5),I=h.default.div(v),N=h.default.img(k),P=h.default.div(w),X=h.default.div(S),A=h.default.div(E),U=h.default.div(S),Y=h.default.div(F),B=h.default.div(M),G=h.default.div(z),J=h.default.div(W,function(t){return t.disable?g.e.Dark3:g.e.Dark},function(t){return"large"===t.size?"24px":"16px"}),q=h.default.div(R),K=h.default.div(j),Q=h.default.div(C,g.e.Dark3,g.e.Dark),V="\n\tmargin: 0;\n\theight: 36px;\n\tline-height: 36px;\n\tpadding: 0 10px;\n",Z=g.b.Red.extend(H,V),$=g.b.Gray.extend(D,V),tt=function(t){function e(t){i(this,e);var n=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.onMouseDown=n.onMouseDown.bind(n),n.onMouseMove=n.onMouseMove.bind(n),n.onMouseUp=n.onMouseUp.bind(n),n.onScaleRangeChange=n.onScaleRangeChange.bind(n),n.onLoaded=n.onLoaded.bind(n),n.onLoadFail=n.onLoadFail.bind(n),n.skip=n.skip.bind(n),n.submit=n.submit.bind(n),n.cancel=n.cancel.bind(n),n.content=void 0,n.placementTop=0,n.placementLeft=0,n.moveStartX=0,n.moveStartY=0,n.state={aspect:t.aspect,imgsrc:t.src,imgHeight:0,imgWidth:0,contentWidth:0,contentHeight:0,cropHeight:300,cropWidth:300,cropMinScaleRange:0,cropMaxScaleRange:200,cropScaleRange:100,cropTipStyle:void 0,imgStyle:void 0},n}return o(e,t),m(e,[{key:"componentDidMount",value:function(){var t=new Image;t.onload=this.onLoaded,t.onerror=this.onLoadFail,t.src=this.state.imgsrc}},{key:"render",value:function(){var t=this,e=this.props,n=e.willSkip,i=e.optimalSize;return s.a.createElement(g.f.Content,{width:"760px",maxWidth:"760px",backgroundColor:"#fff",padding:"0",visible:!0,closable:!1},s.a.createElement(L,null,s.a.createElement(O,null,s.a.createElement(T,null,s.a.createElement(u.a,{"translate-key":"component_cropImage"},"\u88c1\u5207\u5716\u7247"),!!i&&s.a.createElement(s.a.Fragment,null,"\uff08",s.a.createElement(u.a,null,"\u6700\u4f4e\u5efa\u8b70\u5c3a\u5bf8"),"\uff1a",i,"\uff09"))),this.state.imgHeight&&this.state.imgWidth?s.a.createElement(_,{innerRef:function(e){t.content=e},onMouseDown:this.onMouseDown},s.a.createElement(I,{style:this.state.cropTipStyle}),s.a.createElement(N,{src:this.state.imgsrc,style:this.state.imgStyle}),this.state.cropScaleRange<100?s.a.createElement(P,null,s.a.createElement(X,null,s.a.createElement("i",{className:"zmdi zmdi-arrows"})),s.a.createElement(u.a,{"translate-key":"component_dragCropImage"},"\u62d6\u66f3\u5373\u53ef\u4ee5\u91cd\u65b0\u8abf\u6574\u4f4d\u7f6e")):s.a.createElement(A,null,s.a.createElement(U,null,s.a.createElement("i",{className:"zmdi zmdi-alert-triangle"})),s.a.createElement(u.a,{"translate-key":"component_tooLargeToCropImage"},"\u904e\u65bc\u653e\u5927\u5716\u7247\u53ef\u80fd\u6703\u9020\u6210\u5716\u7247\u6a21\u7cca"))):s.a.createElement(_,{innerRef:function(e){t.content=e}}),s.a.createElement(Y,null,s.a.createElement(B,null,this.state.imgHeight&&this.state.imgWidth&&n?s.a.createElement(Q,{onClick:this.skip},s.a.createElement(u.a,{"translate-key":"component_skipCropImage"},"\u7565\u904e\u88c1\u5207")):null),this.state.imgHeight&&this.state.imgWidth?s.a.createElement(G,null,s.a.createElement(J,{size:"small",disable:this.state.cropScaleRange-this.state.cropMinScaleRange<=1},s.a.createElement("i",{className:"zmdi zmdi-image-o"})),s.a.createElement(q,null,s.a.createElement("input",{type:"range",value:this.state.cropScaleRange,min:this.state.cropMinScaleRange,max:this.state.cropMaxScaleRange,onChange:this.onScaleRangeChange})),s.a.createElement(J,{size:"large",disable:this.state.cropMaxScaleRange-this.state.cropScaleRange<=1},s.a.createElement("i",{className:"zmdi zmdi-image-o"}))):s.a.createElement(G,null),s.a.createElement(K,null,s.a.createElement($,{onClick:this.cancel},s.a.createElement(u.a,{"translate-key":"component_cacnel"},"\u53d6\u6d88")),s.a.createElement(Z,{onClick:this.submit},s.a.createElement(u.a,{"translate-key":"component_submit"},"\u78ba\u5b9a"))))))}},{key:"onMouseDown",value:function(t){0===t.button&&(this.placementTop=this.state.imgStyle.top,this.placementLeft=this.state.imgStyle.left,this.moveStartX=t.pageX,this.moveStartY=t.pageY,document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("mousemove",this.onMouseMove))}},{key:"onMouseMove",value:function(t){var e=t.pageX-this.moveStartX,n=t.pageY-this.moveStartY,i=this.placementLeft+e,a=this.placementTop+n,o=this.state.cropHeight,r=this.state.cropWidth*this.state.aspect,l=(this.state.contentHeight-o)/2,s=(this.state.contentWidth-r)/2,c=this.state.cropScaleRange/100,p=this.state.imgWidth*c,d=this.state.imgHeight*c;a>l?a=l:a+d<l+o&&(a=l+o-d),i>s?i=s:i+p<s+r&&(i=s+r-p);var u=Object.assign({},this.state.imgStyle,{top:a,left:i});this.setState({imgStyle:u})}},{key:"onMouseUp",value:function(t){document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove)}},{key:"onScaleRangeChange",value:function(t){var e=this.state.cropHeight,n=this.state.cropWidth*this.state.aspect,i=(this.state.contentHeight-e)/2,a=(this.state.contentWidth-n)/2,o=this.state.cropScaleRange/100,r=this.state.imgWidth*o,l=this.state.imgHeight*o,s=t.target.value,c=s/100,p=this.state.imgWidth*c,d=this.state.imgHeight*c,u=(r-p)/2,g=(l-d)/2,h=this.state.imgStyle.top,m=this.state.imgStyle.left,f=h+g,b=m+u;f>i?f=i:f+d<i+e&&(f=i+e-d),b>a?b=a:b+p<a+n&&(b=a+n-p);var x=Object.assign({},this.state.imgStyle,{WebkitTransform:"scale("+c+")",msTransform:"scale("+c+")",transform:"scale("+c+")",top:f,left:b});this.setState({cropScaleRange:s,imgStyle:x})}},{key:"onLoaded",value:function(t){var e=t.target.naturalWidth,n=t.target.naturalHeight,i=this.content.offsetWidth,a=this.content.offsetHeight,o=this.state.cropHeight,r=this.state.cropWidth*this.state.aspect,l=(a-o)/2,s=(i-r)/2,c={borderLeftWidth:s,borderRightWidth:s,borderTopWidth:l,borderBottomWidth:l},p=r/e,d=o/n,u=p>d?p:d,g=p>d?s:i/2-e*u/2,h=p>d?a/2-n*u/2:l,m={WebkitTransform:"scale("+u+")",msTransform:"scale("+u+")",transform:"scale("+u+")",top:h,left:g};this.setState({imgHeight:n,imgWidth:e,contentWidth:i,contentHeight:a,cropMinScaleRange:100*u,cropMaxScaleRange:u>2?2*u*200:200,cropScaleRange:100*u,cropTipStyle:c,imgStyle:m})}},{key:"onLoadFail",value:function(t){console.log("onLoadFail",t)}},{key:"skip",value:function(t){var e=this.props.callback,n=this.state,i=n.imgWidth,a=n.imgHeight,o={width:i,height:a,x:0,y:0};e&&e(o),this.props.webActions.cancelCropImage()}},{key:"submit",value:function(t){var e=this.state,n=e.cropScaleRange,i=e.cropHeight,a=e.cropWidth,o=e.cropTipStyle,r=e.imgStyle,l=e.imgWidth,s=e.imgHeight,c=this.props.callback,p=n/100,d=o.borderTopWidth,u=o.borderLeftWidth,g=r.top,h=r.left,m=a/p*this.state.aspect,f=i/p,b=(u-h)/p,x=(d-g)/p,y=b/(l-m)*100,v=x/(s-f)*100,k=l/m*100,w=s/f*100;isNaN(y)&&(y=0),isNaN(v)&&(v=0);var S={backgroundPosition:y+"% "+v+"%",backgroundSize:k+"% "+w+"%"},E={width:Math.round(m),height:Math.round(f),x:Math.round(b),y:Math.round(x),previewBgstyle:S};c&&c(E),this.props.webActions.cancelCropImage()}},{key:"cancel",value:function(t){this.props.webActions.cancelCropImage()}}]),e}(l.Component),et=function(t){return{callback:t.web.cropImage.callback,aspect:t.web.cropImage.aspect,src:t.web.cropImage.src,willSkip:t.web.cropImage.willSkip,optimalSize:t.web.cropImage.optimalSize}},nt=function(t){return{webActions:Object(c.bindActionCreators)(d.a.webActionCreators,t)}};e.default=Object(p.b)(et,nt,null,{withRef:!0})(tt)}});
//# sourceMappingURL=67.6616d212.chunk.js.map