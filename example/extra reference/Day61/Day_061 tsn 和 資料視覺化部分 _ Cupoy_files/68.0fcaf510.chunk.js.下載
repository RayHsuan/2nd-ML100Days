webpackJsonp([68],{849:function(e,t,n){"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function a(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0});var u=n(1),d=n.n(u),c=n(32),s=n(48),p=n(54),h=n(5),m=n(316),g=n(320),f=n.n(g),x=n(8),b=n(26),v=n(119),E=n(293),A=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),y=l(["\n    height: 88px;\n    line-height: 88px;\n    margin: 0;\n    color: ",";\n    font-size: 20px;\n    text-align: center;\n    font-weight: bold;\n"],["\n    height: 88px;\n    line-height: 88px;\n    margin: 0;\n    color: ",";\n    font-size: 20px;\n    text-align: center;\n    font-weight: bold;\n"]),k=l(["\n    position: relative;\n    padding: 0 30px;\n"],["\n    position: relative;\n    padding: 0 30px;\n"]),C=l(["\n    display: block;\n    position: relative;\n    width: 100%;\n    margin-bottom: 20px;\n    overflow: hidden;\n"],["\n    display: block;\n    position: relative;\n    width: 100%;\n    margin-bottom: 20px;\n    overflow: hidden;\n"]),D=l(["\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 90px;\n    padding: 0 20px 0 0;\n    float: left;\n    color: ",";\n    text-align: right;\n    font-weight: bold;\n\n    ","\n"],["\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 90px;\n    padding: 0 20px 0 0;\n    float: left;\n    color: ",";\n    text-align: right;\n    font-weight: bold;\n\n    ","\n"]),w=l(["\n    position: relative;\n    display: flex;\n    width: 100%;\n    min-height: 40px;\n    padding-left: 90px;\n    align-items: center;\n"],["\n    position: relative;\n    display: flex;\n    width: 100%;\n    min-height: 40px;\n    padding-left: 90px;\n    align-items: center;\n"]),U=l(["\n    position: relative;\n    display: flex;\n    width: 100%;\n    min-height: 40px;\n    padding-left: 90px;\n    align-items: center;\n    justify-content: center;\n    flex-direction: column;\n"],["\n    position: relative;\n    display: flex;\n    width: 100%;\n    min-height: 40px;\n    padding-left: 90px;\n    align-items: center;\n    justify-content: center;\n    flex-direction: column;\n"]),F=l(["\n    width: 80px;\n    height: 80px;\n    border-radius: 3px;\n    background-color: #eee;\n    background-size: cover;\n    background-position: center center;\n    background-repeat: no-repeat;\n"],["\n    width: 80px;\n    height: 80px;\n    border-radius: 3px;\n    background-color: #eee;\n    background-size: cover;\n    background-position: center center;\n    background-repeat: no-repeat;\n"]),O=l(["\n    margin: 0 0 0 12px;\n"],["\n    margin: 0 0 0 12px;\n"]),Q=l(["\n    position: absolute;\n    top: 50%;\n    right: 12px;\n    color: ",";\n    font-size: 18px;\n    transform: translateY(-50%);\n"],["\n    position: absolute;\n    top: 50%;\n    right: 12px;\n    color: ",";\n    font-size: 18px;\n    transform: translateY(-50%);\n"]),M=l(["\n    display: block;\n    line-height: 1.4em;\n    margin: 8px 0 0;\n    color: ",";\n    font-size: 13px;\n"],["\n    display: block;\n    line-height: 1.4em;\n    margin: 8px 0 0;\n    color: ",";\n    font-size: 13px;\n"]),j=l(["\n    width: 100%;\n    height: 40px;\n    line-height: 40px;\n    padding: 0 12px;\n    border: 1px solid ",";\n    border-radius: 3px;\n    color: ",";\n    font-size: 13px;\n\n    ","\n"],["\n    width: 100%;\n    height: 40px;\n    line-height: 40px;\n    padding: 0 12px;\n    border: 1px solid ",";\n    border-radius: 3px;\n    color: ",";\n    font-size: 13px;\n\n    ","\n"]),S=l(["\n    width: 100%;\n    height: 100px;\n    line-height: 1.5em;\n    padding: 12px 0 0 12px;\n    border: 1px solid ",";\n    border-radius: 3px;\n    color: ",";\n    font-size: 13px;\n\n    ","\n"],["\n    width: 100%;\n    height: 100px;\n    line-height: 1.5em;\n    padding: 12px 0 0 12px;\n    border: 1px solid ",";\n    border-radius: 3px;\n    color: ",";\n    font-size: 13px;\n\n    ","\n"]),I=l(["\n    height: 36px;\n    line-height: 36px;\n    margin: 0;\n    border-color: ",";\n    background-color: transparent;\n    color: ",";\n\n    &:hover {\n        border-color: ",";\n        background-color: transparent;\n        color: ",";\n    }\n\n    input {\n        position: absolute;\n        width: 0px;\n        height: 0px;\n        visibility: hidden;\n    }\n"],["\n    height: 36px;\n    line-height: 36px;\n    margin: 0;\n    border-color: ",";\n    background-color: transparent;\n    color: ",";\n\n    &:hover {\n        border-color: ",";\n        background-color: transparent;\n        color: ",";\n    }\n\n    input {\n        position: absolute;\n        width: 0px;\n        height: 0px;\n        visibility: hidden;\n    }\n"]),B=l(["\n    display: flex;\n    width: 100%;\n    line-height: 1.4em;\n    padding: 10px 0;\n    border: 1px solid ","; \n    border-radius: 3px;\n    color: ",";\n    font-size: 14px;\n    align-items: center;\n    justify-content: center;\n    flex-direction: column;\n"],["\n    display: flex;\n    width: 100%;\n    line-height: 1.4em;\n    padding: 10px 0;\n    border: 1px solid ","; \n    border-radius: 3px;\n    color: ",";\n    font-size: 14px;\n    align-items: center;\n    justify-content: center;\n    flex-direction: column;\n"]),R=l(["\n    width: 300px;\n    margin: 0 0 10px 0;\n    text-align: center;\n"],["\n    width: 300px;\n    margin: 0 0 10px 0;\n    text-align: center;\n"]),z=l(["\n    position: relative;\n    display: flex;\n    width: 100%;\n    padding: 4px 0;\n    align-items: center;\n"],["\n    position: relative;\n    display: flex;\n    width: 100%;\n    padding: 4px 0;\n    align-items: center;\n"]),T=l(["\n    position: relative;\n    width: 100%;\n    height: 10px;\n    margin: 4px 0;\n    border-radius: 50px;\n    background-color: #DDDDDD;\n    overflow: hidden;\n"],["\n    position: relative;\n    width: 100%;\n    height: 10px;\n    margin: 4px 0;\n    border-radius: 50px;\n    background-color: #DDDDDD;\n    overflow: hidden;\n"]),G=l(["\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: ","%;\n    height: 10px;\n    line-height: 10px;\n    border-radius: 50px;\n    background-color: ",";\n    transition: width .3s;\n    \n    ","\n"],["\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: ","%;\n    height: 10px;\n    line-height: 10px;\n    border-radius: 50px;\n    background-color: ",";\n    transition: width .3s;\n    \n    ","\n"]),Y=l(["\n    color: ",";\n\n    ","\n\n    .link {\n        text-decoration: underline;\n        cursor: pointer;\n\n        &:hover {\n            font-weight: $weight-semi-bold;\n        }\n    }\n"],["\n    color: ",";\n\n    ","\n\n    .link {\n        text-decoration: underline;\n        cursor: pointer;\n\n        &:hover {\n            font-weight: $weight-semi-bold;\n        }\n    }\n"]),_=l(["\n    color: ",";\n    text-decoration: underline;\n    cursor: pointer;\n\n    &:hover {\n        font-weight: bold;\n    }\n"],["\n    color: ",";\n    text-decoration: underline;\n    cursor: pointer;\n\n    &:hover {\n        font-weight: bold;\n    }\n"]),H=l(["\n    display: flex;\n    height: 70px;\n    align-items: center;\n    justify-content: center;\n"],["\n    display: flex;\n    height: 70px;\n    align-items: center;\n    justify-content: center;\n"]),X=l(["\n    width: 190px;\n    height: 40px;\n    line-height: 40px;\n    margin: 0 5px;\n"],["\n    width: 190px;\n    height: 40px;\n    line-height: 40px;\n    margin: 0 5px;\n"]),W=l(["\n    width: 130px;\n    height: 40px;\n    line-height: 40px;\n    margin: 0 5px;\n"],["\n    width: 130px;\n    height: 40px;\n    line-height: 40px;\n    margin: 0 5px;\n"]),P=h.default.h6(y,b.e.Dark),L=h.default.div(k),N=h.default.div(C),$=h.default.div(D,b.e.Dark,function(e){if(e.center)return"\n                top: 50%;\n                transform: translateY(-50%);\n            "}),J=h.default.div(w),q=h.default.div(U),K=h.default.div(F),V=h.default.div(O),Z=h.default.div(Q,b.e.Red),ee=h.default.div(M,b.e.Dark3),te=h.default.input(j,b.e.Dark5,b.e.Dark2,function(e){if(e.error)return"\n                border: 1px solid "+b.e.Red+";\n                color: "+b.e.Red+";\n            "}),ne=h.default.textarea(S,b.e.Dark5,b.e.Dark2,function(e){if(e.error)return"\n                border: 1px solid "+b.e.Red+";\n                color: "+b.e.Red+";\n            "}),ie=b.b.Base.extend(I,b.e.Dark5,b.e.Dark2,b.e.Dark5,b.e.Dark2),re=Object(h.default)(m.a)(B,b.e.Dark5,b.e.Dark3),oe=h.default.div(R),ae=Object(h.default)(m.a)(z),le=h.default.div(T),ue=h.default.div(G,function(e){return e.progress?e.progress:0},b.e.Blue,function(e){if(e.error)return"\n                background-color: "+b.e.Red+";\n            "}),de=h.default.div(Y,b.e.Dark,function(e){var t="";return e.success&&(t+="color: "+b.e.Blue+";"),e.error&&(t+="color: "+b.e.Red+";"),t}),ce=h.default.span(_,b.e.Red),se=h.default.div(H),pe=b.b.Red.extend(X),he=b.b.Gray.extend(W),me=b.b.Blue.extend(X),ge=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={title:"",txtcontent:"",thumbnailurl:void 0,coverfile:void 0,cropX:0,cropY:0,cropWidth:0,cropHeight:0,previewBgstyle:void 0,isTitleEmpty:!1,isCreateError:!1,isUpdateingMeta:!1,isUpdateMetaError:!1},n.isCreating=!1,n.closeDialog=n.closeDialog.bind(n),n.createSubmit=n.createSubmit.bind(n),n.createCancel=n.createCancel.bind(n),n.editSubmit=n.editSubmit.bind(n),n.editCancel=n.editCancel.bind(n),n.backendUploadAudioQueue=n.backendUploadAudioQueue.bind(n),n.onInputChange=n.onInputChange.bind(n),n.onFileChanged=n.onFileChanged.bind(n),n.onAudioFileChange=n.onAudioFileChange.bind(n),n.startUploadAudioCumatrixItem=n.startUploadAudioCumatrixItem.bind(n),n.createAudioCumatrixItem=n.createAudioCumatrixItem.bind(n),n.createAudioQueue=n.createAudioQueue.bind(n),n.getAudioQueue=n.getAudioQueue.bind(n),n.updateAudioQueue=n.updateAudioQueue.bind(n),n.removeAudioQueue=n.removeAudioQueue.bind(n),n.retrySelectFile=n.retrySelectFile.bind(n),n.retryUploadFile=n.retryUploadFile.bind(n),n}return a(t,e),A(t,[{key:"componentDidMount",value:function(){var e=this.props.createOrEditAudioDialog.editMetaInfo;e&&this.setState({title:e.title||"",txtcontent:e.txtcontent||"",thumbnailurl:e.thumbnailurl,previewBgstyle:e.previewBgstyle})}},{key:"closeDialog",value:function(){this.props.collectionActions.closeCreateOrEditAudioDialog()}},{key:"createSubmit",value:function(){var e=this,t=this.state,n=t.title,i=t.isTitleEmpty,r=this.props.createOrEditAudioDialog.itemuid,o=this.getAudioQueue(r);if(o&&!o.isGetFileMD5Error&&!o.isUploadError){var a=!n;a!==i&&this.setState({isTitleEmpty:a}),a||(o.isFinishAudioUpload?(this.closeDialog(),o.removeAudioQueue(o.itemuid)):o.isUploadSuccess?o.finish().then(function(t){e.closeDialog(),o.removeAudioQueue(o.itemuid)}):this.backendUploadAudioQueue(o))}}},{key:"createCancel",value:function(){var e=this.props.createOrEditAudioDialog.itemuid,t=this.getAudioQueue(e);t&&t.cancel(),this.closeDialog()}},{key:"editSubmit",value:function(){var e=this,t=this.state,n=t.title,i=t.txtcontent,r=t.isTitleEmpty,o=t.coverfile,a=t.thumbnailurl,l=t.cropX,u=t.cropY,d=t.cropWidth,c=t.cropHeight,s=t.previewBgstyle;if(!t.isUpdateingMeta){var p=this.props.createOrEditAudioDialog,h=p.cumatrixUID,m=p.itemuid,g=p.itemUpdateCallback,f=!n;f!==r&&this.setState({isTitleEmpty:f}),f||this.setState({isUpdateingMeta:!0},function(){e.props.collectionActions.updateAudioMeta({cumatrixid:h,itemid:m,title:n,txtcontent:i,file:o,cropX:l,cropY:u,cropWidth:d,cropHeight:c}).then(function(t){g&&g(m,n,i,a,s),e.setState({isUpdateingMeta:!1}),e.closeDialog()},function(t){e.setState({isUpdateingMeta:!1,isUpdateMetaError:!0})})})}}},{key:"editCancel",value:function(){this.closeDialog()}},{key:"backendUploadAudioQueue",value:function(e){var t=this,n=this.props.createOrEditAudioDialog.itemUpdateCallback;e.autoFinish=!0,this.updateAudioQueue(e,function(){t.props.uploaderActions.addUploadQueue(e),n&&n(e.itemuid,e.title,e.txtcontent,e.thumbnailurl,e.previewBgstyle),t.closeDialog()})}},{key:"onInputChange",value:function(e,t){var n=this;e.preventDefault();var r=e.target.value;this.setState(i({},t,r),function(){var e=n.props.createOrEditAudioDialog.itemuid,i=n.getAudioQueue(e);i&&(i[t]=r,i.updateAudioQueue(i))})}},{key:"onFileChanged",value:function(e){var t=this;if(Array.isArray(e)&&e.length>0){var n=e[0],i=window.URL.createObjectURL(n);this.props.webActions.cropImage(i,1,!1,function(e){t.setState({coverfile:n,thumbnailurl:i,cropX:e.x,cropY:e.y,cropWidth:e.width,cropHeight:e.height,previewBgstyle:e.previewBgstyle},function(){var r=t.props.createOrEditAudioDialog.itemuid,o=t.getAudioQueue(r);o&&(o.coverfile=n,o.thumbnailurl=i,o.cropX=e.x,o.cropY=e.y,o.cropWidth=e.width,o.cropHeight=e.height,o.previewBgstyle=e.previewBgstyle,o.updateAudioQueue(o))})})}}},{key:"onAudioFileChange",value:function(e){var t=this;if(Array.isArray(e)&&e.length>0){var n=e[0];0===n.size&&this.props.webActions.openAlartDialog({title:"\u6a94\u6848\u6709\u8aa4",description:"\u8a72\u6a94\u6848\u640d\u6bc0\uff0c\u8acb\u66f4\u63db\u6a94\u6848\u518d\u8a66\u4e00\u6b21\u3002"});var i=this.state.title;if(n.name&&!i){var r=n.name;r.lastIndexOf(".")>0&&(r=r.substr(0,r.lastIndexOf("."))),i=r}i||(i="\u672a\u547d\u540d\u8072\u97f3"),i!==this.state.title?this.setState({title:i},function(){t.startUploadAudioCumatrixItem(n)}):this.startUploadAudioCumatrixItem(n)}}},{key:"startUploadAudioCumatrixItem",value:function(e){var t=this.props.createOrEditAudioDialog,n=t.itemuid,i=this.getAudioQueue(n);if(!i)return void this.createAudioCumatrixItem(e);i=Object.assign({},i,{soundfile:e}),this.updateAudioQueue(i,function(){i.start&&i.start()})}},{key:"createAudioCumatrixItem",value:function(e){var t=this;if(!this.isCreating){this.isCreating=!0;var n=this.state.title,i=this.props.createOrEditAudioDialog,r=i.cumatrixUID,o=i.chaptertype,a=i.chaptername,l=i.isAddToFirst,u=i.itemCreateCallback;this.props.collectionActions.createAudioItem({cumatrixid:r,chaptertype:o,chaptername:a,isAddToFirst:l,title:n}).then(function(n){t.isCreating=!1,n?t.props.collectionActions.updateCreateOrEditAudioDialog({itemuid:n.itemuid}).then(function(){n.thumbnailurl=t.state.thumbnailurl||x.a.CUMATRIX_DUMMY_IMAGE,n.previewBgstyle=t.state.previewBgstyle,u&&u(n),t.createAudioQueue(n,e)}):t.setState({isCreateError:!0})},function(e){t.isCreating=!1,t.setState({isCreateError:!0})})}}},{key:"createAudioQueue",value:function(e,t){var n=this.state,i=n.title,r=n.txtcontent,o=n.coverfile,a=n.thumbnailurl,l=n.cropX,u=n.cropY,d=n.cropWidth,c=n.cropHeight,s=n.previewBgstyle,p=this.props,h=p.createOrEditAudioDialog,m=p.collectionActions,g=h.itemuid,b=h.cumatrixUID,v=h.chaptertype,E=h.chaptername,A=h.itemCreateCallback,y=h.itemUpdateCallback,k=h.itemRemoveCallback,C=m.uploadCumatrixAudioFile,D=m.removeCumatrixItemFromDefaultChapter,w=m.removeCumatrixItemFromChapter,U=m.removeCumatrixDraftItem,F=m.updateAudioMeta,O=m.finishAudioUpload,Q=m.openCreateOrEditAudioDialog,M={title:i,txtcontent:r,coverfile:o,thumbnailurl:a||x.a.CUMATRIX_DUMMY_IMAGE,cropX:l,cropY:u,cropWidth:d,cropHeight:c,previewBgstyle:s,cumatrixUID:b,chaptertype:v,chaptername:E,itemuid:g,ctype:e.ctype,soundfile:t,md5:void 0,duration:0,progress:0,isGetFileMD5Error:!1,isUploading:!1,isUploadSuccess:!1,isUploadError:!1,isFinishing:!1,isFinishError:!1,isFinishAudioUpload:!1,id:e.itemuid,autoFinish:!1,isSuccess:!1,isError:!1,updateAudioQueue:this.updateAudioQueue,removeAudioQueue:this.removeAudioQueue};M.start=function(){var e=this;e&&e.getFileMD5(e.soundfile).then(function(t){t?(e=Object.assign({},e,{md5:t.md5,duration:t.duration}),e.updateAudioQueue(e),e.upload()):(e=Object.assign({},e,{isGetFileMD5Error:!0,isError:!0}),e.updateAudioQueue(e))},function(t){e=Object.assign({},e,{isGetFileMD5Error:!0,isError:!0}),e.updateAudioQueue(e)})},M.upload=function(){var e=this;e&&(e.isUploading||(e=Object.assign({},e,{isUploading:!0,progress:0}),e.updateAudioQueue(e,function(){C({cumatrixid:e.cumatrixUID,itemid:e.itemuid,md5:e.md5,filesize:e.soundfile.size,filename:e.title,file:e.soundfile,progressCallback:function(t){e=Object.assign({},e,{progress:t}),e.updateAudioQueue(e)}}).then(function(t){e=Object.assign({},e,{progress:100,isUploadSuccess:!0,isUploading:!1}),e.updateAudioQueue(e,function(){e.autoFinish&&e.finish()})},function(t){e=Object.assign({},e,{isUploadError:!0,isUploading:!1,isError:!0}),e.updateAudioQueue(e)})})))},M.finish=function(){var e=this;if(e){return new Promise(function(t,n){e=Object.assign({},e,{isFinishing:!0}),e.updateAudioQueue(e,function(){if(e.isFinishAudioUpload)return e=Object.assign({},e,{isFinishing:!1}),e.updateAudioQueue(e),void t(!0);F({cumatrixid:e.cumatrixUID,itemid:e.itemuid,title:e.title,txtcontent:e.txtcontent,playtimesec:e.duration,file:e.coverfile,cropX:e.cropX,cropY:e.cropY,cropWidth:e.cropWidth,cropHeight:e.cropHeight}).then(function(i){O({cumatrixid:e.cumatrixUID,itemid:e.itemuid,md5:e.md5,file:e.coverfile,cropX:e.cropX,cropY:e.cropY,cropWidth:e.cropWidth,cropHeight:e.cropHeight,filesize:e.soundfile.size}).then(function(n){e=Object.assign({},e,{isFinishing:!1,isFinishAudioUpload:!0,isSuccess:!0}),e.updateAudioQueue(e,function(){e.autoFinish&&e.removeAudioQueue(e.itemuid)}),y&&y(e.itemuid,e.title,e.txtcontent,e.thumbnailurl,e.previewBgstyle),t(!0)},function(t){e=Object.assign({},e,{isFinishError:!0,isFinishing:!1,isError:!0}),e.updateAudioQueue(e),n(!1)})},function(t){e=Object.assign({},e,{isFinishError:!0,isFinishing:!1,isError:!0}),e.updateAudioQueue(e),n(!1)})})})}},M.retry=function(){var e=this;if(e){var t={isError:!1},n=e.start;e.isGetFileMD5Error&&(t.md5=void 0,t.isGetFileMD5Error=!1,n=e.start),e.isUploadError&&(t.progress=0,t.isUploading=!1,t.isUploadError=!1,n=e.upload),e.isFinishError&&(t.isFinishError=!1,n=e.finish),e=Object.assign({},e,t),e.updateAudioQueue(e,function(){n()})}},M.cancel=function(){var e=this;if(e&&e.itemuid){switch(e.chaptertype){case x.a.chapterType.DEFAULTCHAPTER:D(e.cumatrixUID,e.itemuid);break;case x.a.chapterType.NORMALCHAPTER:w(b,e.itemuid,e.chaptername);break;case x.a.chapterType.DRAFT:U(b,e.itemuid)}k&&k(e.itemuid)}},M.getFileMD5=function(e){return new Promise(function(t,n){var i=f()(e.preview),r=document.createElement("audio");r.addEventListener("loadeddata",function(){var e=r.duration||0;t({md5:i,duration:e})}),r.preload="auto",r.muted=!0,r.src=e.preview})},M.edit=function(){var e=this;e&&(e.autoFinish=!1,e.updateAudioQueue(e,function(){Q({itemuid:e.itemuid,editMetaInfo:{title:e.title,txtcontent:e.txtcontent,thumbnailurl:e.thumbnailurl,previewBgstyle:e.previewBgstyle},cumatrixUID:e.cumatrixUID,chaptertype:e.chaptertype,chaptername:e.chaptername,isAddToFirst:e.isAddToFirst,itemCreateCallback:A,itemUpdateCallback:y,itemRemoveCallback:k})}))},this.updateAudioQueue(M,function(){M.start()})}},{key:"getAudioQueue",value:function(e){if(e){return this.props.createOrEditAudioDialog.audioQueueMap[e]}}},{key:"updateAudioQueue",value:function(e,t){var n=this.props.createOrEditAudioDialog.audioQueueMap,r=Object.assign({},n,i({},e.itemuid,e));this.props.collectionActions.updateCreateOrEditAudioDialog({audioQueueMap:r}).then(function(){t&&t()}),this.props.uploaderActions.uploadQueueState(e)}},{key:"removeAudioQueue",value:function(e){var t=this.props.createOrEditAudioDialog.audioQueueMap,n=Object.assign({},t,i({},e,void 0));this.props.collectionActions.updateCreateOrEditAudioDialog({audioQueueMap:n})}},{key:"getSoundImage",value:function(e){return e||x.a.CUMATRIX_DUMMY_IMAGE}},{key:"retrySelectFile",value:function(){var e=this.props.createOrEditAudioDialog,t=e.itemuid,n=this.getAudioQueue(t);n&&(n=Object.assign({},n,{soundfile:void 0,isGetFileMD5Error:!1}),this.updateAudioQueue(n))}},{key:"retryUploadFile",value:function(){var e=this.props.createOrEditAudioDialog,t=e.itemuid,n=this.getAudioQueue(t);n&&n.retry&&n.retry()}},{key:"renderHeader",value:function(e){return d.a.createElement(P,null,e?d.a.createElement(v.a,null,"\u7de8\u8f2f\u8072\u97f3"):d.a.createElement(v.a,null,"\u4e0a\u50b3\u8072\u97f3"))}},{key:"renderSoundUpload",value:function(e,t){var n=this;return e?null:t?d.a.createElement(N,null,d.a.createElement($,{center:!0},d.a.createElement(v.a,null,"\u6a94\u6848\u4e0a\u50b3")),d.a.createElement(q,null,t.md5||t.isGetFileMD5Error?null:d.a.createElement(de,null,d.a.createElement(v.a,null,"\u6a94\u6848\u5206\u6790\u4e2d...")),!t.md5&&t.isGetFileMD5Error?d.a.createElement(de,null,d.a.createElement(v.a,null,"\u6a94\u6848\u5206\u6790\u5931\u6557\uff0c\u8acb\u91cd\u65b0"),d.a.createElement(ce,{onClick:this.retrySelectFile},d.a.createElement(v.a,null,"\u518d\u8a66\u4e00\u6b21"))):null,!t.md5||t.isUploadSuccess||t.isUploadError?null:d.a.createElement(de,null,d.a.createElement(v.a,null,"\u4e0a\u50b3\u4e2d\uff0c\u6309\u4e0b\u78ba\u5b9a\u65b0\u589e\u5c07\u5728\u80cc\u666f\u7e7c\u7e8c\u4e0a\u50b3")),t.isUploadSuccess?d.a.createElement(de,{success:!0},d.a.createElement(v.a,null,"\u4e0a\u50b3\u5b8c\u6210\uff0c\u6309\u4e0b\u78ba\u5b9a\u65b0\u589e\u52a0\u5165\u5217\u8868")):null,t.isUploadError?d.a.createElement(de,{error:!0},d.a.createElement(v.a,null,"\u4e0a\u50b3\u767c\u751f\u932f\u8aa4\uff0c"),d.a.createElement(ce,{onClick:this.retryUploadFile},d.a.createElement(v.a,null,"\u518d\u8a66\u4e00\u6b21"))):null,d.a.createElement(le,null,d.a.createElement(ue,{progress:t.progress,error:t.isUploadError})))):d.a.createElement(N,null,d.a.createElement($,{center:!0},d.a.createElement(v.a,null,"\u6a94\u6848\u4e0a\u50b3")),d.a.createElement(J,null,d.a.createElement(re,{accept:"audio/*",multiple:!1,onDrop:function(e){return n.onAudioFileChange(e)},acceptStyle:{backgroundColor:b.e.RGBA(b.e.Blue,.1)},rejectStyle:{backgroundColor:b.e.RGBA(b.e.Red,.1)}},d.a.createElement(oe,null,"\u5c07\u8072\u97f3\u6a94\u6848\u62d6\u653e\u5230\u9019\u88e1\uff0c\u6216\u662f\u9078\u53d6\u4e00\u500b\u6a94\u6848\u3002",d.a.createElement("br",null),"\uff08\u5efa\u8b70\u683c\u5f0f\uff1amp3\u3001wav\u3001m4a\u3001flac\uff09"),d.a.createElement(ie,{outline:!0},d.a.createElement(v.a,null,"\u9078\u64c7\u6a94\u6848")))))}},{key:"renderFooter",value:function(e,t){return e?this.renderEditFooter():this.renderCreateFooter(t)}},{key:"renderCreateFooter",value:function(e){var t=e&&e.isFinishError,n=!e||e.isFinishing||e.isGetFileMD5Error||e.isUploadError;return e&&e.isFinishAudioUpload?d.a.createElement(se,null,d.a.createElement(me,{onClick:this.createSubmit},d.a.createElement(v.a,null,"\u5b8c\u6210"))):d.a.createElement(se,null,d.a.createElement(pe,{onClick:this.createSubmit,disable:n},e&&e.isFinishing?d.a.createElement(b.i.Spin,{size:"16px",color:"#fff",margin:"0 10px 0 0"}):null,t?d.a.createElement(v.a,null,"\u932f\u8aa4\uff0c\u518d\u8a66\u4e00\u6b21"):d.a.createElement(v.a,null,"\u78ba\u5b9a\u65b0\u589e")),d.a.createElement(he,{onClick:this.createCancel},d.a.createElement(v.a,null,"\u53d6\u6d88\u65b0\u589e")))}},{key:"renderEditFooter",value:function(){var e=this.state,t=e.isUpdateingMeta,n=e.isUpdateMetaError;return d.a.createElement(se,null,d.a.createElement(pe,{onClick:this.editSubmit,disable:t},t?d.a.createElement(b.i.Spin,{size:"16px",color:"#fff",margin:"0 10px 0 0"}):null,n?d.a.createElement(v.a,null,"\u932f\u8aa4\uff0c\u518d\u8a66\u4e00\u6b21"):d.a.createElement(v.a,null,"\u78ba\u5b9a\u66f4\u65b0")),d.a.createElement(he,{onClick:this.editCancel},d.a.createElement(v.a,null,"\u53d6\u6d88\u7de8\u8f2f")))}},{key:"render",value:function(){var e=this,t=this.state,n=t.title,i=t.txtcontent,r=t.thumbnailurl,o=t.previewBgstyle,a=t.isTitleEmpty,l=this.props.createOrEditAudioDialog,u=l.itemuid,c=l.isEditMode,s=this.getAudioQueue(u);return d.a.createElement(b.f.Content,{width:"560px",maxWidth:"560px",padding:"0",backgroundColor:"#fff",maskBackgroundColor:"rgba(0, 0, 0, 0.7)",borderRadius:"3px",visible:!0,animation:"zoom",maskAnimation:"fade",closable:!1,maskClosable:!1,keyboard:!1,onClose:this.closeDialog},this.renderHeader(c),d.a.createElement(L,null,this.renderSoundUpload(c,s),d.a.createElement(N,null,d.a.createElement($,{center:!0},d.a.createElement(v.a,null,"\u7bc0\u76ee\u5c01\u9762")),d.a.createElement(J,null,d.a.createElement(ae,{accept:"image/*",multiple:!1,onDrop:function(t){return e.onFileChanged(t)},acceptStyle:{backgroundColor:b.e.RGBA(b.e.Blue,.1)},rejectStyle:{backgroundColor:b.e.RGBA(b.e.Red,.1)}},d.a.createElement(E.a,{src:this.getSoundImage(r),stylecomponent:K,isBackgroundImage:!0,style:o}),d.a.createElement(V,null,d.a.createElement(ie,{outline:!0},d.a.createElement(v.a,null,"\u4e0a\u50b3\u5c01\u9762")),d.a.createElement(ee,null,"\u5c07\u5716\u7247\u6a94\u6848\u62d6\u653e\u5230\u9019\u88e1\uff0c\u6216\u662f\u9078\u53d6\u4e00\u500b\u6a94\u6848\u3002",d.a.createElement("br",null),"\u5efa\u8b70\u4e0a\u50b3\u8d85\u904e 960x960 \u50cf\u7d20\u4ee5\u4e0a\u7684\u5716\u7247"))))),d.a.createElement(N,null,d.a.createElement($,{center:!0},d.a.createElement(v.a,null,"\u7bc0\u76ee\u540d\u7a31")),d.a.createElement(J,null,d.a.createElement(te,{type:"text",value:n,onChange:function(t){return e.onInputChange(t,"title")},placeholder:"\u8f38\u5165\u60a8\u7684\u7bc0\u76ee\u540d\u7a31",error:a}),a?d.a.createElement(Z,null,d.a.createElement("i",{className:"zmdi zmdi-alert-circle"})):null)),d.a.createElement(N,null,d.a.createElement($,null,d.a.createElement(v.a,null,"\u7bc0\u76ee\u8aaa\u660e")),d.a.createElement(J,null,d.a.createElement(ne,{rows:"3",type:"text",value:i,onChange:function(t){return e.onInputChange(t,"txtcontent")},placeholder:"\u7bc0\u76ee\u8aaa\u660e"})))),this.renderFooter(c,s))}}]),t}(u.Component),fe=function(e){return{createOrEditAudioDialog:e.collection.createOrEditAudioDialog}},xe=function(e){return{webActions:Object(c.bindActionCreators)(p.a.webActionCreators,e),uploaderActions:Object(c.bindActionCreators)(p.a.uploaderActionCreators,e),collectionActions:Object(c.bindActionCreators)(p.a.collectionActionCreators,e)}};t.default=Object(s.b)(fe,xe,null,{withRef:!0})(ge)}});
//# sourceMappingURL=68.0fcaf510.chunk.js.map