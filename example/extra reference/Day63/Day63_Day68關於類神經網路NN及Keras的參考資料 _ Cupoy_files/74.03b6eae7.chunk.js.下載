webpackJsonp([74],{860:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function o(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function r(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0});var l=n(1),s=n.n(l),c=n(32),u=n(48),p=n(54),m=n(5),d=n(26),x=n(119),f=n(34),g=n(120),h=n(8),b=n(293),y=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),E=r(["\n    font-size: 20px;\n    color: #565151;\n    text-align: center;\n    margin-bottom: 16px;\n    font-weight: 600;\n"],["\n    font-size: 20px;\n    color: #565151;\n    text-align: center;\n    margin-bottom: 16px;\n    font-weight: 600;\n"]),w=r(["\n    position: absolute;\n    top: 0;\n    right: 0;\n    padding: 20px;\n    color: #565151;\n    font-size: 24px;\n    cursor: pointer;\n"],["\n    position: absolute;\n    top: 0;\n    right: 0;\n    padding: 20px;\n    color: #565151;\n    font-size: 24px;\n    cursor: pointer;\n"]),C=r(["\n    opacity: 0.8;\n    font-size: 14px;\n    color: #333030;\n    text-align: center;\n    line-height: 22px;\n"],["\n    opacity: 0.8;\n    font-size: 14px;\n    color: #333030;\n    text-align: center;\n    line-height: 22px;\n"]),k=r(["\n    font-weight: 600;\n"],["\n    font-weight: 600;\n"]),v=r(["\n    color: ",";\n"],["\n    color: ",";\n"]),A=r(["\n    display: flex;\n    flex-direction: row;\n    justify-content: center;\n    align-items: center;\n    margin-top: 30px;\n"],["\n    display: flex;\n    flex-direction: row;\n    justify-content: center;\n    align-items: center;\n    margin-top: 30px;\n"]),D=r(["\n    background-color: ",";\n    border-radius: 3px;\n    font-size: 14px;\n    color: #FFFFFF;\n    text-align: center;\n    margin: 0 10px;\n    min-width: 140px;\n    height: 36px;\n    line-height: 36px;\n    border-radius: 3px;\n    padding-left: 16px;\n    padding-right: 16px;\n    cursor: pointer;\n\n    ","\n"],["\n    background-color: ",";\n    border-radius: 3px;\n    font-size: 14px;\n    color: #FFFFFF;\n    text-align: center;\n    margin: 0 10px;\n    min-width: 140px;\n    height: 36px;\n    line-height: 36px;\n    border-radius: 3px;\n    padding-left: 16px;\n    padding-right: 16px;\n    cursor: pointer;\n\n    ","\n"]),I=r(["\n    display: flex;\n    flex-direction: row;\n    justify-content: flex-start;\n    align-items: center;\n    margin-bottom: 16px;\n"],["\n    display: flex;\n    flex-direction: row;\n    justify-content: flex-start;\n    align-items: center;\n    margin-bottom: 16px;\n"]),T=r(["\n    position: relative;\n    width: 65px;\n    min-width: 65px;\n    height: 87px;\n    background-color: #DDD;\n    background-repeat: no-repeat;\n    background-size: cover;\n    background-position: center;\n    margin-right: 12px;\n"],["\n    position: relative;\n    width: 65px;\n    min-width: 65px;\n    height: 87px;\n    background-color: #DDD;\n    background-repeat: no-repeat;\n    background-size: cover;\n    background-position: center;\n    margin-right: 12px;\n"]),S=r(["\n    position: absolute;\n    display: flex;\n    flex-direction: row;\n    justify-content: center;\n    align-items: center;\n    top: 6px;\n    left: 6px;\n    width: 20px;\n    height: 20px;\n    border-radius: 10px;\n    background-color: rgba(0,0,0,0.5);\n    color: #FFF;\n    font-size: 12px;\n"],["\n    position: absolute;\n    display: flex;\n    flex-direction: row;\n    justify-content: center;\n    align-items: center;\n    top: 6px;\n    left: 6px;\n    width: 20px;\n    height: 20px;\n    border-radius: 10px;\n    background-color: rgba(0,0,0,0.5);\n    color: #FFF;\n    font-size: 12px;\n"]),F=r(["\n    width: 330px;\n    margin-right: 12px;\n"],["\n    width: 330px;\n    margin-right: 12px;\n"]),O=r(["\n    width: 100%;\n    margin-bottom: 8px;\n    font-size: 14px;\n    color: #565151;\n    font-weight: 600;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    overflow:hidden; \n"],["\n    width: 100%;\n    margin-bottom: 8px;\n    font-size: 14px;\n    color: #565151;\n    font-weight: 600;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    overflow:hidden; \n"]),z=r(["\n    width: 100%;\n    height: 60px;\n    opacity: 0.8;\n    font-size: 13px;\n    color: #565151;\n    text-align: justify;\n    line-height: 20px;\n    overflow:hidden;\n"],["\n    width: 100%;\n    height: 60px;\n    opacity: 0.8;\n    font-size: 13px;\n    color: #565151;\n    text-align: justify;\n    line-height: 20px;\n    overflow:hidden;\n"]),B=r(["\n    width: 100%;\n    height: 1px;\n    background-color: #E2DFDE;\n    margin-top: 25px;\n    margin-bottom: 25px;\n"],["\n    width: 100%;\n    height: 1px;\n    background-color: #E2DFDE;\n    margin-top: 25px;\n    margin-bottom: 25px;\n"]),j=r(["\n    font-size: 14px;\n    color: #565151;\n    margin-bottom: 20px;\n    font-weight: 600;\n"],["\n    font-size: 14px;\n    color: #565151;\n    margin-bottom: 20px;\n    font-weight: 600;\n"]),P=m.default.div(E),_=m.default.div(w),N=m.default.div(C),L=m.default.span(k),Y=m.default.span(v,d.e.Red),U=m.default.div(A),R=m.default.div(D,function(e){return e.isGary?"#C6BDBC":"#E00016"},function(e){if(e.disable)return"\n                opacity: 0.5;\n                cursor: default;\n            "}),K=m.default.div(I),G=m.default.div(T),M=m.default.div(S),V=m.default.div(F),W=m.default.div(O),q=m.default.div(z),J=m.default.hr(B),H=m.default.div(j),Q=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.closeDialog=n.closeDialog.bind(n),n.subscribeKwassist=n.subscribeKwassist.bind(n),n.buyCollection=n.buyCollection.bind(n),n.buyCpoints=n.buyCpoints.bind(n),n.state={isBuying:!1,isBuyError:!1,isSelected:!1,selectedAssistID:void 0,isInit:!1},n}return o(t,e),y(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.kwassistListIds,i=t.buyCollectionDialog,a=i.collection;0!==n.items.length||n.isLoading||n.isEmpty?this.setState({isInit:!0}):this.props.kwassistActions.getKwAssistList({len:10}).then(function(t){e.setState({isInit:!0})},function(t){e.setState({isInit:!0})}),this.getCumatrixFromAssist(a)}},{key:"getCumatrixFromAssist",value:function(e){var t=this.props,n=t.kwassistCache,i=t.CumatrixFromAssistIds;if(e.subtype===h.a.cumatrixPdtSubType.SUBSCRIBE_ONLY){for(var a="",o=Array.isArray(e.assistids)?e.assistids:[],r=0;r<o.length;r++){a=o[r];var l=n[a];if(l&&l.isSubscriber)break;a=""}if(!a)return;this.setState({selectedAssistID:a});var s=i[a]||{},c=s.items?s.items:[],u=!!s.isLoading,p=!!s.isEmpty,m=!!s.isError,d=!!s.isNoMore,x=s.nextStart?s.nextStart:0;if(u||d||p||0===c.length&&m)return;this.props.kwassistActions.getCumatrixFromAssist({assistid:a,sortby:"score",isDesc:!0,start:x,len:4}).then(function(e){},function(e){})}}},{key:"closeDialog",value:function(){this.props.webActions.hideBuyCollectionDialog()}},{key:"subscribeKwassist",value:function(){this.props.webActions.cupoyStateGo(f.a.STATES.KWASSIST,{id:this.state.selectedAssistID},null,{modal:!0}),this.closeDialog()}},{key:"buyCollection",value:function(){var e=this;if(!this.state.isBuying){var t=this.props.buyCollectionDialog.collection,n=t.cumatrixUID;this.setState({isBuying:!0},function(){e.props.collectionActions.buyOutCumatrix({cumatrixid:n}).then(function(i){e.props.webActions.showPaymentSuccessDialog({name:t.name,paymentType:h.a.PAYMENT_TYPE.COLLECTION}),e.props.collectionActions.subscribeCuMatrix({cumatrixid:n}),e.closeDialog()},function(t){console.log(t),e.setState({isBuying:!1,isBuyError:!0})})})}}},{key:"buyCpoints",value:function(){var e=f.a.getCurrent(),t=e.state,n=e.params,i=e.querys,a=e.locationState;this.props.pointActions.saveRouteToPaymenttSate({stateName:t,params:n,querys:i,locationState:a}),this.props.webActions.cupoyStateGo(f.a.STATES.CPOINTPAYMENT),this.closeDialog()}},{key:"rednerBuyoutView",value:function(e){var t=this.state,n=t.isBuying,i=t.isBuyError,a=this.props.cpointsInfo,o=isNaN(a.cpoints)?0:a.cpoints;return e.price>o?s.a.createElement(d.f.Content,{width:"360px",maxWidth:"360px",padding:"30px",backgroundColor:"#fff",borderRadius:"3px",visible:!0,animation:"zoom",maskAnimation:"fade",closable:!1,maskClosable:!0,keyboard:!1,onClose:this.closeDialog},s.a.createElement(P,null,s.a.createElement(x.a,null,"\u9ede\u6578\u4e0d\u8db3")),s.a.createElement(N,null,"\u9ede\u6578\u5269\u9918",s.a.createElement(Y,null,o,"\u9ede"),"\uff0c \u5dee",s.a.createElement(L,null,e.price-o),"\u9ede\u5c31\u80fd\u7acb\u523b\u8a02\u95b1",s.a.createElement(L,null,"\u300c",e.name,"\u300d"),"\uff0c \u8d95\u7dca\u53bb\u5132\u503c\u5427\uff01"),s.a.createElement(U,null,s.a.createElement(R,{onClick:this.buyCpoints},s.a.createElement(x.a,null,"\u53bb\u5132\u503c")),s.a.createElement(R,{isGary:!0,onClick:this.closeDialog},s.a.createElement(x.a,null,"\u53d6\u6d88"))),s.a.createElement(_,{onClick:this.closeDialog},s.a.createElement("i",{className:"zmdi zmdi-close"}))):s.a.createElement(d.f.Content,{width:"360px",maxWidth:"360px",padding:"30px",backgroundColor:"#fff",borderRadius:"3px",visible:!0,animation:"zoom",maskAnimation:"fade",closable:!1,maskClosable:!0,keyboard:!1,onClose:this.closeDialog},s.a.createElement(P,null,s.a.createElement(x.a,null,"\u8cfc\u8cb7\u8ab2\u7a0b")),s.a.createElement(N,null,"\u5373\u5c07\u4f7f\u7528",s.a.createElement(Y,null,e.price,"\u9ede"),"\uff0c \u8cfc\u8cb7",s.a.createElement(L,null,"\u300c",e.name,"\u300d"),"\u66f8\u7c4d\u8ab2\u7a0b\uff0c \u78ba\u5b9a\u8981\u7e7c\u7e8c\u8cfc\u8cb7\u55ce\uff1f"),s.a.createElement(U,null,s.a.createElement(R,{onClick:this.buyCollection},n?s.a.createElement(d.i.Spin,{color:"#FFF"}):null,i?s.a.createElement(x.a,null,"\u932f\u8aa4\uff0c\u8acb\u518d\u5617\u8a66\u4e00\u6b21\uff01"):s.a.createElement(x.a,null,"\u78ba\u8a8d\u8cfc\u8cb7")),s.a.createElement(R,{isGary:!0,onClick:this.closeDialog},s.a.createElement(x.a,null,"\u53d6\u6d88"))),s.a.createElement(_,{onClick:this.closeDialog},s.a.createElement("i",{className:"zmdi zmdi-close"})))}},{key:"rednerSubscribeOnlyView",value:function(e){var t=this.state,n=t.isBuying,i=t.isBuyError,a=t.selectedAssistID,o=this.props,r=o.kwassistCache,l=o.CumatrixFromAssistIds,c=o.CumatrixFromAssistCache,u=r[a],p=l[a]||{},m=p.items?p.items:[];return s.a.createElement(d.f.Content,{width:"520px",maxWidth:"520px",padding:"30px",backgroundColor:"#fff",borderRadius:"3px",visible:!0,animation:"zoom",maskAnimation:"fade",closable:!1,maskClosable:!0,keyboard:!1,onClose:this.closeDialog},s.a.createElement(P,null,s.a.createElement(x.a,null,"\u78ba\u8a8d\u8a02\u95b1")),s.a.createElement(K,null,s.a.createElement(b.a,{src:h.a.getCollectCoverImage(e),stylecomponent:G,isBackgroundImage:!0},e.matrixtype===h.a.cumatrixTypeToInt.CTYPE_BOOK?s.a.createElement(M,null,s.a.createElement("i",{className:"icon-cumatrix-book"})):null,e.matrixtype===h.a.cumatrixTypeToInt.CTYPE_VIDEO?s.a.createElement(M,null,s.a.createElement("i",{className:"icon-cumatrix-video"})):null,e.matrixtype===h.a.cumatrixTypeToInt.CTYPE_AUDIO?s.a.createElement(M,null,s.a.createElement("i",{className:"icon-cumatrix-audio"})):null),s.a.createElement(V,null,s.a.createElement(W,null,e.name),s.a.createElement(q,null,e.description))),m.length>0?s.a.createElement(J,null):null,m.length>0?s.a.createElement(H,null,s.a.createElement(x.a,null,"\u60a8\u662f\u300c",u.name,"\u300d\u7279\u52a9\u7684\u7528\u6236\uff0c\u4e5f\u53ef\u4ee5\u53c3\u8003\u4e0b\u5217\u7684\u66f8\u7c4d\u8ab2\u7a0b !")):null,m.map(function(t,n){var i=c[t];return!i||i.cumatrixUID===e.cumatrixUID||n>3?null:s.a.createElement(g.a,{key:i.cumatrixUID,statename:f.a.STATES.COLLECTION,stylecomponent:K,params:{id:e.cumatrixUID},target:"_black"},s.a.createElement(b.a,{src:h.a.getCollectCoverImage(i),stylecomponent:G,isBackgroundImage:!0},i.matrixtype===h.a.cumatrixTypeToInt.CTYPE_BOOK?s.a.createElement(M,null,s.a.createElement("i",{className:"icon-cumatrix-book"})):null,i.matrixtype===h.a.cumatrixTypeToInt.CTYPE_VIDEO?s.a.createElement(M,null,s.a.createElement("i",{className:"icon-cumatrix-video"})):null,i.matrixtype===h.a.cumatrixTypeToInt.CTYPE_AUDIO?s.a.createElement(M,null,s.a.createElement("i",{className:"icon-cumatrix-audio"})):null),s.a.createElement(V,null,s.a.createElement(W,null,i.name),s.a.createElement(q,null,i.description)))}),s.a.createElement(U,null,s.a.createElement(R,{onClick:this.buyCollection},n?s.a.createElement(d.i.Spin,{color:"#FFF"}):null,i?s.a.createElement(x.a,null,"\u932f\u8aa4\uff0c\u8acb\u518d\u5617\u8a66\u4e00\u6b21\uff01"):s.a.createElement(x.a,null,"\u78ba\u5b9a")),s.a.createElement(R,{isGary:!0,onClick:this.closeDialog},s.a.createElement(x.a,null,"\u53d6\u6d88"))),s.a.createElement(_,{onClick:this.closeDialog},s.a.createElement("i",{className:"zmdi zmdi-close"})))}},{key:"render",value:function(){var e=this.state.isInit,t=this.props.buyCollectionDialog,n=t.collection;return e?n.subtype===h.a.cumatrixPdtSubType.BUY_OUT?this.rednerBuyoutView(n):n.subtype===h.a.cumatrixPdtSubType.SUBSCRIBE_ONLY?this.rednerSubscribeOnlyView(n):void 0:null}}]),t}(l.Component),X=function(e){return{buyCollectionDialog:e.web.buyCollectionDialog,cpointsInfo:e.points.cpointsInfo,kwassistCache:e.kwassist.kwassistCache,kwassistListIds:e.kwassist.kwassistListIds,CumatrixFromAssistCache:e.kwassist.CumatrixFromAssistCache,CumatrixFromAssistIds:e.kwassist.CumatrixFromAssistIds}},Z=function(e){return{webActions:Object(c.bindActionCreators)(p.a.webActionCreators,e),kwassistActions:Object(c.bindActionCreators)(p.a.kwassistActionCreators,e),collectionActions:Object(c.bindActionCreators)(p.a.collectionActionCreators,e),pointActions:Object(c.bindActionCreators)(p.a.pointsActionCreators,e)}};t.default=Object(u.b)(X,Z,null,{withRef:!0})(Q)}});
//# sourceMappingURL=74.03b6eae7.chunk.js.map