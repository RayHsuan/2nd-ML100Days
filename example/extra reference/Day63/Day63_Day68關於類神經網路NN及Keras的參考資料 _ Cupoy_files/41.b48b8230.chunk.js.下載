webpackJsonp([41],{843:function(e,n,t){"use strict";function o(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function i(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!==typeof n&&"function"!==typeof n?e:n}function r(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}function a(e,n){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}Object.defineProperty(n,"__esModule",{value:!0});var l=t(1),s=t.n(l),c=t(32),p=t(48),u=t(54),d=t(8),h=t(5),g=t(26),f=t(122),m=(t.n(f),t(119)),b=t(882),x=t(293),v=t(176),w=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}(),y=a(["\n    padding: 20px;\n"],["\n    padding: 20px;\n"]),k=a(["\n    display: flex;\n"],["\n    display: flex;\n"]),C=a(["\n    width: 40px;\n    height: 40px;\n    line-height: 40px;\n    border-radius: 50%;\n    float: left;\n    background-color: #eee;\n    background-size: cover;\n    background-position: center;\n    background-repeat: no-repeat;\n    cursor: pointer;\n    color: #FFF;\n    font-size: 24px;\n    text-align: center;\n    font-weight: light;\n"],["\n    width: 40px;\n    height: 40px;\n    line-height: 40px;\n    border-radius: 50%;\n    float: left;\n    background-color: #eee;\n    background-size: cover;\n    background-position: center;\n    background-repeat: no-repeat;\n    cursor: pointer;\n    color: #FFF;\n    font-size: 24px;\n    text-align: center;\n    font-weight: light;\n"]),E=a(["\n    margin: 0 0 0 8px;\n    flex: 1;\n    overflow: hidden;\n    \n    textarea {\n        width: 100%;\n        min-height: 120px;\n        border: none;\n        font-size: 16px;\n        background-color: transparent;\n    }\n"],["\n    margin: 0 0 0 8px;\n    flex: 1;\n    overflow: hidden;\n    \n    textarea {\n        width: 100%;\n        min-height: 120px;\n        border: none;\n        font-size: 16px;\n        background-color: transparent;\n    }\n"]),F=a(["\n    display: flex;\n    min-height: 120px;\n    margin: 16px 0 0 0;\n    padding: 10px;\n    border: 1px solid #DDD;\n    border-radius: 3px;\n    background-color: #FAFAFA;\n    align-items: center;\n"],["\n    display: flex;\n    min-height: 120px;\n    margin: 16px 0 0 0;\n    padding: 10px;\n    border: 1px solid #DDD;\n    border-radius: 3px;\n    background-color: #FAFAFA;\n    align-items: center;\n"]),_=a(["\n    width: 100px;\n    min-width: 100px;\n    height: 100px;\n    line-height: 100px;\n    border-radius: 3px;\n    background-color: #EEE;\n    background-repeat: no-repeat;\n    background-size: cover;\n    background-position: center center;\n    text-align: center;\n    color: #FFF;\n"],["\n    width: 100px;\n    min-width: 100px;\n    height: 100px;\n    line-height: 100px;\n    border-radius: 3px;\n    background-color: #EEE;\n    background-repeat: no-repeat;\n    background-size: cover;\n    background-position: center center;\n    text-align: center;\n    color: #FFF;\n"]),z=a(["\n    margin: 0 0 0 16px;\n    flex: 1;\n    overflow: hidden;\n"],["\n    margin: 0 0 0 16px;\n    flex: 1;\n    overflow: hidden;\n"]),O=a(["\n    line-height: 1.4em;\n    font-weight: bold;\n    color: ",";\n    font-size: 18px;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n"],["\n    line-height: 1.4em;\n    font-weight: bold;\n    color: ",";\n    font-size: 18px;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n"]),D=a(["\n    margin: 0;\n"],["\n    margin: 0;\n"]),M=a(["\n    line-height: 1.4em;\n    margin: 8px 0 0;\n    color: ",';\n    font-size: 15px;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n\n    &:before {\n        content: "\u2022";\n        margin: 0 6px 0 0;\n    }\n'],["\n    line-height: 1.4em;\n    margin: 8px 0 0;\n    color: ",';\n    font-size: 15px;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n\n    &:before {\n        content: "\u2022";\n        margin: 0 6px 0 0;\n    }\n']),j=a(["\n    display: flex;\n    padding: 10px;\n    background-color: #F0EFEE;\n    align-items: center;\n    justify-content: flex-end;\n    box-shadow: inset 0 1px 0 0 #F0EFEE;\n"],["\n    display: flex;\n    padding: 10px;\n    background-color: #F0EFEE;\n    align-items: center;\n    justify-content: flex-end;\n    box-shadow: inset 0 1px 0 0 #F0EFEE;\n"]),A=a(["\n    height: 36px;\n    line-height: 36px;\n    margin: 0 10px 0 0;\n"],["\n    height: 36px;\n    line-height: 36px;\n    margin: 0 10px 0 0;\n"]),R=a(["\n    height: 36px;\n    line-height: 36px;\n"],["\n    height: 36px;\n    line-height: 36px;\n"]),S=a(["\n    display: inline-block;\n    margin: 0 10px 0 0;\n    font-size: 14px;\n    color: ",";\n"],["\n    display: inline-block;\n    margin: 0 10px 0 0;\n    font-size: 14px;\n    color: ",";\n"]),H=h.default.div(y),I=h.default.div(k),L=h.default.div(C),P=h.default.div(E),N=h.default.div(F),T=h.default.div(_),U=h.default.div(z),W=h.default.div(O,g.e.Dark),q=h.default.div(D),B=h.default.div(M,g.e.Dark2),G=h.default.div(j),J=g.b.Red.extend(A),V=g.b.Gray.extend(R),K=h.default.div(S,g.e.Red),Q=function(e){function n(e){o(this,n);var t=i(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.state={collection:void 0,annotation:"",errorMsg:"",isLoading:!1},t.closeDialog=t.closeDialog.bind(t),t.confirm=t.confirm.bind(t),t.cancel=t.cancel.bind(t),t.onInputChange=t.onInputChange.bind(t),t}return r(n,e),w(n,[{key:"componentDidMount",value:function(){this.init(this.props),this.refs.annotation&&this.refs.annotation._rootDOMNode.focus()}},{key:"componentWillReceiveProps",value:function(e){this.init(e)}},{key:"componentDidUpdate",value:function(e,n){}},{key:"init",value:function(e){var n=e.publishCollectionDialog,t=n.collection,o=n.publishItems,i=[];if(Array.isArray(o)&&o.length)for(var r=0;r<o.length&&r<2;r++)i.push(o[r]);this.setState({collection:t,publishItems:i})}},{key:"closeDialog",value:function(){this.props.collectionActions.closePublishCollectionDialog()}},{key:"confirm",value:function(){var e=this,n=this.state,t=n.collection,o=n.publishItems,i=n.annotation;if(!n.isLoading){var r=t.cumatrixUID,a=[];if(Array.isArray(o)&&o.length>0)for(var l=0;l<o.length;l++)a.push(o[l].itemuid);this.setState({isLoading:!0,errorMsg:""},function(){e.props.collectionActions.sendNewsMessageToSubscribers({cumatrixid:r,itemids:a,annotation:i}).then(function(n){e.props.publishCollectionDialog.callback&&e.props.publishCollectionDialog.callback(),e.closeDialog(),e.setState({isLoading:!1})},function(n){var t=n&&n.message?n.message:"\u7cfb\u7d71\u5fd9\u788c\u4e2d\uff0c\u8acb\u7a0d\u5019\u518d\u8a66";e.setState({isLoading:!1,errorMsg:t})})})}}},{key:"cancel",value:function(){this.closeDialog()}},{key:"onInputChange",value:function(e){e.preventDefault(),this.setState({annotation:e.target.value})}},{key:"render",value:function(){var e=this.state,n=e.collection,t=e.publishItems,o=e.annotation,i=e.isLoading,r=e.errorMsg,a=this.props,l=a.memberInfo,c=a.t;return s.a.createElement(g.f.Content,{width:"560px",maxWidth:"560px",padding:"0",backgroundColor:"#fff",visible:!0,animation:"zoom",maskAnimation:"fade",closable:!1,maskClosable:!0,keyboard:!0,onClose:this.cancel},s.a.createElement(H,null,s.a.createElement(I,null,l?s.a.createElement(v.a,{stylecomponent:L,isBackgroundImage:!0,src:l.memberphotoUrl,text:l.membername}):s.a.createElement(L,null),s.a.createElement(P,null,s.a.createElement(b.a,{ref:"annotation",minRows:1,placeholder:c("component_talkingSomethingAboutThisUpdate"),value:o,onChange:this.onInputChange}))),s.a.createElement(N,null,s.a.createElement(x.a,{src:d.a.getCollectCoverImage(n),stylecomponent:T,isBackgroundImage:!0}),s.a.createElement(U,null,s.a.createElement(W,null,n?n.name:""),Array.isArray(t)&&t.length>0?s.a.createElement(q,null,t.map(function(e,n){return s.a.createElement(B,{key:e.itemuid},e.title)})):null))),s.a.createElement(G,null,r?s.a.createElement(K,null,r):null,s.a.createElement(J,{onClick:this.confirm,disable:i},i?s.a.createElement(g.i.Spin,{size:"16px",color:"#fff",margin:"0 10px 0 0"}):null,s.a.createElement(m.a,{"translate-key":"component_publishNotify"},"\u767c\u4f48\u66f4\u65b0\u901a\u77e5")),s.a.createElement(V,{onClick:this.cancel},s.a.createElement(m.a,{"translate-key":"component_cancel"},"\u53d6\u6d88"))))}}]),n}(l.Component),X=function(e){return{memberInfo:e.member.memberInfo,publishCollectionDialog:e.collection.publishCollectionDialog}},Y=function(e){return{collectionActions:Object(c.bindActionCreators)(u.a.collectionActionCreators,e)}};n.default=Object(p.b)(X,Y,null,{withRef:!0})(Object(f.translate)("translations")(Q))},882:function(e,n,t){"use strict";function o(){return o=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},o.apply(this,arguments)}function i(e,n){e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n}function r(e,n){if(null==e)return{};var t,o,i={},r=Object.keys(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||(i[t]=e[t]);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}function a(e,n,t,o,i){void 0===t&&(t=!1),void 0===o&&(o=null),void 0===i&&(i=null),null===g.parentNode&&document.body.appendChild(g);var r=l(e,n,t);if(null===r)return null;var a=r.paddingSize,s=r.borderSize,c=r.boxSizing,p=r.sizingStyle;Object.keys(p).forEach(function(e){g.style[e]=p[e]}),Object.keys(f).forEach(function(e){g.style.setProperty(e,f[e],"important")}),g.value=e.value||e.placeholder||"x";var u=-1/0,d=1/0,h=g.scrollHeight;"border-box"===c?h+=s:"content-box"===c&&(h-=a),g.value="x";var m=g.scrollHeight-a;return null===o&&null===i||(null!==o&&(u=m*o,"border-box"===c&&(u=u+a+s),h=Math.max(u,h)),null!==i&&(d=m*i,"border-box"===c&&(d=d+a+s),h=Math.min(d,h))),{height:h,minHeight:u,maxHeight:d,rowCount:Math.floor(h/m)}}function l(e,n,t){if(void 0===t&&(t=!1),t&&b[n])return b[n];var o=window.getComputedStyle(e);if(null===o)return null;var i=m.reduce(function(e,n){return e[n]=o.getPropertyValue(n),e},{}),r=i["box-sizing"];h&&"border-box"===r&&(i.width=parseFloat(i.width)+parseFloat(o["border-right-width"])+parseFloat(o["border-left-width"])+parseFloat(o["padding-right"])+parseFloat(o["padding-left"])+"px");var a=parseFloat(i["padding-bottom"])+parseFloat(i["padding-top"]),l=parseFloat(i["border-bottom-width"])+parseFloat(i["border-top-width"]),s={sizingStyle:i,paddingSize:a,borderSize:l,boxSizing:r};return t&&(b[n]=s),s}var s=t(1),c=t.n(s),p=t(2),u=t.n(p),d="undefined"!==typeof window&&"undefined"!==typeof document,h=!!d&&!!document.documentElement.currentStyle,g=d&&document.createElement("textarea"),f={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},m=["letter-spacing","line-height","font-family","font-weight","font-size","font-style","tab-size","text-rendering","text-transform","width","text-indent","padding-top","padding-right","padding-bottom","padding-left","border-top-width","border-right-width","border-bottom-width","border-left-width","box-sizing"],b={},x=function(e){return delete b[e]},v=function(e){return void 0===e&&(e=0),function(){return++e}}(),w=function(){},y=d&&window.requestAnimationFrame?[window.requestAnimationFrame,window.cancelAnimationFrame]:[setTimeout,clearTimeout],k=y[0],C=y[1],E=function(e){function n(n){var t;return t=e.call(this,n)||this,t._resizeLock=!1,t._onRootDOMNode=function(e){t._rootDOMNode=e,t.props.inputRef&&t.props.inputRef(e)},t._onChange=function(e){t._controlled||t._resizeComponent(),t.props.onChange(e)},t._resizeComponent=function(e){if(void 0===e&&(e=w),"undefined"===typeof t._rootDOMNode)return void e();var n=a(t._rootDOMNode,t._uid,t.props.useCacheForDOMMeasurements,t.props.minRows,t.props.maxRows);if(null===n)return void e();var o=n.height,i=n.minHeight,r=n.maxHeight,l=n.rowCount;if(t.rowCount=l,t.state.height!==o||t.state.minHeight!==i||t.state.maxHeight!==r)return void t.setState({height:o,minHeight:i,maxHeight:r},e);e()},t.state={height:n.style&&n.style.height||0,minHeight:-1/0,maxHeight:1/0},t._uid=v(),t._controlled="string"===typeof n.value,t}i(n,e);var t=n.prototype;return t.render=function(){var e=this.props,n=(e.minRows,e.maxRows,e.onHeightChange,e.useCacheForDOMMeasurements,e.inputRef,r(e,["minRows","maxRows","onHeightChange","useCacheForDOMMeasurements","inputRef"]));return n.style=o({},n.style,{height:this.state.height}),Math.max(n.style.maxHeight||1/0,this.state.maxHeight)<this.state.height&&(n.style.overflow="hidden"),c.a.createElement("textarea",o({},n,{onChange:this._onChange,ref:this._onRootDOMNode}))},t.componentDidMount=function(){var e=this;this._resizeComponent(),this._resizeListener=function(){e._resizeLock||(e._resizeLock=!0,e._resizeComponent(function(){return e._resizeLock=!1}))},window.addEventListener("resize",this._resizeListener)},t.componentWillReceiveProps=function(){var e=this;this._clearNextFrame(),this._onNextFrameActionId=k(function(){return e._resizeComponent()})},t.componentDidUpdate=function(e,n){this.state.height!==n.height&&this.props.onHeightChange(this.state.height,this)},t.componentWillUnmount=function(){this._clearNextFrame(),window.removeEventListener("resize",this._resizeListener),x(this._uid)},t._clearNextFrame=function(){C(this._onNextFrameActionId)},n}(c.a.Component);E.propTypes={value:u.a.string,onChange:u.a.func,onHeightChange:u.a.func,useCacheForDOMMeasurements:u.a.bool,minRows:u.a.number,maxRows:u.a.number,inputRef:u.a.func},E.defaultProps={onChange:w,onHeightChange:w,useCacheForDOMMeasurements:!1},n.a=E}});
//# sourceMappingURL=41.b48b8230.chunk.js.map